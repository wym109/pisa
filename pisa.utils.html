<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pisa.utils package &mdash; PISA 4.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=9f5556dd"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pisa.utils.hypersurface package" href="pisa.utils.hypersurface.html" />
    <link rel="prev" title="pisa.stages.xsec package" href="pisa.stages.xsec.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PISA
          </a>
              <div class="version">
                4.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pisa.html">pisa package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pisa.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pisa.analysis.html">pisa.analysis package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.core.html">pisa.core package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.scripts.html">pisa.scripts package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.stages.html">pisa.stages package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">pisa.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pisa.html#module-pisa">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PISA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">pisa</a></li>
          <li class="breadcrumb-item"><a href="pisa.html">pisa package</a></li>
      <li class="breadcrumb-item active">pisa.utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pisa.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pisa-utils-package">
<h1>pisa.utils package<a class="headerlink" href="#pisa-utils-package" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pisa.utils.hypersurface.html">pisa.utils.hypersurface package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pisa.utils.hypersurface.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pisa.utils.hypersurface.html#module-pisa.utils.hypersurface.hyper_interpolator">pisa.utils.hypersurface.hyper_interpolator module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.HypersurfaceInterpolator"><code class="docutils literal notranslate"><span class="pre">HypersurfaceInterpolator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.HypersurfaceInterpolator.binning"><code class="docutils literal notranslate"><span class="pre">HypersurfaceInterpolator.binning</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.HypersurfaceInterpolator.get_hypersurface"><code class="docutils literal notranslate"><span class="pre">HypersurfaceInterpolator.get_hypersurface()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.HypersurfaceInterpolator.interpolation_param_names"><code class="docutils literal notranslate"><span class="pre">HypersurfaceInterpolator.interpolation_param_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.HypersurfaceInterpolator.num_interp_params"><code class="docutils literal notranslate"><span class="pre">HypersurfaceInterpolator.num_interp_params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.HypersurfaceInterpolator.param_names"><code class="docutils literal notranslate"><span class="pre">HypersurfaceInterpolator.param_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.HypersurfaceInterpolator.plot_fits_in_bin"><code class="docutils literal notranslate"><span class="pre">HypersurfaceInterpolator.plot_fits_in_bin()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.assemble_interpolated_fits"><code class="docutils literal notranslate"><span class="pre">assemble_interpolated_fits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.get_incomplete_job_idx"><code class="docutils literal notranslate"><span class="pre">get_incomplete_job_idx()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.load_interpolated_hypersurfaces"><code class="docutils literal notranslate"><span class="pre">load_interpolated_hypersurfaces()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.pipeline_cfg_from_states"><code class="docutils literal notranslate"><span class="pre">pipeline_cfg_from_states()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.prepare_interpolated_fit"><code class="docutils literal notranslate"><span class="pre">prepare_interpolated_fit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.run_interpolated_fit"><code class="docutils literal notranslate"><span class="pre">run_interpolated_fit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hyper_interpolator.serialize_pipeline_cfg"><code class="docutils literal notranslate"><span class="pre">serialize_pipeline_cfg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pisa.utils.hypersurface.html#module-pisa.utils.hypersurface.hypersurface">pisa.utils.hypersurface.hypersurface module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface"><code class="docutils literal notranslate"><span class="pre">Hypersurface</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.evaluate"><code class="docutils literal notranslate"><span class="pre">Hypersurface.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.fit"><code class="docutils literal notranslate"><span class="pre">Hypersurface.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.fit_coefft_labels"><code class="docutils literal notranslate"><span class="pre">Hypersurface.fit_coefft_labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.fit_coeffts"><code class="docutils literal notranslate"><span class="pre">Hypersurface.fit_coeffts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.fit_maps"><code class="docutils literal notranslate"><span class="pre">Hypersurface.fit_maps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.fit_param_values"><code class="docutils literal notranslate"><span class="pre">Hypersurface.fit_param_values</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.fluctuate"><code class="docutils literal notranslate"><span class="pre">Hypersurface.fluctuate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.from_state"><code class="docutils literal notranslate"><span class="pre">Hypersurface.from_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.get_nominal_mask"><code class="docutils literal notranslate"><span class="pre">Hypersurface.get_nominal_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.get_on_axis_mask"><code class="docutils literal notranslate"><span class="pre">Hypersurface.get_on_axis_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.initialized"><code class="docutils literal notranslate"><span class="pre">Hypersurface.initialized</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.nominal_values"><code class="docutils literal notranslate"><span class="pre">Hypersurface.nominal_values</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.num_fit_coeffts"><code class="docutils literal notranslate"><span class="pre">Hypersurface.num_fit_coeffts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.num_fit_sets"><code class="docutils literal notranslate"><span class="pre">Hypersurface.num_fit_sets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.param_names"><code class="docutils literal notranslate"><span class="pre">Hypersurface.param_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.report"><code class="docutils literal notranslate"><span class="pre">Hypersurface.report()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.Hypersurface.serializable_state"><code class="docutils literal notranslate"><span class="pre">Hypersurface.serializable_state</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.HypersurfaceParam"><code class="docutils literal notranslate"><span class="pre">HypersurfaceParam</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.HypersurfaceParam.evaluate"><code class="docutils literal notranslate"><span class="pre">HypersurfaceParam.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.HypersurfaceParam.from_state"><code class="docutils literal notranslate"><span class="pre">HypersurfaceParam.from_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.HypersurfaceParam.get_fit_coefft"><code class="docutils literal notranslate"><span class="pre">HypersurfaceParam.get_fit_coefft()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.HypersurfaceParam.get_fit_coefft_idx"><code class="docutils literal notranslate"><span class="pre">HypersurfaceParam.get_fit_coefft_idx()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.HypersurfaceParam.gradient"><code class="docutils literal notranslate"><span class="pre">HypersurfaceParam.gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.HypersurfaceParam.serializable_state"><code class="docutils literal notranslate"><span class="pre">HypersurfaceParam.serializable_state</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.fit_hypersurfaces"><code class="docutils literal notranslate"><span class="pre">fit_hypersurfaces()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface.load_hypersurfaces"><code class="docutils literal notranslate"><span class="pre">load_hypersurfaces()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pisa.utils.hypersurface.html#module-pisa.utils.hypersurface.hypersurface_plotting">pisa.utils.hypersurface.hypersurface_plotting module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface_plotting.plot_bin_fits"><code class="docutils literal notranslate"><span class="pre">plot_bin_fits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pisa.utils.hypersurface.html#pisa.utils.hypersurface.hypersurface_plotting.plot_bin_fits_2d"><code class="docutils literal notranslate"><span class="pre">plot_bin_fits_2d()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pisa.utils.hypersurface.html#module-pisa.utils.hypersurface">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pisa.utils.llh_defs.html">pisa.utils.llh_defs package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pisa.utils.llh_defs.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pisa.utils.llh_defs.html#pisa-utils-llh-defs-poisson-module">pisa.utils.llh_defs.poisson module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pisa.utils.llh_defs.html#pisa-utils-llh-defs-poisson-gamma-mixtures-module">pisa.utils.llh_defs.poisson_gamma_mixtures module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pisa.utils.llh_defs.html#module-pisa.utils.llh_defs">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-pisa.utils.barlow">
<span id="pisa-utils-barlow-module"></span><h2>pisa.utils.barlow module<a class="headerlink" href="#module-pisa.utils.barlow" title="Link to this heading"></a></h2>
<p><cite>Likelihoods</cite> class for computing Poisson and Barlow likelihoods.</p>
<p>The Poisson likelihood assumes the template being compared against is the
perfect expectation, while the Barlow likelihood accounts for the template
being imperfect due to being generated from finite Monte Carlo statistics.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.barlow.</span></span><span class="sig-name descname"><span class="pre">Likelihoods</span></span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to handle the likelihood calculations in OscFit. It can
be used in other poisson binned-likelihood calculators as well.
The class includes two likelihood spaces: the Poisson and the
Barlow LLH.</p>
<p>The Poisson likelihood is the ideal case and assumes infinite
statistical accuracy on the Monte Carlo distributions. This is
the simple case and has been used in the past for analyses, but
should not be used if there’s a significant statistical error on
one of the samples.</p>
<p>The Barlow likelihood is an implementation of the likelihood model
given in doi:10.1016/0010-4655(93)90005-W (“Fitting using finite
Monte Carlo samples” by Barlow and Beeston). This requires the
unweighted distributions of the MC and involves assuming that each
MC samples is drawn from an underlying “true” expectation distribution
which should be fit. This gives (number of bins)x(number of samples)
new parameters to fit and allows the shape of the distributions to
fluctuate in order to fit both the observed MC and the observed
data. This gives a more informed result and allows one to estimate
the effect of the finite MC samples.</p>
<p>To use this, you need to run set_data, set_mc, and the set_unweighted
functions.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>the <cite>set_mc</cite> function takes a histogram of the average
weight per event for each bin! not the total weighted histogram!</p>
</div>
<p>Simply calling the get_llh function after these will return the
best fit LLH for your chosen likelihood function. The function takes
the name of the likelihood space (“Poisson” or “Barlow”). You can
retrieve the best fit weighted plots using the get_plot (total best-fit
histogram including all samples) and the get_single_plots (the list
of best-fit weighted histograms for each sample).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.bestfit_plots">
<span class="sig-name descname"><span class="pre">bestfit_plots</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.bestfit_plots" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.current_bin">
<span class="sig-name descname"><span class="pre">current_bin</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.current_bin" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.data_histogram">
<span class="sig-name descname"><span class="pre">data_histogram</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.data_histogram" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.get_llh">
<span class="sig-name descname"><span class="pre">get_llh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">llh_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods.get_llh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.get_llh" title="Link to this definition"></a></dt>
<dd><p>Calculate the likelihood given the data, average weights, and the
unweighted histograms. You can choose between “Poisson” and “Barlow”
likelihoods at the moment.</p>
<p>If using the “Barlow” LLH, note that the method is picked to be Powell
with 25 iterations maximum per step. This is not optimized at all and
was explicitly chosen simply because it “worked”. This doesn’t work
with the bounds set in the normal way, so the positive-definiteness of
the rates is enforced in the get_llh_barlow_bin method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.get_llh_barlow_bin">
<span class="sig-name descname"><span class="pre">get_llh_barlow_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a_i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods.get_llh_barlow_bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.get_llh_barlow_bin" title="Link to this definition"></a></dt>
<dd><p>The Barlow LLH finds the best-fit “expected” MC distribution using
both the data and observed MC as constraints. Each bin is independent
in this calculation, since the assumption is that there are no
correlations between bins. This likely leads to a somewhat worse limit
than you might get otherwise, but at least its conservative.</p>
<p>If you have a good idea for how to extend this to include bin-to-bin,
let me know and I can help implement it.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.get_llh_poisson">
<span class="sig-name descname"><span class="pre">get_llh_poisson</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods.get_llh_poisson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.get_llh_poisson" title="Link to this definition"></a></dt>
<dd><p>The standard binned-poisson likelihood comparing the weighted MC
distribution to the data, ignoring MC statistical uncertainties.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.get_plot">
<span class="sig-name descname"><span class="pre">get_plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods.get_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.get_plot" title="Link to this definition"></a></dt>
<dd><p>Get the total weighted best-fit histogram post-fit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.get_single_plots">
<span class="sig-name descname"><span class="pre">get_single_plots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods.get_single_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.get_single_plots" title="Link to this definition"></a></dt>
<dd><p>Get the individual weighted best-fit histograms post-fit.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.mc_histograms">
<span class="sig-name descname"><span class="pre">mc_histograms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.mc_histograms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.reset" title="Link to this definition"></a></dt>
<dd><p>Re-instantiate so that we can reuse the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.set_data">
<span class="sig-name descname"><span class="pre">set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_histogram</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods.set_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.set_data" title="Link to this definition"></a></dt>
<dd><p>Set up the data histogram. This histogram is flattened in order to
make the looping later on a bit simpler to handle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.set_mc">
<span class="sig-name descname"><span class="pre">set_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc_histograms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods.set_mc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.set_mc" title="Link to this definition"></a></dt>
<dd><p>Set up the MC histogram. Each histogram is flattened in order to
make the looping later on a bit simpler to handle. The values in each
bin should correspond to the weight-per-event in that bin, NOT the
total weight in that bin!</p>
<p>Make sure you don’t have any nulls here.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.set_unweighted">
<span class="sig-name descname"><span class="pre">set_unweighted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unweighted_histograms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/barlow.html#Likelihoods.set_unweighted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.set_unweighted" title="Link to this definition"></a></dt>
<dd><p>Save the unweighted distributions in the MC. These can include 0s.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.shape" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.barlow.Likelihoods.unweighted_histograms">
<span class="sig-name descname"><span class="pre">unweighted_histograms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pisa.utils.barlow.Likelihoods.unweighted_histograms" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pisa.utils.barr_parameterization">
<span id="pisa-utils-barr-parameterization-module"></span><h2>pisa.utils.barr_parameterization module<a class="headerlink" href="#module-pisa.utils.barr_parameterization" title="Link to this heading"></a></h2>
<p>External PISA file to be kept in private location
Containing the Barr parameterizations for flux modifications</p>
<p>originaly developped by Juan Pablo Yanez</p>
</section>
<section id="module-pisa.utils.callable">
<span id="pisa-utils-callable-module"></span><h2>pisa.utils.callable module<a class="headerlink" href="#module-pisa.utils.callable" title="Link to this heading"></a></h2>
<p>This is used to define a serializable object used for functions assigned to the DerivedParams</p>
<p>These can be constructed and evaluated symbolically and procedurally.
In principle, we may even be able to include a filepath to a seriialized Funct object such that the pipeline configs can include definitions for these therein</p>
<dl class="simple">
<dt>Contains</dt><dd><p>OPS - an Enum listing recognized operations
TrigOps - some definitions for handling some of the trig functions, shared by Vars and Functs
Var - a class for representing variables
Funct - a series of operations done representing the functions</p>
</dd>
</dl>
<p>Uses - quite simple!</p>
<p>create some vars and do math on them</p>
<p>x = Var(‘x’)
y = Var(‘y’)</p>
<p>function = sin(x**2) + 3*cos(y+1)**2</p>
<p>The object <cite>function</cite> is now callable with keyword arguments passed to the instantiated <cite>Vars</cite></p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.callable.Funct">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.callable.</span></span><span class="sig-name descname"><span class="pre">Funct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#Funct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.Funct" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pisa.utils.callable.TrigOps" title="pisa.utils.callable.TrigOps"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrigOps</span></code></a></p>
<p>Functions are constructed as a series of operations one to some starting value.
The starting value can be whatever - a value, function or variable</p>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.Funct.add_opp">
<span class="sig-name descname"><span class="pre">add_opp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pisa.utils.callable.OPS" title="pisa.utils.callable.OPS"><span class="pre">OPS</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#Funct.add_opp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.Funct.add_opp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.Funct.from_json">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#Funct.from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.Funct.from_json" title="Link to this definition"></a></dt>
<dd><p>Instantiate a new Param from a JSON file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.Funct.from_state">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#Funct.from_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.Funct.from_state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.Funct.serializable_state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">serializable_state</span></span><a class="headerlink" href="#pisa.utils.callable.Funct.serializable_state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.Funct.state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state</span></span><a class="headerlink" href="#pisa.utils.callable.Funct.state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.Funct.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#Funct.to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.Funct.to_json" title="Link to this definition"></a></dt>
<dd><p>Serialize the state to a JSON file that can be instantiated as a new
object later.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.callable.</span></span><span class="sig-name descname"><span class="pre">OPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#OPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.OPS" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Enumerate different operations so that the Funct class can do math</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.ADD">
<span class="sig-name descname"><span class="pre">ADD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pisa.utils.callable.OPS.ADD" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.COS">
<span class="sig-name descname"><span class="pre">COS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#pisa.utils.callable.OPS.COS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.MUL">
<span class="sig-name descname"><span class="pre">MUL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#pisa.utils.callable.OPS.MUL" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.POW">
<span class="sig-name descname"><span class="pre">POW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#pisa.utils.callable.OPS.POW" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.SIN">
<span class="sig-name descname"><span class="pre">SIN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#pisa.utils.callable.OPS.SIN" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.TAN">
<span class="sig-name descname"><span class="pre">TAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#pisa.utils.callable.OPS.TAN" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.from_json">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#OPS.from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.OPS.from_json" title="Link to this definition"></a></dt>
<dd><p>Instantiate a new Param from a JSON file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.from_state">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#OPS.from_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.OPS.from_state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.serializable_state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">serializable_state</span></span><a class="headerlink" href="#pisa.utils.callable.OPS.serializable_state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state</span></span><a class="headerlink" href="#pisa.utils.callable.OPS.state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.OPS.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#OPS.to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.OPS.to_json" title="Link to this definition"></a></dt>
<dd><p>Serialize the state to a JSON file that can be instantiated as a new
object later.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.callable.TrigOps">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.callable.</span></span><span class="sig-name descname"><span class="pre">TrigOps</span></span><a class="reference internal" href="_modules/pisa/utils/callable.html#TrigOps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.TrigOps" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>These are all used by both the Var and Funct classes, so there’s some fun python hierarchy stuff going on instead</p>
<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.TrigOps.cos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cos</span></span><a class="headerlink" href="#pisa.utils.callable.TrigOps.cos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.TrigOps.sin">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sin</span></span><a class="headerlink" href="#pisa.utils.callable.TrigOps.sin" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.TrigOps.tan">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tan</span></span><a class="headerlink" href="#pisa.utils.callable.TrigOps.tan" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.callable.Var">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.callable.</span></span><span class="sig-name descname"><span class="pre">Var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#Var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.Var" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pisa.utils.callable.TrigOps" title="pisa.utils.callable.TrigOps"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrigOps</span></code></a></p>
<p>A variable</p>
<p>These are a lot like functions in how they are combined, but instead evaluate simply to one of the keyword arguments passed to Functions</p>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.Var.from_json">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#Var.from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.Var.from_json" title="Link to this definition"></a></dt>
<dd><p>Instantiate a new Param from a JSON file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.Var.from_state">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#Var.from_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.Var.from_state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.Var.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#pisa.utils.callable.Var.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.Var.serializable_state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">serializable_state</span></span><a class="headerlink" href="#pisa.utils.callable.Var.serializable_state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.callable.Var.state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state</span></span><a class="headerlink" href="#pisa.utils.callable.Var.state" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.callable.Var.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#Var.to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.Var.to_json" title="Link to this definition"></a></dt>
<dd><p>Serialize the state to a JSON file that can be instantiated as a new
object later.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.callable.cos">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.callable.</span></span><span class="sig-name descname"><span class="pre">cos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pisa.utils.callable.Funct" title="pisa.utils.callable.Funct"><span class="pre">Funct</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#cos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.cos" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.callable.sin">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.callable.</span></span><span class="sig-name descname"><span class="pre">sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pisa.utils.callable.Funct" title="pisa.utils.callable.Funct"><span class="pre">Funct</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#sin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.sin" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.callable.tan">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.callable.</span></span><span class="sig-name descname"><span class="pre">tan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pisa.utils.callable.Funct" title="pisa.utils.callable.Funct"><span class="pre">Funct</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/callable.html#tan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.callable.tan" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pisa.utils.comparisons">
<span id="pisa-utils-comparisons-module"></span><h2>pisa.utils.comparisons module<a class="headerlink" href="#module-pisa.utils.comparisons" title="Link to this heading"></a></h2>
<p>Utilities for comparing things.</p>
<p><cite>recursiveEquality</cite> and <cite>recursiveAllclose</cite> traverse into potentially nested
datstructures and compare all elements for equality.
<cite>normQuant</cite> performs the same kind of traversal, but returns a normalized
version of the input object whereby “essentially-equal” things are returned as
“actually-equal” objects.</p>
<p>These functions are at the heart of hashing behaving as one expects, and this
in turn is essential for caching to work correctly.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Read carefully how each function in this module defines
“equality” for various datatypes so you understand what two things being
“equal” based upon these functions <em>actually</em> means.</p>
<p>E.g., (nan == nan) == True, uncorrelated uncertainties are equal if both
their nominal values and standard deviations are equal regardless if they
come from independent random variables, etc.</p>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.comparisons.ALLCLOSE_KW">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">ALLCLOSE_KW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'atol':</span> <span class="pre">2.220446049250313e-16,</span> <span class="pre">'equal_nan':</span> <span class="pre">True,</span> <span class="pre">'rtol':</span> <span class="pre">1e-12}</span></em><a class="headerlink" href="#pisa.utils.comparisons.ALLCLOSE_KW" title="Link to this definition"></a></dt>
<dd><p>Keyword args to pass to all calls to numpy.allclose</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.comparisons.EQUALITY_PREC">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">EQUALITY_PREC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-12</span></em><a class="headerlink" href="#pisa.utils.comparisons.EQUALITY_PREC" title="Link to this definition"></a></dt>
<dd><p>Precision (“rtol”) for performing equality comparisons</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.comparisons.EQUALITY_SIGFIGS">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">EQUALITY_SIGFIGS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">12</span></em><a class="headerlink" href="#pisa.utils.comparisons.EQUALITY_SIGFIGS" title="Link to this definition"></a></dt>
<dd><p>Significant figures for performing equality comparisons</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.comparisons.FTYPE_PREC">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">FTYPE_PREC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2.220446049250313e-16</span></em><a class="headerlink" href="#pisa.utils.comparisons.FTYPE_PREC" title="Link to this definition"></a></dt>
<dd><p>Machine precision (“eps”) for PISA’s FTYPE (float datatype)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.interpret_quantity">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">interpret_quantity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expect_sequence</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#interpret_quantity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.interpret_quantity" title="Link to this definition"></a></dt>
<dd><p>Interpret a value as a pint Quantity via pisa.ureg</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>scalar</em><em>, </em><em>Quantity</em><em>, or </em><em>sequence interpretable as Quantity</em>)</p></li>
<li><p><strong>expect_sequence</strong> (<em>bool</em>) – Specify <cite>True</cite> if you expect a sequence of quantities (or a
pint-Quantity containing a numpy array). This allows interpreting each
element of a passed sequence as a quantity. Otherwise, specify <cite>False</cite>
if you expect a scalar. This allows interpreting a pint.Qauntity tuple
as a ascalar (the first element of the tuple is the magnitude and the
second element contains the units).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>value</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.isbarenumeric">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">isbarenumeric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#isbarenumeric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.isbarenumeric" title="Link to this definition"></a></dt>
<dd><p>Check if input is a numerical datatype (including arrays of numbers) but
without units. Note that for these purposes, booleans are <em>not</em> considered
numerical datatypes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.isscalar">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">isscalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#isscalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.isscalar" title="Link to this definition"></a></dt>
<dd><p>Check if input is a scalar object.</p>
<p>Best check found for now as to scalar-ness (works for pint,
uncertainties, lists, tuples, numpy arrays, …) but not tested against all
things.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.isscalar</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.isunitless">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">isunitless</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#isunitless"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.isunitless" title="Link to this definition"></a></dt>
<dd><p>Check if input is unitless. Only the first scalar element of an Iterable
(or arbitrarily nested Iterables) is checked if it has units.</p>
<p>Strings and bools are considered to be unit-less.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>object</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>isunitless</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError if a Mapping is encountered</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.isvalidname">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">isvalidname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#isvalidname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.isvalidname" title="Link to this definition"></a></dt>
<dd><p>Name that is valid to use for a Python variable</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.normQuant">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">normQuant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigfigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#normQuant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.normQuant" title="Link to this definition"></a></dt>
<dd><p>Normalize quantities such that two things that <em>should</em> be equal are
returned as identical objects.</p>
<p>Handles floating point numbers, pint quantities, uncertainties, and
combinations thereof as standalone objects or in sequences, dicts, or numpy
ndarrays. Numerical precision issues and equal quantities represented in
differently-scaled or different systems of units come out identically.</p>
<p>Outputs from this function (<strong>not</strong> the inputs) deemed to be equal by the
above logic will compare to be equal (via the <cite>==</cite> operator and via
<cite>pisa.utils.comparisons.recursiveEquality</cite>) and will also hash to equal
values (via <cite>pisa.utils.hash.hash_obj</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – Object to be normalized.</p></li>
<li><p><strong>sigfigs</strong> (<em>None</em><em> or </em><em>int &gt; 0</em>) – Number of digits to which to round numbers’ significands; if None, do
not round numbers.</p></li>
<li><p><strong>full_norm</strong> (<em>bool</em>) – <p>If True, does full translation and normalization which is good across
independent invocations and is careful about normalizing units, etc.
If false, certain assumptions are made that modify the behavior
described below in the Notes section which help speed things up in the
case of e.g. a minimizer run, where we know certain things won’t
change:
* Units are not normalized. They are assumed to stay the same from</p>
<blockquote>
<div><p>run to run.</p>
</div></blockquote>
<ul>
<li><p>sigfigs are not respected; full significant figures are returned
(since it takes time to round all values appropriately).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>normed_obj</strong> – Simple types are returned as the same type as at the input, Numpy
ndarrays are returned in the same shape and representation as the
input, Mappings (dicts) are returned as OrderedDict, and all other
sequences or iterables are returned as (possibly nested) lists.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object roughly of same type as input <cite>obj</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Conversion logic by <cite>obj</cite> type or types found within <cite>obj</cite>:</p>
<ul class="simple">
<li><p><strong>Sequences and OrderedDicts</strong> (but not numpy arrays) are iterated
through recursively.</p></li>
<li><p><strong>Mappings without ordering</strong> (e.g. dicts) are iterated through
recursively after sorting their keys, and are returned as
OrderedDicts (such that the output is always consistent when
serialized).</p></li>
<li><p><strong>Sequences</strong> (not numpy arrays) are iterated through recursively.</p></li>
<li><p><strong>Numpy ndarrays</strong> are treated as the below data types (according to the
array’s dtype).</p></li>
<li><p><strong>Simple objects</strong> (non-floating point / non-sequence / non-numpy / etc.)
are returned unaltered (e.g. strings).</p></li>
<li><p><strong>Pint quantities</strong> (numbers with units): Convert to their base units.</p></li>
<li><p><strong>Floating-point numbers</strong> (including the converted pint quantities):
Round values to <cite>sigfigs</cite> significant figures.</p></li>
<li><p><strong>Numbers with uncertainties</strong> (via the <cite>uncertainties</cite> module) have
their nominal values rounded as above but their standard deviations are
rounded to the same order of magnitude (<em>not</em> number of significant
figures) as the nominal.
Therefore passing obj=10.23+/-0.25 and sigfigs=2 returns 10+/-0.0.
Note that <strong>correlations are lost</strong> in the outputs of this function, so
equality of the output requires merely having equal nomial values and
equal standard deviations.
The calculations leading to these equal numbers might have used
independent random variables to arrive at them, however, and so the
<cite>uncertainties</cite> module would have evaluated them to be unequal. [1]</p></li>
</ul>
<p>To achieve rounding that masks floating point precision issues, set
<cite>sigfigs</cite> to a value <em>less than</em> the number of decimal digits used for the
significand of the calculation floating point precision.</p>
<p>For reference, the IEEE 754 floating point standard [2] uses the following:</p>
<ul class="simple">
<li><p>FP16 (half precision): <strong>3.31</strong> significand decimal digits (11 bits)</p></li>
<li><p>FP32 (single precision): <strong>7.22</strong> significand decimal digits (24 bits)</p></li>
<li><p>FP64 (double precision): <strong>15.95</strong> significand decimal digits (53 bits)</p></li>
<li><p>FP128 (quad precision): <strong>34.02</strong> significand decimal digits (113 bits)</p></li>
</ul>
<p>Logic for rounding the significand for numpy arrays was derived from [3].</p>
<p class="rubric">References</p>
<p>[1] <a class="reference external" href="https://github.com/lebigot/uncertainties/blob/master/uncertainties/test_uncertainties.py#L436">https://github.com/lebigot/uncertainties/blob/master/uncertainties/test_uncertainties.py#L436</a></p>
<p>[2] <a class="reference external" href="https://en.wikipedia.org/wiki/IEEE_floating_point">https://en.wikipedia.org/wiki/IEEE_floating_point</a></p>
<p>[3] <a class="reference external" href="http://stackoverflow.com/questions/18915378">http://stackoverflow.com/questions/18915378</a>, answer by user BlackGriffin.</p>
<p class="rubric">Examples</p>
<p>Pint quantities hash to unequal values if specified in different scales or
different systems of units (even if the underlying physical quantity is
identical).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pisa</span> <span class="kn">import</span> <span class="n">ureg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pisa.utils.hash</span> <span class="kn">import</span> <span class="n">hash_obj</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q0</span> <span class="o">==</span> <span class="n">q1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hash_obj</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span> <span class="o">==</span> <span class="n">hash_obj</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Even the <cite>to_base_units()</cite> method fails for hashing to equal values, as
<cite>q0</cite> is a float and <cite>q1</cite> is an integer.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hash_obj</span><span class="p">(</span><span class="n">q0</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">())</span> <span class="o">==</span> <span class="n">hash_obj</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">())</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Even if both quantities are floating point numbers, finite precision
effects in the <cite>to_base_units</cite> conversion can still cause two things which
we “know” are equal to evaluate to be unequal.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q3</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">um</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">==</span> <span class="n">q3</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span> <span class="o">==</span> <span class="n">q3</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p><cite>normQuant</cite> handles all of these issues given an appropriate <cite>sigfigs</cite>
argument.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q2_normed</span> <span class="o">=</span> <span class="n">normQuant</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q3_normed</span> <span class="o">=</span> <span class="n">normQuant</span><span class="p">(</span><span class="n">q3</span><span class="p">,</span> <span class="n">sigfigs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2_normed</span> <span class="o">==</span> <span class="n">q3_normed</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hash_obj</span><span class="p">(</span><span class="n">q2_normed</span><span class="p">)</span> <span class="o">==</span> <span class="n">hash_obj</span><span class="p">(</span><span class="n">q3_normed</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.recursiveAllclose">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">recursiveAllclose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#recursiveAllclose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.recursiveAllclose" title="Link to this definition"></a></dt>
<dd><p>Recursively verify close-equality between two objects x and y. If
structure is different between the two objects, returns False</p>
<p>args and kwargs are passed into numpy.allclose() function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.recursiveEquality">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">recursiveEquality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allclose_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'atol':</span> <span class="pre">2.220446049250313e-16,</span> <span class="pre">'equal_nan':</span> <span class="pre">True,</span> <span class="pre">'rtol':</span> <span class="pre">1e-12}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#recursiveEquality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.recursiveEquality" title="Link to this definition"></a></dt>
<dd><p>Recursively verify equality between two objects <cite>x</cite> and <cite>y</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Objects to be compared</p></li>
<li><p><strong>y</strong> – Objects to be compared</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl>
<dt>Possibly unintuitive behaviors:</dt><dd><ul>
<li><p>Sequences of any type evaluate equal if their contents are the same.
E.g., a list can equal a tuple.</p></li>
<li><p>Mappings of any type evaluate equal if their contents are the same.
E.g. a dict can equal an OrderedDict.</p></li>
<li><p>nan SHOULD equal nan, +inf SHOULD equal +inf, and -inf SHOULD equal -inf
… but this <strong>*only*</strong> holds true (as of now) if those values are in
numpy arrays! (TODO!)</p></li>
<li><p>Two pint units with same __repr__ but that were derived from different
unit registries evaluate to be equal. (This is contrary to pint’s
implementation of equality comparisons, which is careful in case a
unit is defined differently in different registries. We’ll assume this
isn’t done here in PISA, until a use case arises where this is no
longer a good assumption.)</p></li>
<li><p>Two pint units that are compatible but different (even just in
magnitude prefix) evaluate to be unequal.</p>
<p>This behavior is chosen for the case where numbers are given
independently of their units, and hence the automatic conversion
facility available for comparing pint quantities is not available.
The only reliable way to test equality for these “less intelligent”
objects is to ensure that both the numerical values are exactly equal
and that the units are exactly equal; the latter includes order of
magnitude prefixes (micro, milli, …, giga, etc.).</p>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.test_isscalar">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">test_isscalar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#test_isscalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.test_isscalar" title="Link to this definition"></a></dt>
<dd><p>Unit test for isscalar function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.test_isunitless">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">test_isunitless</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#test_isunitless"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.test_isunitless" title="Link to this definition"></a></dt>
<dd><p>Unit tests for <cite>isunitless</cite> function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.test_normQuant">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">test_normQuant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#test_normQuant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.test_normQuant" title="Link to this definition"></a></dt>
<dd><p>Unit test for normQuant function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.comparisons.test_recursiveEquality">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.comparisons.</span></span><span class="sig-name descname"><span class="pre">test_recursiveEquality</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/comparisons.html#test_recursiveEquality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.comparisons.test_recursiveEquality" title="Link to this definition"></a></dt>
<dd><p>Unit test for recursiveEquality function</p>
</dd></dl>

</section>
<section id="module-pisa.utils.config_parser">
<span id="pisa-utils-config-parser-module"></span><h2>pisa.utils.config_parser module<a class="headerlink" href="#module-pisa.utils.config_parser" title="Link to this heading"></a></h2>
<p>Parse a config file into a dict containing an item for every analysis
stage, that itself contains all necessary instantiation arguments/objects for
that stage. For an example config file, please consider
<code class="file docutils literal notranslate"><span class="pre">$PISA/pisa_examples/resources/settings/pipeline/example.cfg</span></code></p>
<section id="config-file-structure">
<h3>Config File Structure<a class="headerlink" href="#config-file-structure" title="Link to this heading"></a></h3>
<p>A pipeline config file is expected to contain something like the following,
with the sections <code class="docutils literal notranslate"><span class="pre">[pipeline]</span></code> and corresponding <code class="docutils literal notranslate"><span class="pre">[stage.service]</span></code>
required, in addition to a <code class="docutils literal notranslate"><span class="pre">[binning]</span></code> section:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1">#include file_x.cfg as x</span>
<span class="c1">#include file_y.cfg as y</span>

<span class="k">[pipeline]</span>

<span class="na">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">stageA.serviceA, stageB.serviceB</span>

<span class="na">output_binning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">binning1</span>
<span class="na">output_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">weights, errors</span>


<span class="k">[binning]</span>

<span class="c1">#include generic_binning.cfg</span>

<span class="na">binning1.order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">axis1, axis2</span>
<span class="na">binning1.axis1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{</span>
<span class="w">    </span><span class="na">&#39;num_bins&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">40, &#39;is_log&#39;: True, &#39;domain&#39;: [1,80] units.GeV, &#39;tex&#39;: r&#39;A_1&#39;</span>
<span class="w">    </span><span class="na">}</span>
<span class="na">binning1.axis2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{</span>
<span class="w">    </span><span class="na">&#39;num_bins&#39;</span><span class="o">:</span><span class="w"> </span><span class="s">10, &#39;is_lin&#39;: True, &#39;domain&#39;: [1,5], &#39;tex&#39;: r&#39;A_2&#39;</span>
<span class="w">    </span><span class="na">}</span>


<span class="k">[stageA.serviceA]</span>

<span class="na">calc_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">binning1</span>
<span class="na">apply_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">binning1</span>
<span class="na">error_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">None</span>
<span class="na">debug_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">False</span>

<span class="na">param.p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.0 +/- 0.5 units.deg</span>
<span class="na">param.p1.fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">False</span>
<span class="na">param.p1.range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">nominal + [-2.0, +2.0] * sigma</span>

<span class="na">param.selector1.p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.5 +/- 0.5 units.deg</span>
<span class="na">param.selector1.p2.fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">False</span>
<span class="na">param.selector1.p2.range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">nominal + [-2.0, +2.0] * sigma</span>

<span class="na">param.selector2.p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">-0.5 +/- 0.1 units.deg</span>
<span class="na">param.selector2.p2.fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">False</span>
<span class="na">param.selector2.p2.range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">nominal + [-2.0, +2.0] * sigma</span>


<span class="k">[stageB.serviceB]</span>

<span class="na">calc_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">binning1</span>
<span class="na">apply_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">binning1</span>
<span class="na">error_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">None</span>
<span class="na">debug_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">False</span>

<span class="na">param.p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${stageA.serviceA:param.p1}</span>
<span class="na">param.selector1.p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${stageA.serviceA:param.selector1.p2}</span>
<span class="na">param.selector2.p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${stageA.serviceA:param.selector2.p2}</span>
<span class="na">...</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span></code> statements can be used to include other config files. The
#include statement must be the first non-whitespace on a line, and these
statements can be used anywhere within a config file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">resource</span> <span class="pre">as</span> <span class="pre">xyz</span></code> statements behave similarly, but prepend the
included file’s text with a section header containing <code class="docutils literal notranslate"><span class="pre">xyz</span></code> in this case.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pipeline</span></code> is the top-most section that defines the hierarchy of stages
and services to be instantiated. An <code class="docutils literal notranslate"><span class="pre">output_binning</span></code> is required to be able
to get a <a class="reference internal" href="pisa.core.html#pisa.core.map.MapSet" title="pisa.core.map.MapSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">pisa.core.map.MapSet</span></code></a> (set of histograms) output for
the pipeline; <code class="docutils literal notranslate"><span class="pre">output_key</span></code> then specifies the keys of the data passed
through the pipeline which contain histogram weights and (if desired) errors
(note: the presence of these keys is in general not obvious from a given
pipeline config file itself)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">binning</span></code> can contain different binning definitions, that are then later
referred to from within the <code class="docutils literal notranslate"><span class="pre">stage.service</span></code> sections.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stage.service</span></code>: one such section per stage.service is necessary. It may
contain the options <code class="docutils literal notranslate"><span class="pre">debug_mode</span></code>, <code class="docutils literal notranslate"><span class="pre">error_method</span></code>, <code class="docutils literal notranslate"><span class="pre">calc_mode</span></code>,
<code class="docutils literal notranslate"><span class="pre">apply_mode</span></code>, which are common to all stages, and must contain all the
necessary arguments and parameters for a given stage.service.</p></li>
<li><p>Duplicate section headers and duplicate keys within a section are illegal.</p></li>
</ul>
<section id="param-definitions">
<h4>Param definitions<a class="headerlink" href="#param-definitions" title="Link to this heading"></a></h4>
<p>Every key in a stage section that starts with <code class="docutils literal notranslate"><span class="pre">param.&lt;name&gt;</span></code> is interpreted and
parsed into a <a class="reference internal" href="pisa.core.html#pisa.core.param.Param" title="pisa.core.param.Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">pisa.core.param.Param</span></code></a> object. These can be strings
(e.g. a filename–but don’t use any quotation marks) or quantities (numbers
with units).</p>
<p>Quantities expect an expression that can be converted by the
<a class="reference internal" href="#pisa.utils.config_parser.parse_quantity" title="pisa.utils.config_parser.parse_quantity"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_quantity()</span></code></a> function. The expression for a quantity can optionally
include a simple Gaussian prior and units. The simplest definition of a
quantity with neither Gaussian prior nor units would look something like this:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="na">param.p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12.5</span>
</pre></div>
</div>
<p>Gaussian priors can be included for a quantity using <code class="docutils literal notranslate"><span class="pre">+/-</span></code> notation, where
the number that follows <code class="docutils literal notranslate"><span class="pre">+/-</span></code> is the standard deviation. E.g.:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="na">param.p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12.5 +/- 2.3</span>
</pre></div>
</div>
<p>If no units are explicitly set for a quantity, it is taken to be a quantity
with special units <code class="docutils literal notranslate"><span class="pre">dimensionless</span></code>. Units can be set by multiplying (using
<code class="docutils literal notranslate"><span class="pre">*</span></code>) by <code class="docutils literal notranslate"><span class="pre">units.&lt;unit&gt;</span></code> where <code class="docutils literal notranslate"><span class="pre">&lt;unit&gt;</span></code> is the short or long name
(optionally including metric prefix) of a unit. For example, the following
lines set equivalent values for params <code class="docutils literal notranslate"><span class="pre">p1</span></code> and <code class="docutils literal notranslate"><span class="pre">p2</span></code>:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="na">param.p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12.5 * units.GeV</span>
<span class="na">param.p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12.5 * units.gigaelectronvolt</span>
</pre></div>
</div>
<p>and this can be combined with the Gaussian-prior <code class="docutils literal notranslate"><span class="pre">+/-</span></code> notation:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="na">param.p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12.5 +/- 2.3 * units.GeV</span>
</pre></div>
</div>
<p>Additional arguments to a parameter are passed in with the <code class="docutils literal notranslate"><span class="pre">.</span></code> notation, for
example <code class="docutils literal notranslate"><span class="pre">param.p1.fixed</span> <span class="pre">=</span> <span class="pre">False</span></code>, which makes p1 a free parameter in the
fit (by default a parameter is fixed unless specified like this).</p>
<p>A uniform, spline, or Jeffreys <a class="reference internal" href="pisa.core.html#pisa.core.prior.Prior" title="pisa.core.prior.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">pisa.core.prior.Prior</span></code></a> can also be set
using the <code class="docutils literal notranslate"><span class="pre">.prior</span></code> attribute:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="na">param.p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12.5</span>
<span class="na">param.p1.prior</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">uniform</span>

<span class="na">param.p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12.5</span>
<span class="na">param.p2.prior</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">spline</span>
<span class="na">param.p2.prior.data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">resource_loc</span>

<span class="na">param.p3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">12.5</span>
<span class="na">param.p3.prior</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">jeffreys</span>
</pre></div>
</div>
<p>In the second case, a <code class="docutils literal notranslate"><span class="pre">.prior.data</span></code> option will be expected, pointing to the
spline data file.
If no prior is specified, it is taken to have no prior (or, equivalently, a
uniform prior with no penalty).</p>
<p>A range must be given for a free parameter. Either as absolute range <code class="docutils literal notranslate"><span class="pre">[x,y]</span></code>
or in conjunction with the keywords <code class="docutils literal notranslate"><span class="pre">nominal</span></code> (= nominal parameter value) and
<code class="docutils literal notranslate"><span class="pre">sigma</span></code> if the param was specified with the <code class="docutils literal notranslate"><span class="pre">+/-</span></code> notation.</p>
<section id="n-b">
<h5>N.B.<a class="headerlink" href="#n-b" title="Link to this heading"></a></h5>
<p>Params that have the same name in multiple stages of the pipeline are
instantiated as references to a single param in memory, so updating one updates
all of them.</p>
<p>Note that this mechanism of synchronizing parameters holds only within the
scope of a single pipeline; synchronization of parameters across pipelines is
done by adding the pipelines to a single
<a class="reference internal" href="pisa.core.html#pisa.core.distribution_maker.DistributionMaker" title="pisa.core.distribution_maker.DistributionMaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">pisa.core.distribution_maker.DistributionMaker</span></code></a> object and updating
params through the DistributionMaker’s
<a class="reference internal" href="pisa.core.html#pisa.core.distribution_maker.DistributionMaker.update_params" title="pisa.core.distribution_maker.DistributionMaker.update_params"><code class="xref py py-func docutils literal notranslate"><span class="pre">pisa.core.distribution_maker.DistributionMaker.update_params()</span></code></a> method.</p>
<p>If you DO NOT want parameters to be synchronized, provide a <code class="docutils literal notranslate"><span class="pre">unique_id</span></code> for them.
This is simply done by setting <code class="docutils literal notranslate"><span class="pre">.unique_id</span></code></p>
</section>
</section>
<section id="param-selector">
<h4>Param selector<a class="headerlink" href="#param-selector" title="Link to this heading"></a></h4>
<p>A special mechanism allows the user to specify different values for
the same param via the <a class="reference internal" href="pisa.core.html#pisa.core.param.ParamSelector" title="pisa.core.param.ParamSelector"><code class="xref py py-class docutils literal notranslate"><span class="pre">pisa.core.param.ParamSelector</span></code></a> mechanism.
This can be used for example for hypothesis testing, where for hypothesis A a
param takes one value and for hypothesis B another.</p>
<p>A given param, say <code class="docutils literal notranslate"><span class="pre">foo</span></code>, then needs two definitions like the following,
assuming we name our selections <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="na">param.A.foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">param.B.foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span>
</pre></div>
</div>
<p>The default param selector needs to be specified in the <code class="docutils literal notranslate"><span class="pre">pipeline</span></code> section as
e.g.</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="na">param_selections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">A</span>
</pre></div>
</div>
<p>, which will default to the value of 1 for param <code class="docutils literal notranslate"><span class="pre">foo</span></code>. An instantiated
pipeline can dynamically switch to another selection after instantiation.</p>
<p>Multiple different param selections are allowed in a single config. In the
default selection they must be separated by commas.</p>
<section id="id1">
<h5>N.B.<a class="headerlink" href="#id1" title="Link to this heading"></a></h5>
<p>Currently, for better or worse, the param selector mechanism requires at least
one stage which contains <cite>all</cite> of the specified selections.</p>
</section>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.config_parser.MutableMultiFileIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.config_parser.</span></span><span class="sig-name descname"><span class="pre">MutableMultiFileIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#MutableMultiFileIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.MutableMultiFileIterator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Iterate through the lines of an already-open file (<cite>fp</cite>) but then can pause
at any point and open and iterate through another file via the
<cite>switch_to_file</cite> method (and this file can be paused to iterate through
another, etc.).</p>
<p>This has the effect of in-lining files within files for e.g. parsing
multiple files as if they’re a singe file. Which line comes from which file
is also tracked for generating maximally-useful error messages, via the
<cite>location</cite> method.</p>
<p>Note that circular references are not allowed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>file-like object</em>) – The (opened) main config to be read. E.g. can be an opened file,
io.StringIO object, etc.</p></li>
<li><p><strong>fpname</strong> (<em>string</em>) – Identifier for the initially <cite>fp</cite> object</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.config_parser.MutableMultiFileIterator.location">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">location</span></span><a class="headerlink" href="#pisa.utils.config_parser.MutableMultiFileIterator.location" title="Link to this definition"></a></dt>
<dd><p>Full hierarchical location, formatted for display</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.config_parser.MutableMultiFileIterator.switch_to_file">
<span class="sig-name descname"><span class="pre">switch_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#MutableMultiFileIterator.switch_to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.MutableMultiFileIterator.switch_to_file" title="Link to this definition"></a></dt>
<dd><p>Switch iterator to a new resource location to continue processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> (<em>None</em><em> or </em><em>file-like object</em>) – If <cite>fp</cite> is specified, this takes precedence over <cite>fpname</cite>.</p></li>
<li><p><strong>fpname</strong> (<em>None</em><em> or </em><em>string</em>) – Path of the file or resource to read from. This resource will be
located and opened if <cite>fp</cite> is None.</p></li>
<li><p><strong>encoding</strong> – Argument is passed to the builtin <code class="docutils literal notranslate"><span class="pre">open</span></code> function for opening
the file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.config_parser.PISAConfigParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.config_parser.</span></span><span class="sig-name descname"><span class="pre">PISAConfigParser</span></span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#PISAConfigParser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.PISAConfigParser" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RawConfigParser</span></code></p>
<p>Parses a PISA config file, extending <code class="xref py py-class docutils literal notranslate"><span class="pre">configparser.RawConfigParser</span></code>
(the backport of RawConfigParser from Python 3.x) by adding the ability to
include external files inline via, for example:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="c1">#include /path/to/file.cfg</span>
<span class="c1">#include path/to/resource.cfg</span>
<span class="c1">#include path/to/resource2.cfg as section2</span>

<span class="k">[section1]</span>
<span class="na">key11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">value1</span>
<span class="na">key12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${section2:key21}</span>
<span class="na">key13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">value3</span>
</pre></div>
</div>
<p>where the files or resources located at “/path/to/file.cfg”,
“path/to/resource.cfg”, and “path/to/resource2.cfg” are effectively inlined
wherever the <code class="docutils literal notranslate"><span class="pre">#include</span></code> statements occur.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">path/to/resource2.cfg</span> <span class="pre">as</span> <span class="pre">section_name</span></code> syntax
prefixes the contents of <code class="docutils literal notranslate"><span class="pre">resource2.cfg</span></code> by a section header named
“section2”, expanding <code class="docutils literal notranslate"><span class="pre">resource2.cfg</span></code> as:</p>
<div class="highlight-cfg notranslate"><div class="highlight"><pre><span></span><span class="k">[section2]</span>
<span class="na">line1 of resource2.cfg</span>
<span class="na">line2 of resource2.cfg</span>
<span class="na">... etc.</span>
</pre></div>
</div>
<p>Special parsing rules we have added to make <code class="docutils literal notranslate"><span class="pre">#include</span></code> behavior sensible:</p>
<ol class="arabic simple">
<li><p>Using an <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">file</span></code> that contains a section header
(<code class="docutils literal notranslate"><span class="pre">[section_name]</span></code>) <em>or</em> using <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">file</span> <span class="pre">as</span> <span class="pre">section_name</span></code>
requires that the next non-blank / non-comment / non-<code class="docutils literal notranslate"><span class="pre">#include</span></code> line
be a new section header (<code class="docutils literal notranslate"><span class="pre">[section_name2]</span></code>).</p></li>
<li><p>Empty sections after fully parsing a config will raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.
This is likely never a desired behavior, and should alert the user to
inadvertent use of <code class="docutils literal notranslate"><span class="pre">#include</span></code>.</p></li>
</ol>
<p>Also note that, unlike the default <code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigParser</span></code>
behavior, <code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedInterpolation</span></code> is used, whitespace
surrounding text in a section header is ignored, empty lines are <em>not</em>
allowed between multi-line values, and section names, keys, and values are
all case-sensitive.</p>
<p>All other options are taken as the defaults / default behaviors of
<code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigParser</span></code>.</p>
<p>See help for <code class="xref py py-class docutils literal notranslate"><span class="pre">configparser.ConfigParser</span></code> for further help on valid
config file syntax and parsing behavior.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.config_parser.PISAConfigParser.INCLUDE_AS_RE">
<span class="sig-name descname"><span class="pre">INCLUDE_AS_RE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('\\s*(?P&lt;file&gt;.+)((?:\\s+as\\s+)(?P&lt;as&gt;\\S+))')</span></em><a class="headerlink" href="#pisa.utils.config_parser.PISAConfigParser.INCLUDE_AS_RE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.config_parser.PISAConfigParser.INCLUDE_RE">
<span class="sig-name descname"><span class="pre">INCLUDE_RE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('\\s*#include\\s+(?P&lt;include&gt;\\S.*)')</span></em><a class="headerlink" href="#pisa.utils.config_parser.PISAConfigParser.INCLUDE_RE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.config_parser.PISAConfigParser.SECTCRE">
<span class="sig-name descname"><span class="pre">SECTCRE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('\\[\\s*(?P&lt;header&gt;[^]]+?)\\s*\\]')</span></em><a class="headerlink" href="#pisa.utils.config_parser.PISAConfigParser.SECTCRE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.config_parser.PISAConfigParser.add_section">
<span class="sig-name descname"><span class="pre">add_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">section</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#PISAConfigParser.add_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.PISAConfigParser.add_section" title="Link to this definition"></a></dt>
<dd><p>Create a new section in the configuration.  Extends
RawConfigParser.add_section by validating if the section name is
a string.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.config_parser.PISAConfigParser.hash">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hash</span></span><a class="headerlink" href="#pisa.utils.config_parser.PISAConfigParser.hash" title="Link to this definition"></a></dt>
<dd><p>Hash value of the contents (does not depend on order of
sections, but does depend on order of keys within each section)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.config_parser.PISAConfigParser.optionxform">
<span class="sig-name descname"><span class="pre">optionxform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optionstr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#PISAConfigParser.optionxform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.PISAConfigParser.optionxform" title="Link to this definition"></a></dt>
<dd><p>Enable case-sensitive options in .cfg files, and force all values to
be ASCII strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.config_parser.PISAConfigParser.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#PISAConfigParser.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.PISAConfigParser.read" title="Link to this definition"></a></dt>
<dd><p>Override <cite>read</cite> method to interpret <cite>filenames</cite> as PISA resource
locations, then call overridden <cite>read</cite> method. Also, IOError fails
here, whereas it is ignored in RawConfigParser.</p>
<p>For further help on this method and its arguments, see
<a href="#id2"><span class="problematic" id="id3">:method:`~backports.configparser.configparser.read`</span></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.config_parser.PISAConfigParser.set">
<span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">section</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#PISAConfigParser.set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.PISAConfigParser.set" title="Link to this definition"></a></dt>
<dd><p>Set an option.  Extends RawConfigParser.set by validating type and
interpolation syntax on the value.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.config_parser.interpret_param_subfields">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.config_parser.</span></span><span class="sig-name descname"><span class="pre">interpret_param_subfields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subfields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#interpret_param_subfields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.interpret_param_subfields" title="Link to this definition"></a></dt>
<dd><p>Recursively interpret and parse parameter subfields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subfields</strong> (<em>list</em><em> of </em><em>strings</em>)</p></li>
<li><p><strong>selector</strong> (<em>string</em>)</p></li>
<li><p><strong>pname</strong> (<em>string</em>)</p></li>
<li><p><strong>attr</strong> (<em>list</em><em> of </em><em>strings</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>infodict</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">interpret_param_subfields</span><span class="p">(</span><span class="n">subfields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nh&#39;</span><span class="p">,</span> <span class="s1">&#39;deltam31&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">]))</span>
<span class="go">{&#39;pname&#39;: &#39;deltam31&#39;, &#39;subfields&#39;: [], &#39;attr&#39;: [&#39;range&#39;], &#39;selector&#39;: &#39;nh&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.config_parser.parse_param">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.config_parser.</span></span><span class="sig-name descname"><span class="pre">parse_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fullname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#parse_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.parse_param" title="Link to this definition"></a></dt>
<dd><p>Parse a param specification from a PISA config file.</p>
<p>Note that if the param specification does not include <code class="docutils literal notranslate"><span class="pre">fixed</span></code>,
<code class="docutils literal notranslate"><span class="pre">prior</span></code>, and/or <code class="docutils literal notranslate"><span class="pre">range</span></code>, the defaults for these are:
<code class="docutils literal notranslate"><span class="pre">fixed</span> <span class="pre">=</span> <span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">prior</span> <span class="pre">=</span> <span class="pre">None</span></code>, and <code class="docutils literal notranslate"><span class="pre">range</span> <span class="pre">=</span> <span class="pre">None</span></code>.</p>
<p>If a prior is specified explicitly via <code class="docutils literal notranslate"><span class="pre">.prior</span></code>, this takes precendence,
but if no <code class="docutils literal notranslate"><span class="pre">.prior</span></code> is specified and the param’s value is parsed to be a
<code class="xref py py-class docutils literal notranslate"><span class="pre">uncertainties.AffineScalarFunc</span></code> (i.e. have <code class="docutils literal notranslate"><span class="pre">std_dev</span></code> attribute),
a Gaussian prior is constructed from that and then the AffineScalarFunc is
stripped out of the param’s value (such that it is just a
<code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#pisa.utils.config_parser.PISAConfigParser" title="pisa.utils.config_parser.PISAConfigParser"><em>pisa.utils.config_parser.PISAConfigParser</em></a>)</p></li>
<li><p><strong>section</strong> (<em>string</em>)</p></li>
<li><p><strong>selector</strong> (<em>string</em><em> or </em><em>None</em>)</p></li>
<li><p><strong>fullname</strong> (<em>string</em>)</p></li>
<li><p><strong>pname</strong> (<em>string</em>)</p></li>
<li><p><strong>value</strong> (<em>string</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>param</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pisa.core.html#pisa.core.param.Param" title="pisa.core.param.Param">pisa.core.param.Param</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.config_parser.parse_pipeline_config">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.config_parser.</span></span><span class="sig-name descname"><span class="pre">parse_pipeline_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#parse_pipeline_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.parse_pipeline_config" title="Link to this definition"></a></dt>
<dd><p>Parse pipeline config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>string</em><em> or </em><a class="reference internal" href="#pisa.utils.config_parser.PISAConfigParser" title="pisa.utils.config_parser.PISAConfigParser"><em>pisa.utils.config_parser.PISAConfigParser</em></a>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>stage_dicts</strong> – Keys are (stage_name, service_name) tuples and values are OrderedDicts
with arguments’ names as keys and values as values. Some known arg
values are parsed out fully into Python objects, while the rest remain
as strings that must be used or parsed elsewhere.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="pisa.html#pisa.OrderedDict" title="pisa.OrderedDict">OrderedDict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.config_parser.parse_quantity">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.config_parser.</span></span><span class="sig-name descname"><span class="pre">parse_quantity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#parse_quantity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.parse_quantity" title="Link to this definition"></a></dt>
<dd><p>Parse a string into a pint/uncertainty quantity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>string</strong> (<em>string</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>value</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pint.quantity of uncertainties.core.AffineScalarFunc</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">quant</span> <span class="o">=</span> <span class="n">parse_quantity</span><span class="p">(</span><span class="s1">&#39;1.2 +/- 0.7 * units.meter&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">quant</span><span class="p">))</span>
<span class="go">1.2+/-0.7 meter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;{:~}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">quant</span><span class="p">))</span>
<span class="go">1.2+/-0.7 m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">quant</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>
<span class="go">1.2+/-0.7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">quant</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<span class="go">meter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">quant</span><span class="o">.</span><span class="n">nominal_value</span><span class="p">)</span>
<span class="go">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">quant</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
<span class="go">0.7</span>
</pre></div>
</div>
<p>Also note that spaces and the “*” are optional:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">parse_quantity</span><span class="p">(</span><span class="s1">&#39;1+/-1units.GeV&#39;</span><span class="p">))</span>
<span class="go">1.0+/-1.0 gigaelectron_volt</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.config_parser.parse_string_literal">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.config_parser.</span></span><span class="sig-name descname"><span class="pre">parse_string_literal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/config_parser.html#parse_string_literal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.config_parser.parse_string_literal" title="Link to this definition"></a></dt>
<dd><p>Evaluate a string with certain special values, or return the string. Any
further parsing must be done outside this module, as this is as specialized
as we’re willing to be in assuming/interpreting what a string is supposed
to mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>string</strong> (<em>string</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>val</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool, None, or str</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">parse_string_literal</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">parse_string_literal</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">parse_string_literal</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">))</span>
<span class="go">None</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">parse_string_literal</span><span class="p">(</span><span class="s1">&#39;something else&#39;</span><span class="p">))</span>
<span class="go">&#39;something else&#39;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pisa.utils.cross_sections">
<span id="pisa-utils-cross-sections-module"></span><h2>pisa.utils.cross_sections module<a class="headerlink" href="#module-pisa.utils.cross_sections" title="Link to this heading"></a></h2>
<p>Define CrossSections class for importing, working with, and storing neutrino
cross sections</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.cross_sections.</span></span><span class="sig-name descname"><span class="pre">CrossSections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cross_sections/cross_sections.json'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pisa.utils.flavInt.FlavIntData" title="pisa.utils.flavInt.FlavIntData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlavIntData</span></code></a></p>
<p>Cross sections for each neutrino flavor &amp; interaction type (“flavint”).
What is stored are <em>PER-H2O-MOLECULE</em> cross sections, in units of [m^2].</p>
<p>Be careful when using these; cross sections are often plotted in the
literature as per-nucleon and per-energy with units [10^-38 cm^2 / GeV].</p>
<dl>
<dt>ver<span class="classifier">string</span></dt><dd><p>Version of cross sections to load from file. E.g. ‘genie_2.6.4’</p>
</dd>
<dt>energy<span class="classifier">None or array of float</span></dt><dd><p>Energies at which cross sections are defined.</p>
</dd>
<dt>xsec<span class="classifier">string, dictonary, or another CrossSections object</span></dt><dd><p>If str: provides PISA resource name from which to load cross sections
If dict or CrossSections object: construct cross sections from a</p>
<blockquote>
<div><p>deepcopy of that object</p>
</div></blockquote>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.get_version">
<span class="sig-name descname"><span class="pre">get_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.get_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.get_version" title="Link to this definition"></a></dt>
<dd><p>Return the cross sections version string</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.get_xs_ratio_integral">
<span class="sig-name descname"><span class="pre">get_xs_ratio_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flavintgroup0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flavintgroup1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.get_xs_ratio_integral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.get_xs_ratio_integral" title="Link to this definition"></a></dt>
<dd><p>Energy-spectrum-weighted integral of (possibly a ratio of)
(possibly-combined) flavor/interaction type cross sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flavintgroup0</strong> (<a class="reference internal" href="#pisa.utils.flavInt.NuFlavIntGroup" title="pisa.utils.flavInt.NuFlavIntGroup"><em>NuFlavIntGroup</em></a><em> or </em><em>convertible thereto</em>) – Flavor(s)/interaction type(s) for which to combine cross sections
for numerator of ratio</p></li>
<li><p><strong>flavintgroup1</strong> (<em>None</em><em>, </em><a class="reference internal" href="#pisa.utils.flavInt.NuFlavIntGroup" title="pisa.utils.flavInt.NuFlavIntGroup"><em>NuFlavIntGroup</em></a><em> or </em><em>convertible thereto</em>) – Flavor(s)/interaction type(s) for which to combine cross sections
for denominator of ratio. If None is passed, the denominator of
the “ratio” is effectively 1.</p></li>
<li><p><strong>e_range</strong> – Range of energy over which to integrate (GeV)</p></li>
<li><p><strong>gamma</strong> (<em>float &gt;= 0</em>) – Power law spectral index used for weighting the integral,
E^{-<cite>gamma</cite>}. Note that <cite>gamma</cite> should be &gt;= 0.</p></li>
<li><p><strong>average</strong> (<em>bool</em>) – If True, return the average of the cross section (ratio)
If False, return the integral of the cross section (ratio)</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">See</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.get_xs_ratio_value">
<span class="sig-name descname"><span class="pre">get_xs_ratio_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flavintgroup0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flavintgroup1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.get_xs_ratio_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.get_xs_ratio_value" title="Link to this definition"></a></dt>
<dd><p>Get ratio of combined cross sections for <cite>flavintgroup0</cite> to combined
cross sections for <cite>flavintgroup1</cite>, weighted by E^{-<cite>gamma</cite>}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flavintgroup0</strong> (<a class="reference internal" href="#pisa.utils.flavInt.NuFlavIntGroup" title="pisa.utils.flavInt.NuFlavIntGroup"><em>NuFlavIntGroup</em></a><em> or </em><em>convertible thereto</em>)</p></li>
<li><p><strong>flavintgroup1</strong> (<a class="reference internal" href="#pisa.utils.flavInt.NuFlavIntGroup" title="pisa.utils.flavInt.NuFlavIntGroup"><em>NuFlavIntGroup</em></a><em> or </em><em>convertible thereto</em>)</p></li>
<li><p><strong>energy</strong> (<em>numeric</em><em> or </em><em>sequence thereof</em>) – Energy (or energies) at which to evaluate total cross section, in
units of GeV</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Ratio of combined cross sections flavintgroup0 / flavintgroup1</em></p></li>
<li><p><em>evaluated at each energy. Shape of returned value matches that of</em></p></li>
<li><p>passed <cite>energy</cite> parameter.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.get_xs_value">
<span class="sig-name descname"><span class="pre">get_xs_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flavintgroup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.get_xs_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.get_xs_value" title="Link to this definition"></a></dt>
<dd><p>Get (combined) cross section value (in units of m^2) for
<cite>flavintgroup</cite> at <cite>energy</cite> (in units of GeV).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flavintgroup</strong> (<a class="reference internal" href="#pisa.utils.flavInt.NuFlavIntGroup" title="pisa.utils.flavInt.NuFlavIntGroup"><em>NuFlavIntGroup</em></a><em> or </em><em>convertible thereto</em>)</p></li>
<li><p><strong>energy</strong> (<em>numeric</em><em> or </em><em>sequence thereof</em>) – Energy (or energies) at which to evaluate total cross section, in
units of GeV</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Combined cross section for flavor/interaction types in units of</em></p></li>
<li><p><em>m^2, evaluated at each energy. Shape of returned value matches that of</em></p></li>
<li><p>passed <cite>energy</cite> parameter.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.load">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.load" title="Link to this definition"></a></dt>
<dd><p>Load cross sections from a file locatable and readable by the PISA
from_file command. If <cite>ver</cite> is provided, it is used to index into the
top level of the loaded dictionary</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.load_root_file">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_root_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_sfx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_tot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o_sfx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_o16'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_sfx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_h1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plt_sfx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_plot'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.load_root_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.load_root_file" title="Link to this definition"></a></dt>
<dd><p>Load cross sections from root file, where graphs are first-level in
hierarchy. This is yet crude and not very flexible, but at least it’s
recorded here for posterity.</p>
<p>Requires ROOT and ROOT python module be installed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpath</strong> (<em>string</em>) – Path to ROOT file</p></li>
<li><p><strong>ver</strong> (<em>string</em>) – Necessary to differentaite among different file formats that Ken
has sent out</p></li>
<li><p><strong>tot_sfx</strong> (<em>string</em><em> (</em><em>default = '_tot'</em><em>)</em>) – Suffix for finding total cross sections in ROOT file (if these
fields are found, the oxygen/hydrogen fields are skipped)</p></li>
<li><p><strong>o_sfx</strong> (<em>string</em><em> (</em><em>default = '_o16'</em><em>)</em>) – Suffix for finding oxygen-16 cross sections in ROOT file</p></li>
<li><p><strong>h_sfx</strong> (<em>string</em><em> (</em><em>default = '_h1'</em><em>)</em>) – Suffix for finding hydrogen-1 cross sections in ROOT file</p></li>
<li><p><strong>plt_sfx</strong> (<em>string</em><em> (</em><em>default = '_plt'</em><em>)</em>) – Suffix for plots containing cross sections per GeV in ROOT file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>xsec</strong> – Object containing the loaded cross sections</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pisa.utils.flavInt.FlavIntData" title="pisa.utils.flavInt.FlavIntData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pisa.utils.flavInt.FlavIntData</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.new_from_root">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">new_from_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ver</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.new_from_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.new_from_root" title="Link to this definition"></a></dt>
<dd><p>Instantiate a new CrossSections object from ROOT file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpath</strong> (<em>string</em>) – PISA resource specification for location of ROOT file</p></li>
<li><p><strong>ver</strong> (<em>string</em>) – Specify the version name of the cross sections loaded</p></li>
<li><p><strong>**kwargs</strong> – Passed to method load_root_file()</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Instantiated CrossSections object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.plot" title="Link to this definition"></a></dt>
<dd><p>Plot cross sections per GeV; optionally, save plot to file. Requires
matplotlib and optionally uses seaborn to set “pretty” defaults.</p>
<dl class="simple">
<dt>save<span class="classifier">None, str, or dict</span></dt><dd><p>If None, figure is not saved (default)
If a string, saves figure as that name
If a dict, calls pyplot.savefig(<a href="#id4"><span class="problematic" id="id5">**</span></a>save) (i.e., save contains
keyword args to savefig)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.save" title="Link to this definition"></a></dt>
<dd><p>Save cross sections (and the energy specification) to a file at
<cite>fpath</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.set_version">
<span class="sig-name descname"><span class="pre">set_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.set_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.set_version" title="Link to this definition"></a></dt>
<dd><p>Set the cross sections version to the string <cite>ver</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.CrossSections.validate_xsec">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_xsec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xsec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#CrossSections.validate_xsec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.CrossSections.validate_xsec" title="Link to this definition"></a></dt>
<dd><p>Validate cross sections</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.cross_sections.manual_test_CrossSections">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.cross_sections.</span></span><span class="sig-name descname"><span class="pre">manual_test_CrossSections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/cross_sections.html#manual_test_CrossSections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.cross_sections.manual_test_CrossSections" title="Link to this definition"></a></dt>
<dd><p>Unit tests for CrossSections class</p>
</dd></dl>

</section>
<section id="module-pisa.utils.data_proc_params">
<span id="pisa-utils-data-proc-params-module"></span><h2>pisa.utils.data_proc_params module<a class="headerlink" href="#module-pisa.utils.data_proc_params" title="Link to this heading"></a></h2>
<p>DataProcParams class for importing, working with, and storing data processing
parameters (e.g., PINGU’s V5 processing).</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.data_proc_params.</span></span><span class="sig-name descname"><span class="pre">DataProcParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proc_ver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_proc_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Class for importing, working with, and storing data processing
parameters.</p>
<p>Implements cutting and particle identification (PID) functionality that can
be applied to MC/data that have the specified verion of processing applied
to it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_proc_params</strong> (<em>string</em><em> or </em><em>dict</em>) – <dl class="simple">
<dt>If string: looks for the corresponding JSON resource (file) and loads</dt><dd><p>the contents as a data_proc_params dict</p>
</dd>
</dl>
<p>If dict: taken to be data_proc_params dict
The data_proc_params dict must follow the format described below.</p>
</p></li>
<li><p><strong>detector</strong> (<em>string</em>) – Converted to lower-case string which must be a detector key in
data_proc_params dict</p></li>
<li><p><strong>proc_ver</strong> – Converted to lower-case string which must be a proc_ver key in
data_proc_params dict</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All information describing the processing version is loaded from a JSON
file with the following defined format:</p>
<p>Note that the following common cuts are defined in this class and so
needn’t be defined in the JSON file:</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><p>‘1’ : Select particles</p>
</div></blockquote>
<p>‘-1’ : Select anti-particles
‘cc’ : Select charged-current (CC) interactions
‘nc’ : Select neutral-current (NC) interactions</p>
</div></blockquote>
<p>‘true_upgoing_zen’ : Select true-upgoing events by zenith angle</p>
</div></blockquote>
<p>‘true_upgoing_coszen’ : Select true-upgoing events by cos(zenith) angle</p>
<p>data_proc_params dictionary format (and same for corresponding JSON file):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="c1"># Specify the detector name, lower case</span>

  <span class="s2">&quot;&lt;lower-case detector name&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>

    <span class="c1"># Specify the processing version, lower case</span>
    <span class="c1"># Examples in PINGU include &quot;4&quot;, &quot;5&quot;, and &quot;5.1&quot;</span>

    <span class="s2">&quot;&lt;lower-case processing version&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>


      <span class="c1"># Mapping from standard names to path where these can be found in</span>
      <span class="c1"># source HDF5 file; separate HDF5 path nodes with a forward-slash.</span>
      <span class="c1">#</span>
      <span class="c1"># Fields that cuts or particles in the &quot;cuts&quot;/&quot;pid&quot; sections below</span>
      <span class="c1"># require (e.g., &quot;cuts_step_1&quot; for PINGU v5 processing), must be</span>
      <span class="c1"># added here so the code knows how to extract the info from the</span>
      <span class="c1"># source HDF5 file.</span>
      <span class="c1">#</span>
      <span class="c1"># Outputting a PID field to the destination PISA HDF5 file will *not*</span>
      <span class="c1"># be done if the &quot;pid&quot; field is omitted below.</span>
      <span class="c1">#</span>
      <span class="c1"># In addition to the below-named fields, &quot;true_coszen&quot; and</span>
      <span class="c1"># &quot;reco_coszen&quot; are generated from the data from the &quot;true_zenith&quot;</span>
      <span class="c1"># and &quot;reco_zenith&quot; fields, respectively. So any of those fields can</span>
      <span class="c1"># be used via the aforementioned names.</span>

      <span class="s2">&quot;field_map&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;run&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nu_code&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;true_energy&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;true_zenith&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reco_energy&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reco_zenith&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;one_weight&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;generator_volume&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;generator_radius&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;detection_length&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;interaction_type&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;azimuth_min&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;azimuth_max&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;zenith_min&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;zenith_max&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;energy_log_min&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;energy_log_max&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;num_events_per_file&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sim_spectral_index&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pid&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;HDF5 path to corresponding node&gt;&quot;</span><span class="p">,</span>
      <span class="p">},</span>


      <span class="c1"># Mapping from file&#39;s nu code to PDG nu codes (only necessary if</span>
      <span class="c1"># nu_code values are not the PDG codes listed below)</span>

      <span class="s2">&quot;nu_code_to_pdg_map&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;&lt;source nue code&gt;&quot;</span><span class="p">:</span>        <span class="mi">12</span><span class="p">,</span>
        <span class="s2">&quot;&lt;source nue_bar code&gt;&quot;</span><span class="p">:</span>   <span class="o">-</span><span class="mi">12</span><span class="p">,</span>
        <span class="s2">&quot;&lt;source numu code&gt;&quot;</span><span class="p">:</span>       <span class="mi">14</span><span class="p">,</span>
        <span class="s2">&quot;&lt;source numu_bar code&gt;&quot;</span><span class="p">:</span>  <span class="o">-</span><span class="mi">14</span><span class="p">,</span>
        <span class="s2">&quot;&lt;source nutau code&gt;&quot;</span><span class="p">:</span>      <span class="mi">16</span><span class="p">,</span>
        <span class="s2">&quot;&lt;source nutau_bar code&gt;&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">16</span>
      <span class="p">},</span>


      <span class="c1"># Specify standard cuts</span>

      <span class="s2">&quot;cuts&quot;</span><span class="p">:</span> <span class="p">{</span>


        <span class="c1"># Cut name; &quot;bjrej&quot; and &quot;analysis&quot; listed here are just example</span>
        <span class="c1"># names for cuts one might specify</span>

        <span class="s2">&quot;bgrej&quot;</span><span class="p">:</span> <span class="p">{</span>

          <span class="c1"># Which of the fields in the field_map (and the derived fields</span>
          <span class="c1"># such as true_coszen and reco_coszen) are required for this cut?</span>

          <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;field1&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;field2&gt;&quot;</span><span class="p">,</span> <span class="o">...</span> <span class="p">],</span>

          <span class="c1"># Expression for an event to pass the cut (not get thrown away);</span>
          <span class="c1"># see below for details on specifying an expression</span>

          <span class="s2">&quot;pass_if&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;expression&gt;&quot;</span>
        <span class="p">},</span>

        <span class="s2">&quot;analysis&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;field1&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;field2&gt;&quot;</span><span class="p">,</span> <span class="o">...</span> <span class="p">],</span>
          <span class="s2">&quot;pass_if&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;expression&gt;&quot;</span>
        <span class="p">},</span>

        <span class="s2">&quot;&lt;cut name&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;field1&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;field2&gt;&quot;</span><span class="p">,</span> <span class="o">...</span> <span class="p">],</span>
          <span class="s2">&quot;pass_if&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;expression&gt;&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>


      <span class="c1"># Particle identification section</span>

      <span class="s2">&quot;pid&quot;</span><span class="p">:</span> <span class="p">{</span>


        <span class="c1"># Name of the particle (case-insensitive); e.g., in PINGU this</span>
        <span class="c1"># would be &quot;trck&quot; or &quot;cscd&quot;</span>

        <span class="s2">&quot;&lt;particle name 1&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>


          <span class="c1"># Which of the fields in the field_map (and the derived fields</span>
          <span class="c1"># such as true_coszen and reco_coszen) are required for this cut?</span>

          <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">field1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">field2</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>


          <span class="c1"># Expression for an event to be classified as this type of</span>
          <span class="c1"># particle; # see below for details on specifying an expression</span>

          <span class="s2">&quot;criteria&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;expression&gt;&quot;</span>
        <span class="p">}</span>

        <span class="s2">&quot;&lt;particle name 2&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">field1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">field2</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
          <span class="s2">&quot;criteria&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;expression&gt;&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that cuts “pass_if” and pid “criteria” expressions can make use of the
numpy namespace and have access to any columns extracted from the source
HDF5 file, by the standardized names given in the “field_map”. For example,
if the following “fields” are specified for a cut in the data_proc_params
dict:</p>
<blockquote>
<div><p>[“cuts_step_1”, “cuts_step_2”]</p>
</div></blockquote>
<dl class="simple">
<dt>then the following is a valid “pass_if” expression:</dt><dd><p>“(reco_zenith &gt; pi/2) &amp; (cuts_step_1 == 1) &amp; (cuts_step_2 == 1)”</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.apply_cuts">
<span class="sig-name descname"><span class="pre">apply_cuts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cuts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boolean_op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&amp;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.apply_cuts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.apply_cuts" title="Link to this definition"></a></dt>
<dd><p>Perform <cite>cuts</cite> on <cite>data</cite> and return a dict containing
<cite>return_fields</cite> from events that pass the cuts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>single-level dict</em><em> or </em><em>FlavIntData object</em>)</p></li>
<li><p><strong>cuts</strong> (<em>string</em><em> or </em><em>dict</em><em>, or </em><em>sequence thereof</em>)</p></li>
<li><p><strong>boolean_op</strong> (<em>string</em>)</p></li>
<li><p><strong>return_fields</strong> (<em>string</em><em> or </em><em>sequence thereof</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.cut_bool_idx">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cut_bool_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_criteria</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.cut_bool_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.cut_bool_idx" title="Link to this definition"></a></dt>
<dd><p>Return numpy boolean indexing for data in <cite>h5group</cite> given a cut
specified using <cite>cut_fields</cite> in the <cite>h5group</cite> and evaluation criteria
<cite>keep_criteria</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5group</strong> (<em>h5py node/entity</em>)</p></li>
<li><p><strong>cut_fields</strong> (<em>field_map dict</em>)</p></li>
<li><p><strong>keep_criteria</strong> (<em>string</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>bool_idx</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array (1=keep, 0=reject)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flav</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.get_data" title="Link to this definition"></a></dt>
<dd><p>Get data attached to an HDF5 node, returned as a dictionary.</p>
<p>The returned dictionary’s keys match those in the field_map and the
dict’s values are the data from the HDF5’s nodes found at the addresses
specified as values in the field_map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_type</strong> (<em>string</em><em>, </em><em>one</em><em> of </em><em>{'mc'</em><em>, </em><em>'data'}</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.interpret_data">
<span class="sig-name descname"><span class="pre">interpret_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.interpret_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.interpret_data" title="Link to this definition"></a></dt>
<dd><p>Perform mappings from non-standard to standard values (such as
translating non-PDG neutrino flavor codes to PDG codes) and add
fields expected to be useful (such as coszen, derived from zen fields).</p>
<p>Attach / reattach the translated/new fields to the <cite>data</cite> object passed
into this methd.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.populate_global_namespace">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">populate_global_namespace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.populate_global_namespace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.populate_global_namespace" title="Link to this definition"></a></dt>
<dd><p>Populate the Python global namespace with variables named as the
keys in <cite>field_map</cite> and values loaded from the <cite>h5group</cite> at addresses
specified by the corresponding values in <cite>field_map</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.retrieve_expression">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">retrieve_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expression</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.retrieve_expression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.retrieve_expression" title="Link to this definition"></a></dt>
<dd><p>Retrieve data from an HDF5 group <cite>h5group</cite> according to
<cite>expresssion</cite>. This can apply expressions with simple mathematical
operators and numpy functions to multiple fields within the HDF5 file
to derive the output. Python keywords are _not_ allowed, since they
may alias with a name.</p>
<p>Refer to any numpy functions by prefixing with either “np.&lt;func&gt;” or
“numpy.&lt;func&gt;”. In order to specify division, spaces must surround the
forward slash, such that it isn’t interpreted as a path.</p>
<p>Nodes in the HDF5 hierarchy are separated by forward slashes (“/”) in a
path spec. We restrict valid HDF5 node names to contain the characters
a-z, A-Z, 0-9, peroids (“.”), and underscores (“_”). with the
additional restriction that the node name must not start with a period
or a number, and a path cannot start with a slash.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5group</strong> (<em>h5py Group</em>)</p></li>
<li><p><strong>expression</strong> (<em>string</em>) – Expression to evaluate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>result of evaluating <cite>expression</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">retrieve_expression</span><span class="p">(</span><span class="s1">&#39;np.sqrt(MCneutrino/x**2 + MCneutrino/y**2)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Indexing into the data arrays can also be performed, and numpy masks
used as usual:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="s1">&#39;I3MCTree/energy[I3MCTree/event == I3EventHeader[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.retrieve_node_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">retrieve_node_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">address</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.retrieve_node_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.retrieve_node_data" title="Link to this definition"></a></dt>
<dd><p>Retrieve data from an HDF5 group <cite>group</cite> at address <cite>address</cite>.
Levels of hierarchy are separated by forward-slashes (‘/’).</p>
<p>See h5py for further details on specifying a valid <cite>address</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.subselect">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subselect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.subselect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.subselect" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.validate_cut_spec">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_cut_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cuts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.validate_cut_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.validate_cut_spec" title="Link to this definition"></a></dt>
<dd><p>Validate a cut specification dictionary</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.data_proc_params.DataProcParams.validate_pid_spec">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_pid_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/data_proc_params.html#DataProcParams.validate_pid_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.data_proc_params.DataProcParams.validate_pid_spec" title="Link to this definition"></a></dt>
<dd><p>Validate a PID specification dictionary</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pisa.utils.fileio">
<span id="pisa-utils-fileio-module"></span><h2>pisa.utils.fileio module<a class="headerlink" href="#module-pisa.utils.fileio" title="Link to this heading"></a></h2>
<p>Generic file I/O, dispatching specific file readers/writers as necessary</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.expand">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">expand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_user</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolve_symlinks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#expand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.expand" title="Link to this definition"></a></dt>
<dd><p>Convenience function for expanding a path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>string</em>) – Path to be expanded.</p></li>
<li><p><strong>exp_vars</strong> (<em>bool</em>) – Expand the string using environment variables. E.g.
“$HOME/${vardir}/xyz” will have “$HOME” and “${vardir}$” replaced by
the values stored in “HOME” and “vardir”.</p></li>
<li><p><strong>exp_user</strong> (<em>bool</em>) – Expand special home dir spec character, tilde: “~”.</p></li>
<li><p><strong>absolute</strong> (<em>bool</em>) – Make a relative path (e.g. “../xyz”) absolute, referenced from system
root directory, “/dir/sbudir/xyz”.</p></li>
<li><p><strong>resolve_symlinks</strong> (<em>bool</em>) – Resolve symlinks to the paths they refer to</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>exp_path</strong> – Expanded path</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.find_files">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">find_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regex=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurse=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_sorter=&lt;function</span> <span class="pre">nsort&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_sorter=&lt;function</span> <span class="pre">nsort&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#find_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.find_files" title="Link to this definition"></a></dt>
<dd><p>Find files by re or name recursively w/ ordering.</p>
<p>Code adapted from
stackoverflow.com/questions/18282370/python-os-walk-what-order</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>str</em>) – Root directory at which to start searching for files</p></li>
<li><p><strong>regex</strong> (<em>str</em><em> or </em><em>re.SRE_Pattern</em>) – Only yield files matching <cite>regex</cite>.</p></li>
<li><p><strong>fname</strong> (<em>str</em>) – Only yield files matching <cite>fname</cite></p></li>
<li><p><strong>recurse</strong> (<em>bool</em>) – Whether to search recursively down from the root directory</p></li>
<li><p><strong>dir_sorter</strong> – Function that takes a list and returns a sorted version of it, for
purposes of sorting directories</p></li>
<li><p><strong>file_sorter</strong> – Function as specified for <cite>dir_sorter</cite> but used for sorting file names</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>fullfilepath</strong> (<em>str</em>)</p></li>
<li><p><strong>basename</strong> (<em>str</em>)</p></li>
<li><p><strong>match</strong> (<em>re.SRE_Match or None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.from_cfg">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">from_cfg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#from_cfg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.from_cfg" title="Link to this definition"></a></dt>
<dd><p>Load a PISA config file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.from_file">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.from_file" title="Link to this definition"></a></dt>
<dd><p>Dispatch correct file reader based on <cite>fmt</cite> (if specified) or guess
based on file name’s extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>string</em>) – File path / name from which to load data.</p></li>
<li><p><strong>fmt</strong> (<em>None</em><em> or </em><em>string</em>) – If string, for interpretation of the file according to this format. If
None, file format is deduced by an extension found in <cite>fname</cite>.</p></li>
<li><p><strong>**kwargs</strong> – All other arguments are passed to the function dispatched to read the
file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Object instantiated from the file (string, dictionary, …). Each format</em></p></li>
<li><p><em>is interpreted differently.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If extension is not recognized</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.from_pickle">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">from_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#from_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.from_pickle" title="Link to this definition"></a></dt>
<dd><p>Load from a Python pickle file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.fsort">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">fsort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#fsort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.fsort" title="Link to this definition"></a></dt>
<dd><p>Sort a sequence of strings with one or more floating point number fields
in using the floating point value(s) (and intervening strings are treated
as normally done). Note that + and - preceding a number are included in the
floating point value unless <cite>signed=False</cite>.</p>
<p>Code adapted from nedbatchelder.com/blog/200712/human_sorting.html#comments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>sequence</em><em> of </em><em>strings</em>) – Sequence of strings to be sorted.</p></li>
<li><p><strong>signed</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to include a “+” or “-” preceeding a number in its value to be
sorted. One might specify False if “-” is used exclusively as a
separator in the string.</p></li>
<li><p><strong>reverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to reverse the sort order (True =&gt; descending order)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sorted_l</strong> – Sorted strings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of strings</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a-0.1.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;a-0.01.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;a-0.05.txt&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fsort</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[&#39;a-0.1.txt&#39;, &#39;a-0.05.txt&#39;, &#39;a-0.01.txt&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fsort</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[&#39;a-0.01.txt&#39;, &#39;a-0.05.txt&#39;, &#39;a-0.1.txt&#39;]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pisa.utils.fileio.nsort" title="pisa.utils.fileio.nsort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nsort</span></code></a></dt><dd><p>Sort using integer-only values of numbers; good for e.g. version numbers, where periods are separators rather than decimal points.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.get_valid_filename">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">get_valid_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#get_valid_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.get_valid_filename" title="Link to this definition"></a></dt>
<dd><p>Sanitize string to make it reasonable to use as a filename.</p>
<p>From <a class="reference external" href="https://github.com/django/django/blob/master/django/utils/text.py">https://github.com/django/django/blob/master/django/utils/text.py</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<em>string</em>)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">get_valid_filename</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;A,bCd $%#^#*!()&quot;&#39;</span> <span class="o">.</span><span class="n">ext</span> <span class="s1">&#39;))</span>
<span class="go">&#39;a_bcd__.ext&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.mkdir">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">mkdir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">488</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#mkdir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.mkdir" title="Link to this definition"></a></dt>
<dd><p>Simple wrapper around os.makedirs to create a directory but not raise an
exception if the dir already exists</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>string</em>) – Directory path</p></li>
<li><p><strong>mode</strong> (<em>integer</em>) – Permissions on created directory; see os.makedirs for details.</p></li>
<li><p><strong>warn</strong> (<em>bool</em>) – Whether to warn if directory already exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.nsort">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">nsort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#nsort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.nsort" title="Link to this definition"></a></dt>
<dd><p>Sort a sequence of strings containing integer number fields by the
value of those numbers, rather than by simple alpha order. Useful
for sorting e.g. version strings, etc..</p>
<p>Code adapted from nedbatchelder.com/blog/200712/human_sorting.html#comments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>sequence</em><em> of </em><em>strings</em>) – Sequence of strings to be sorted.</p></li>
<li><p><strong>reverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to reverse the sort order (True =&gt; descending order)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sorted_l</strong> – Sorted strings</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of strings</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;f1.10.0.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;f1.01.2.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;f1.1.1.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;f9.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;f10.txt&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsort</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="go">[&#39;f1.1.1.txt&#39;, &#39;f1.01.2.txt&#39;, &#39;f1.10.0.txt&#39;, &#39;f9.txt&#39;, &#39;f10.txt&#39;]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pisa.utils.fileio.fsort" title="pisa.utils.fileio.fsort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fsort</span></code></a></dt><dd><p>Sort sequence of strings with floating-point numbers in the strings.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.nsort_key_func">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">nsort_key_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#nsort_key_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.nsort_key_func" title="Link to this definition"></a></dt>
<dd><p>Use as the <cite>key</cite> argument to the <cite>sorted</cite> function or <cite>sort</cite> method.</p>
<p>Code adapted from nedbatchelder.com/blog/200712/human_sorting.html#comments</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;f1.10.0.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;f1.01.2.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;f1.1.1.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;f9.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;f10.txt&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">nsort_key_func</span><span class="p">)</span>
<span class="go">[&#39;f1.1.1.txt&#39;, &#39;f1.01.2.txt&#39;, &#39;f1.10.0.txt&#39;, &#39;f9.txt&#39;, &#39;f10.txt&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.to_file">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.to_file" title="Link to this definition"></a></dt>
<dd><p>Dispatch correct file writer based on fmt (if specified) or guess
based on file name’s extension</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.fileio.to_pickle">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.fileio.</span></span><span class="sig-name descname"><span class="pre">to_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fileio.html#to_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fileio.to_pickle" title="Link to this definition"></a></dt>
<dd><p>Save object to a pickle file</p>
</dd></dl>

</section>
<section id="module-pisa.utils.fisher_matrix">
<span id="pisa-utils-fisher-matrix-module"></span><h2>pisa.utils.fisher_matrix module<a class="headerlink" href="#module-pisa.utils.fisher_matrix" title="Link to this heading"></a></h2>
<p>A Fisher matrix class definition.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.fisher_matrix.</span></span><span class="sig-name descname"><span class="pre">FisherMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_fits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.addPrior">
<span class="sig-name descname"><span class="pre">addPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.addPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.addPrior" title="Link to this definition"></a></dt>
<dd><p>Add a prior of value sigma to the existing one for par (in quadrature)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.calculateCovariance">
<span class="sig-name descname"><span class="pre">calculateCovariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.calculateCovariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.calculateCovariance" title="Link to this definition"></a></dt>
<dd><p>Calculate covariance matrix from Fisher matrix (i.e. invert including priors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.checkConsistency">
<span class="sig-name descname"><span class="pre">checkConsistency</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.checkConsistency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.checkConsistency" title="Link to this definition"></a></dt>
<dd><p>Check whether number of parameters matches dimension of matrix;
matrix is symmetrical; parameter names are unique; and number of
best_fits, labels, and priors all match number of parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.fromFile">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fromFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.fromFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.fromFile" title="Link to this definition"></a></dt>
<dd><p>Load a Fisher matrix from a json file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.fromPaPAFile">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fromPaPAFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.fromPaPAFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.fromPaPAFile" title="Link to this definition"></a></dt>
<dd><p>Load Fisher matrix from json file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getBestFit">
<span class="sig-name descname"><span class="pre">getBestFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getBestFit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getBestFit" title="Link to this definition"></a></dt>
<dd><p>Get best fit value for given parameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getCorrelation">
<span class="sig-name descname"><span class="pre">getCorrelation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getCorrelation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getCorrelation" title="Link to this definition"></a></dt>
<dd><p>Returns correlation coefficient between par1 and par2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getCovariance">
<span class="sig-name descname"><span class="pre">getCovariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getCovariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getCovariance" title="Link to this definition"></a></dt>
<dd><p>Returns the covariance of par1 and par2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getErrorEllipse">
<span class="sig-name descname"><span class="pre">getErrorEllipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confLevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6827</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getErrorEllipse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getErrorEllipse" title="Link to this definition"></a></dt>
<dd><p>Returns a, b, tan(2 theta) of confLevel error ellipse
in par1-par2-plane with:</p>
<p>a: large half axis
b: small half axis
tan(2 theta): tilt angle, has to be divided by the aspect</p>
<blockquote>
<div><p>ratio of the actual plot before taking arctan</p>
</div></blockquote>
<p>Formulae taken from arXiv:0906.4123</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getLabel">
<span class="sig-name descname"><span class="pre">getLabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getLabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getLabel" title="Link to this definition"></a></dt>
<dd><p>Get pretty-print label for given parameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getParameterIndex">
<span class="sig-name descname"><span class="pre">getParameterIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getParameterIndex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getParameterIndex" title="Link to this definition"></a></dt>
<dd><p>Whether par is already existing in parameter list</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getPrior">
<span class="sig-name descname"><span class="pre">getPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getPrior" title="Link to this definition"></a></dt>
<dd><p>List the prior (sigma value) for par</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getPriorDict">
<span class="sig-name descname"><span class="pre">getPriorDict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getPriorDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getPriorDict" title="Link to this definition"></a></dt>
<dd><p>List priors of all parameters (sigma values)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getSigma">
<span class="sig-name descname"><span class="pre">getSigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getSigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getSigma" title="Link to this definition"></a></dt>
<dd><p>Returns full standard deviation of par,
marginalized over all other parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getSigmaNoPriors">
<span class="sig-name descname"><span class="pre">getSigmaNoPriors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getSigmaNoPriors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getSigmaNoPriors" title="Link to this definition"></a></dt>
<dd><p>Returns standard deviation of par, marginalized over all other
parameters, but ignoring priors on this parameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getSigmaStatistical">
<span class="sig-name descname"><span class="pre">getSigmaStatistical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getSigmaStatistical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getSigmaStatistical" title="Link to this definition"></a></dt>
<dd><p>Returns standard deviation of par,
if all other parameters are fixed (i.e. known infinitely well)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getSigmaSystematic">
<span class="sig-name descname"><span class="pre">getSigmaSystematic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getSigmaSystematic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getSigmaSystematic" title="Link to this definition"></a></dt>
<dd><p>Returns standard deviation of par for infinite statistics
(i.e. systematic error)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.getVariance">
<span class="sig-name descname"><span class="pre">getVariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.getVariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.getVariance" title="Link to this definition"></a></dt>
<dd><p>Returns full variance of par</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.printResults">
<span class="sig-name descname"><span class="pre">printResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.printResults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.printResults" title="Link to this definition"></a></dt>
<dd><p>Prints statistical, systematic errors, priors, best fits
for specified (default: all) parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.printResultsSorted">
<span class="sig-name descname"><span class="pre">printResultsSorted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.printResultsSorted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.printResultsSorted" title="Link to this definition"></a></dt>
<dd><p>Prints statistical, systematic errors, priors, best fits
sorted by parameter par</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.removeAllPriors">
<span class="sig-name descname"><span class="pre">removeAllPriors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.removeAllPriors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.removeAllPriors" title="Link to this definition"></a></dt>
<dd><p>Remove <em>all</em> priors from this Fisher Matrix</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.removeParameter">
<span class="sig-name descname"><span class="pre">removeParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.removeParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.removeParameter" title="Link to this definition"></a></dt>
<dd><p>Remove par from Fisher matrix and recalculate covariance</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.renameParameter">
<span class="sig-name descname"><span class="pre">renameParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fromname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.renameParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.renameParameter" title="Link to this definition"></a></dt>
<dd><p>Rename a parameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.saveFile">
<span class="sig-name descname"><span class="pre">saveFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.saveFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.saveFile" title="Link to this definition"></a></dt>
<dd><p>Write Fisher matrix to json file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.setLabel">
<span class="sig-name descname"><span class="pre">setLabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newlabel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.setLabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.setLabel" title="Link to this definition"></a></dt>
<dd><p>Change the pretty-print label for given parameter</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.setPrior">
<span class="sig-name descname"><span class="pre">setPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.setPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.setPrior" title="Link to this definition"></a></dt>
<dd><p>Set prior for parameter ‘par’ to value sigma. If sigma is None, no
prior is assumed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.sortByParam">
<span class="sig-name descname"><span class="pre">sortByParam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.sortByParam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.sortByParam" title="Link to this definition"></a></dt>
<dd><p>Sorts the parameters by their impact on parameter par.
Relevant quantity is covariance(par,i)/sigma_i.</p>
<p>Returns sorted list of (parameters, impact), par first,
then ordered descendingly by impact.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.fisher_matrix.FisherMatrix.translatePrior">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">translatePrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/fisher_matrix.html#FisherMatrix.translatePrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.fisher_matrix.FisherMatrix.translatePrior" title="Link to this definition"></a></dt>
<dd><p>Translates a Prior object, numeric, or None to the simplistic prior
format used internally (a value for sigma).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prior</strong> (<em>Prior object</em><em> (</em><em>gaussian</em><em> or </em><em>uniform</em><em>)</em><em>, </em><em>float</em><em>, or </em><em>None</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sigma</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Standard deviation of prior (np.inf for uniform Prior or None)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pisa.utils.flavInt">
<span id="pisa-utils-flavint-module"></span><h2>pisa.utils.flavInt module<a class="headerlink" href="#module-pisa.utils.flavInt" title="Link to this heading"></a></h2>
<p>Classes for working with neutrino flavors (NuFlav), interactions types
(IntType), “flavints” (a flavor and an interaction type) (NuFlavInt), and
flavint groups (NuFlavIntGroup) in a consistent and convenient manner.</p>
<p>FlavIntData class for working with data stored by flavint (flavor &amp;
interaction type). This should replace the PISA convention of using raw
doubly-nested dictionaries indexed as [&lt;flavor&gt;][&lt;interaction type&gt;]. For
now, FlavIntData objects can be drop-in replacements for such dictionaries
(they can be accessed and written to in the same way since FlavIntData
subclasses dict) but this should be deprecated; eventually, all direct access
of the data structure should be eliminated and disallowed by the FlavIntData
object.</p>
<p>Define convenience tuples ALL_{x} for easy iteration</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.flavInt.BarSep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">BarSep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#BarSep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.BarSep" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Context manager to make global __BAR_SSEP__ modification slightly less
error-prone.</p>
<p>__BAR_SSEP__ defines the separator between a flavor and the string “bar”
(to define the flavor as the antiparticle version; e.g. nuebar). Some
datastructures in PISA 2 used ‘_’ between the two (“nue_bar”) while others
did not use this. To make dealing with this (slightly) less painful, this
context manager was introduced to switch between the PISA 3 default (no
‘_’) and the sometimes-use ‘_’ separator. See Examples for usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>string</em>) – Separator to use between flavor (“nue”, “numu”, “nutau”) and “bar”.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nuebar</span> <span class="o">=</span> <span class="n">NuFlav</span><span class="p">(</span><span class="s1">&#39;nuebar&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nuebar</span><span class="p">))</span>
<span class="go">nuebar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">BarSep</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">nuebar</span><span class="p">)</span>
<span class="go">nue_bar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nuebar</span><span class="p">))</span>
<span class="go">nuebar</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">FlavIntData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntData" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Container class for storing data for each NuFlavInt.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>string</em><em>, </em><em>dict</em><em>, or </em><em>None</em>) – <p>Data with which to populate the hierarchy.</p>
<p>If string, interpret as PISA resource and load data from it
If dict, populate data from the dictionary
If None, instantiate with None for all data</p>
<p>The interpreted version of <cite>val</cite> must be a valid data structure: A
dict with keys ‘nue’, ‘numu’, ‘nutau’, ‘nue_bar’, ‘numu_bar’, and
‘nutau_bar’; and each item corresponding to these keys must itself be a
dict with keys ‘cc’ and ‘nc’.</p>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Accessing data (both for getting and setting) is fairly flexible. It uses
dict-like square-brackets syntax, but can accept any object (or two
objects) that are convertible to a NuFlav or NuFlavInt object. In the
former case, the entire flavor dictionary (which includes both ‘cc’ and
‘nc’) is returned, while in the latter case whatever lives at the node is
returned.</p>
<p>Initializing, setting and getting data in various ways:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span> <span class="o">=</span> <span class="n">FlavIntData</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="s1">&#39;nue&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="s1">&#39;nuenc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="s1">&#39;numu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cc&#39;</span><span class="p">:</span> <span class="s1">&#39;cc data...&#39;</span><span class="p">,</span> <span class="s1">&#39;nc&#39;</span><span class="p">:</span> <span class="s1">&#39;nc data...&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="n">NuFlav</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">IntType</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="s1">&#39;nuecc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="s1">&#39;NUE_NC&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="s1">&#39;nu_e&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;cc&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nc&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="s1">&#39;nu mu cc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cc data...&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="s1">&#39;nu mu&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;cc&#39;</span><span class="p">:</span> <span class="s1">&#39;cc data...&#39;</span><span class="p">,</span> <span class="s1">&#39;nc&#39;</span><span class="p">:</span> <span class="s1">&#39;nc data...&#39;</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_dat</span><span class="p">[</span><span class="s1">&#39;nutau cc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntData.allclose">
<span class="sig-name descname"><span class="pre">allclose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntData.allclose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntData.allclose" title="Link to this definition"></a></dt>
<dd><p>Returns True if all data structures are equal and all numerical
values contained are within relative (rtol) and/or absolute (atol)
tolerance of one another.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntData.flavints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flavints</span></span><a class="headerlink" href="#pisa.utils.flavInt.FlavIntData.flavints" title="Link to this definition"></a></dt>
<dd><p>all flavints present</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of <a class="reference internal" href="#pisa.utils.flavInt.NuFlavInt" title="pisa.utils.flavInt.NuFlavInt">NuFlavInt</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntData.flavs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flavs</span></span><a class="headerlink" href="#pisa.utils.flavInt.FlavIntData.flavs" title="Link to this definition"></a></dt>
<dd><p>all flavors present</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of <a class="reference internal" href="#pisa.utils.flavInt.NuFlav" title="pisa.utils.flavInt.NuFlav">NuFlav</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntData.id_dupes">
<span class="sig-name descname"><span class="pre">id_dupes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntData.id_dupes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntData.id_dupes" title="Link to this definition"></a></dt>
<dd><p>Identify flavints with duplicated data (exactly or within a
specified tolerance), convert these NuFlavInt’s into NuFlavIntGroup’s
and returning these along with the data associated with each.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rtol</strong> – Set to positive value to use as rtol argument for numpy allclose</p></li>
<li><p><strong>atol</strong> – Set to positive value to use as atol argument for numpy allclose</p></li>
<li><p><strong>0</strong> (<em>If either rtol</em><em> or </em><em>atol is</em>)</p></li>
<li><p><strong>enforced.</strong> (<em>exact equality is</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dupe_flavintgroups</strong> (<em>list of NuFlavIntGroup</em>) – A NuFlavIntGroup object is returned for each group of NuFlavInt’s
found with duplicate data</p></li>
<li><p><strong>dupe_flavintgroups_data</strong> (<em>list of objects</em>) – Data associated with each NuFlavIntGroup in dupe_flavintgroups.
Each object in <cite>dupe_flavintgroups_data</cite> corresponds to, and in the
same order as, the objects in <cite>dupe_flavintgroups</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntData.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntData.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntData.save" title="Link to this definition"></a></dt>
<dd><p>Save data structure to a file; see fileio.to_file for details</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntData.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fi_container</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntData.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntData.validate" title="Link to this definition"></a></dt>
<dd><p>Perform basic validation on the data structure</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntDataGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">FlavIntDataGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flavint_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntDataGroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntDataGroup" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Container class for storing data for some set(s) of NuFlavIntGroups
(cf. FlavIntData, which stores one datum for each NuFlavInt separately)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<em>None</em><em>, </em><em>str</em><em>, or </em><em>dict</em>) – Data with which to populate the hierarchy</p></li>
<li><p><strong>flavint_groups</strong> (<em>None</em><em>, </em><em>str</em><em>, or </em><em>iterable</em>) – <p>User-defined groupings of NuFlavIntGroups. These can be specified
in several ways.</p>
<dl class="simple">
<dt>None</dt><dd><p>If val == None, flavint_groups must be specified
If val != None, flavitn_groups are deduced from the data</p>
</dd>
<dt>string</dt><dd><p>If val is a string, it is expected to be a comma-separated
list, each field of which describes a NuFlavIntGroup. The
returned list of groups encompasses all possible flavor/int
types, but the groups are mutually exclusive.</p>
</dd>
<dt>iterable of strings or NuFlavIntGroup</dt><dd><p>If val is an iterable, each member of the iterable is
interpreted as a NuFlavIntGroup.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntDataGroup.allclose">
<span class="sig-name descname"><span class="pre">allclose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntDataGroup.allclose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntDataGroup.allclose" title="Link to this definition"></a></dt>
<dd><p>Returns True if all data structures are equal and all numerical
values contained are within relative (rtol) and/or absolute (atol)
tolerance of one another.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntDataGroup.flavint_groups">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flavint_groups</span></span><a class="headerlink" href="#pisa.utils.flavInt.FlavIntDataGroup.flavint_groups" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntDataGroup.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntDataGroup.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntDataGroup.save" title="Link to this definition"></a></dt>
<dd><p>Save data structure to a file; see fileio.to_file for details</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntDataGroup.transform_groups">
<span class="sig-name descname"><span class="pre">transform_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flavint_groups</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntDataGroup.transform_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntDataGroup.transform_groups" title="Link to this definition"></a></dt>
<dd><p>Transform FlavIntDataGroup into a structure given by the input
flavint_groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flavint_groups</strong> (<em>string</em><em>, or </em><em>sequence</em><em> of </em><em>strings</em><em> or </em><em>sequence of</em>) – NuFlavIntGroups</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>transformed_fidg</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pisa.utils.flavInt.FlavIntDataGroup" title="pisa.utils.flavInt.FlavIntDataGroup">FlavIntDataGroup</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.FlavIntDataGroup.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fi_container</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#FlavIntDataGroup.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.FlavIntDataGroup.validate" title="Link to this definition"></a></dt>
<dd><p>Perform basic validation on the data structure</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.flavInt.IntType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">IntType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#IntType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.IntType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<blockquote>
<div><p>Interaction type object.</p>
<dl class="simple">
<dt>val</dt><dd><p>See Notes.</p>
</dd>
</dl>
<dl class="simple">
<dt>Instantiate via a <cite>val</cite> of:</dt><dd><ul class="simple">
<li><p>Numerical code: 1=CC, 2=NC</p></li>
<li><p>String (case-insensitive; all characters besides valid tokens are
ignored)</p></li>
<li><p>Instantiated IntType object (or any method implementing int_type.code
which returns a valid interaction type code)</p></li>
<li><p>Instantiated NuFlavInt object (or any object implementing int_type
which returns a valid IntType object)</p></li>
</ul>
</dd>
</dl>
<p>The following, e.g., are all interpreted as charged-current IntTypes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">IntType</span><span class="p">(</span><span class="s1">&#39;cc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IntType</span><span class="p">(</span><span class="s1">&#39;</span>
<span class="go">     _cc</span>
</pre></div>
</div>
</div></blockquote>
<dl>
<dt>‘)</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">IntType</span><span class="p">(</span><span class="s1">&#39;numubarcc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IntType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IntType</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IntType</span><span class="p">(</span><span class="n">IntType</span><span class="p">(</span><span class="s1">&#39;cc&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IntType</span><span class="p">(</span><span class="n">NuFlavInt</span><span class="p">(</span><span class="s1">&#39;numubarcc&#39;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.IntType.CC_CODE">
<span class="sig-name descname"><span class="pre">CC_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#pisa.utils.flavInt.IntType.CC_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.IntType.IGNORE">
<span class="sig-name descname"><span class="pre">IGNORE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('[^a-zA-Z]')</span></em><a class="headerlink" href="#pisa.utils.flavInt.IntType.IGNORE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.IntType.IT_RE">
<span class="sig-name descname"><span class="pre">IT_RE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('^(cc|nc)$')</span></em><a class="headerlink" href="#pisa.utils.flavInt.IntType.IT_RE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.IntType.NC_CODE">
<span class="sig-name descname"><span class="pre">NC_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#pisa.utils.flavInt.IntType.NC_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.IntType.cc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cc</span></span><a class="headerlink" href="#pisa.utils.flavInt.IntType.cc" title="Link to this definition"></a></dt>
<dd><p>Is this interaction type charged current (CC)?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.IntType.code">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">code</span></span><a class="headerlink" href="#pisa.utils.flavInt.IntType.code" title="Link to this definition"></a></dt>
<dd><p>Integer code for this interaction type</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.IntType.nc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nc</span></span><a class="headerlink" href="#pisa.utils.flavInt.IntType.nc" title="Link to this definition"></a></dt>
<dd><p>Is this interaction type neutral current (NC)?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.IntType.tex">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tex</span></span><a class="headerlink" href="#pisa.utils.flavInt.IntType.tex" title="Link to this definition"></a></dt>
<dd><p>TeX representation of this interaction type</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">NuFlav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlav"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlav" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for handling neutrino flavors (and anti-flavors)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.ANTIPART_CODE">
<span class="sig-name descname"><span class="pre">ANTIPART_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.ANTIPART_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.FLAV_RE">
<span class="sig-name descname"><span class="pre">FLAV_RE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('^(?P&lt;fullflav&gt;(?:nue|numu|nutau)(?P&lt;barnobar&gt;bar){0,1})$')</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.FLAV_RE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.IGNORE">
<span class="sig-name descname"><span class="pre">IGNORE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('[^a-zA-Z]')</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.IGNORE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.NUEBAR_CODE">
<span class="sig-name descname"><span class="pre">NUEBAR_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-12</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.NUEBAR_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.NUE_CODE">
<span class="sig-name descname"><span class="pre">NUE_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">12</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.NUE_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.NUMUBAR_CODE">
<span class="sig-name descname"><span class="pre">NUMUBAR_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-14</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.NUMUBAR_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.NUMU_CODE">
<span class="sig-name descname"><span class="pre">NUMU_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">14</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.NUMU_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.NUTAUBAR_CODE">
<span class="sig-name descname"><span class="pre">NUTAUBAR_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-16</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.NUTAUBAR_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.NUTAU_CODE">
<span class="sig-name descname"><span class="pre">NUTAU_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.NUTAU_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.PART_CODE">
<span class="sig-name descname"><span class="pre">PART_CODE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.PART_CODE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.antiparticle">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">antiparticle</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.antiparticle" title="Link to this definition"></a></dt>
<dd><p>Is this an antiparticle flavor?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.bar_code">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bar_code</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.bar_code" title="Link to this definition"></a></dt>
<dd><p>Return +/-1 for particle/antiparticle</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.code">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">code</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.code" title="Link to this definition"></a></dt>
<dd><p>PDG code</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.particle">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">particle</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.particle" title="Link to this definition"></a></dt>
<dd><p>Is this a particle (vs. antiparticle) flavor?</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.pidx">
<span class="sig-name descname"><span class="pre">pidx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlav.pidx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.pidx" title="Link to this definition"></a></dt>
<dd><p>Extract data from a nested dictionary <cite>d</cite> whose format is commonly
found in PISA</p>
<dl>
<dt>The dictionary must have the format</dt><dd><p>d = {“&lt;flavor&gt;”: &lt;data object&gt;}
&lt;flavor&gt; is one of “nue”, “nue_bar”, “numu”, “numu_bar”, “nutau”,</p>
<blockquote>
<div><p>“nutau_bar”</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.prob3_codes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prob3_codes</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.prob3_codes" title="Link to this definition"></a></dt>
<dd><p>flavor and particle/antiparticle codes, as used by prob3</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(int,int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlav.tex">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tex</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlav.tex" title="Link to this definition"></a></dt>
<dd><p>TeX string</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">NuFlavInt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A neutrino “flavint” encompasses both the neutrino flavor and its
interaction type.</p>
<dl class="simple">
<dt>Instantiate via</dt><dd><ul class="simple">
<li><p>String containing a single flavor and a single interaction type
e.g.: ‘numucc’, ‘nu_mu_cc’, ‘nu mu CC’, ‘numu_bar CC’, etc.</p></li>
<li><p>Another instantiated NuFlavInt object</p></li>
<li><p>Two separate objects that can be converted to a valid NuFlav
and a valid IntType (in that order)</p></li>
<li><p>An iterable of length two which contains such objects</p></li>
<li><p>kwargs <cite>flav</cite> and <cite>int_type</cite> specifying such objects</p></li>
</ul>
</dd>
</dl>
<p>String specifications simply ignore all characters not recognized as a
valid token.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.FINT_RE">
<span class="sig-name descname"><span class="pre">FINT_RE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('(?P&lt;fullflav&gt;(?:nue|numu|nutau)(?P&lt;barnobar&gt;bar){0,1})(?P&lt;int_type&gt;cc|nc){0,1}')</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.FINT_RE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.FINT_SSEP">
<span class="sig-name descname"><span class="pre">FINT_SSEP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'_'</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.FINT_SSEP" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.FINT_TEXSEP">
<span class="sig-name descname"><span class="pre">FINT_TEXSEP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'</span> <span class="pre">\\,</span> <span class="pre">'</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.FINT_TEXSEP" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.TOKENS">
<span class="sig-name descname"><span class="pre">TOKENS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('(nu|e|mu|tau|bar|nc|cc)')</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.TOKENS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.antiparticle">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">antiparticle</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.antiparticle" title="Link to this definition"></a></dt>
<dd><p>Is this an antiparticle flavor?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.cc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cc</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.cc" title="Link to this definition"></a></dt>
<dd><p>Is this interaction type charged current (CC)?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.flav">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flav</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.flav" title="Link to this definition"></a></dt>
<dd><p>Return just the NuFlav part of this NuFlavInt</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.int_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">int_type</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.int_type" title="Link to this definition"></a></dt>
<dd><p>Return IntType object that composes this NuFlavInt</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.nc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nc</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.nc" title="Link to this definition"></a></dt>
<dd><p>Is this interaction type neutral current (NC)?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.particle">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">particle</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.particle" title="Link to this definition"></a></dt>
<dd><p>Is this a particle (vs. antiparticle) flavor?</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.pidx">
<span class="sig-name descname"><span class="pre">pidx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavInt.pidx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.pidx" title="Link to this definition"></a></dt>
<dd><p>Extract data from a nested dictionary <cite>d</cite> whose format is commonly
found in PISA</p>
<p>The dictionary must have the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;&lt;flavor&gt;&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;&lt;interaction type&gt;&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">data</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">}}</span>
<span class="o">&lt;</span><span class="n">flavor</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">one</span> <span class="n">of</span> <span class="s2">&quot;nue&quot;</span><span class="p">,</span> <span class="s2">&quot;nue_bar&quot;</span><span class="p">,</span> <span class="s2">&quot;numu&quot;</span><span class="p">,</span> <span class="s2">&quot;numu_bar&quot;</span><span class="p">,</span> <span class="s2">&quot;nutau&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nutau_bar&quot;</span>
<span class="o">&lt;</span><span class="n">interaction</span> <span class="nb">type</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">one</span> <span class="n">of</span> <span class="s2">&quot;cc&quot;</span><span class="p">,</span> <span class="s2">&quot;nc&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavInt.tex">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tex</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavInt.tex" title="Link to this definition"></a></dt>
<dd><p>TeX string representation of this NuFlavInt</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">NuFlavIntGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavIntGroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MutableSequence</span></code></p>
<p>Grouping of neutrino flavors+interaction types (flavints)</p>
<dl>
<dt>Grouping of neutrino flavints. Specification can be via</dt><dd><ul>
<li><p>A single <cite>NuFlav</cite> object; this gets promoted to include both
interaction types</p></li>
<li><p>A single <cite>NuFlavInt</cite> object</p></li>
<li><p>String:
* Ignores anything besides valid tokens
* A flavor with no interaction type specified will include both CC</p>
<blockquote>
<div><p>and NC interaction types</p>
</div></blockquote>
<ul class="simple">
<li><p>Multiple flavor/interaction-type specifications can be made;
use of delimiters is optional</p></li>
<li><p>Interprets “nuall” as nue+numu+nutau and “nuallbar” as
nuebar+numubar+nutaubar</p></li>
</ul>
</li>
<li><p>Iterable containing any of the above (i.e., objects convertible to
<cite>NuFlavInt</cite> objects). Note that a valid iterable is another
<cite>NuFlavIntGroup</cite> object.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.FLAVINT_RE">
<span class="sig-name descname"><span class="pre">FLAVINT_RE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('((?:nue|numu|nutau|nuall)(?:bar){0,1}(?:cc|nc){0,2})')</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.FLAVINT_RE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.FLAV_RE">
<span class="sig-name descname"><span class="pre">FLAV_RE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('(?P&lt;fullflav&gt;(?:nue|numu|nutau|nuall)(?:bar){0,1})')</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.FLAV_RE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.IGNORE">
<span class="sig-name descname"><span class="pre">IGNORE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('[^a-zA-Z]')</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.IGNORE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.IT_RE">
<span class="sig-name descname"><span class="pre">IT_RE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('(cc|nc)')</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.IT_RE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.TOKENS">
<span class="sig-name descname"><span class="pre">TOKENS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('(nu|e|mu|tau|all|bar|nc|cc)')</span></em><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.TOKENS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.antiparticles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">antiparticles</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.antiparticles" title="Link to this definition"></a></dt>
<dd><p>Return tuple of unique antiparticle NuFlavInts that make up this
group</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.cc_flavints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cc_flavints</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.cc_flavints" title="Link to this definition"></a></dt>
<dd><p>Return tuple of unique charged-current-interaction NuFlavInts that
make up this group</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.cc_flavs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cc_flavs</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.cc_flavs" title="Link to this definition"></a></dt>
<dd><p>Return tuple of unique charged-current-interaction flavors that
make up this group. Note that only the flavors, and not NuFlavInts, are
returned (cf. method <cite>cc_flavints</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.file_str">
<span class="sig-name descname"><span class="pre">file_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flavsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flavintsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'__'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavIntGroup.file_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.file_str" title="Link to this definition"></a></dt>
<dd><p>String representation for this group useful for file names</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.flavints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flavints</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.flavints" title="Link to this definition"></a></dt>
<dd><p>Return tuple of all NuFlavInts that make up this group</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.flavs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flavs</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.flavs" title="Link to this definition"></a></dt>
<dd><p>Return tuple of unique flavors that make up this group</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.group_flavs_by_int_type">
<span class="sig-name descname"><span class="pre">group_flavs_by_int_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavIntGroup.group_flavs_by_int_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.group_flavs_by_int_type" title="Link to this definition"></a></dt>
<dd><p>Return a dictionary with flavors grouped by the interaction types
represented in this group.</p>
<p>The returned dictionary has format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;all_int_type_flavs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">NuFlav</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">NuFlav</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="s1">&#39;cc_only_flavs&#39;</span><span class="p">:</span>      <span class="p">[</span><span class="o">&lt;</span><span class="n">NuFlav</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">NuFlav</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="s1">&#39;nc_only_flavs&#39;</span><span class="p">:</span>      <span class="p">[</span><span class="o">&lt;</span><span class="n">NuFlav</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">NuFlav</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>where the lists of NuFlav objects are mutually exclusive</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavIntGroup.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.insert" title="Link to this definition"></a></dt>
<dd><p>Insert flavint <cite>value</cite> before <cite>index</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.interpret">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interpret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavIntGroup.interpret"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.interpret" title="Link to this definition"></a></dt>
<dd><p>Interpret a NuFlavIntGroup arg</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.nc_flavints">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nc_flavints</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.nc_flavints" title="Link to this definition"></a></dt>
<dd><p>Return tuple of unique neutral-current-interaction NuFlavInts that
make up this group</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.nc_flavs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nc_flavs</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.nc_flavs" title="Link to this definition"></a></dt>
<dd><p>Return tuple of unique neutral-current-interaction flavors that
make up this group. Note that only the flavors, and not NuFlavInts, are
returned (cf. method <cite>nc_flavints</cite></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.particles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">particles</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.particles" title="Link to this definition"></a></dt>
<dd><p>Return tuple of unique particle (vs antiparticle) NuFlavInts that
make up this group</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavIntGroup.remove"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.remove" title="Link to this definition"></a></dt>
<dd><p>Remove a flavint from this group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (anything accepted by <cite>interpret</cite> method)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.simple_str">
<span class="sig-name descname"><span class="pre">simple_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flavsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'+'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flavintsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">',</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'+'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavIntGroup.simple_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.simple_str" title="Link to this definition"></a></dt>
<dd><p>Simple string representation of this group</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.simple_tex">
<span class="sig-name descname"><span class="pre">simple_tex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flavsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">+</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">\\,</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flavintsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">';</span> <span class="pre">\\;</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'+'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#NuFlavIntGroup.simple_tex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.simple_tex" title="Link to this definition"></a></dt>
<dd><p>Simplified TeX string reperesentation of this group</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.tex">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tex</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.tex" title="Link to this definition"></a></dt>
<dd><p>TeX string representation for this group</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.flavInt.NuFlavIntGroup.unique_flavs_tex">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unique_flavs_tex</span></span><a class="headerlink" href="#pisa.utils.flavInt.NuFlavIntGroup.unique_flavs_tex" title="Link to this definition"></a></dt>
<dd><p>TeX string representation of the unique flavors present in this
group</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flavInt.flavintGroupsFromString">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">flavintGroupsFromString</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groups</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#flavintGroupsFromString"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.flavintGroupsFromString" title="Link to this definition"></a></dt>
<dd><p>Interpret <cite>groups</cite> to break into neutrino flavor/interaction type(s)
that are to be grouped together; also form singleton groups as specified
explicitly in <cite>groups</cite> or for any unspecified flavor/interaction type(s).</p>
<p>The returned list of groups encompasses all possible flavor/int types, but
the groups are mutually exclusive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>groups</strong> (<em>None</em><em>, </em><em>string</em><em>, or </em><em>sequence</em><em> of </em><em>strings</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>flavint_groups</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of <a class="reference internal" href="#pisa.utils.flavInt.NuFlavIntGroup" title="pisa.utils.flavInt.NuFlavIntGroup">NuFlavIntGroup</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flavInt.get_bar_ssep">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">get_bar_ssep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#get_bar_ssep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.get_bar_ssep" title="Link to this definition"></a></dt>
<dd><p>Get the separator that is set to be used between “base” flavor (“nue”,
“numu”, or “nutau”) and “bar” when converting antineutrino <a href="#id6"><span class="problematic" id="id7">`</span></a>NuFlav`s or
<a href="#id8"><span class="problematic" id="id9">`</span></a>NuFlavInt`s to strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sep</strong> – Separator</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flavInt.set_bar_ssep">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">set_bar_ssep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#set_bar_ssep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.set_bar_ssep" title="Link to this definition"></a></dt>
<dd><p>Set the separator between “base” flavor (“nue”, “numu”, or “nutau”) and
“bar” when converting antineutrino <a href="#id10"><span class="problematic" id="id11">`</span></a>NuFlav`s or <a href="#id12"><span class="problematic" id="id13">`</span></a>NuFlavInt`s to strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<em>string</em>) – Separator</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flavInt.xlateGroupsStr">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flavInt.</span></span><span class="sig-name descname"><span class="pre">xlateGroupsStr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flavInt.html#xlateGroupsStr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flavInt.xlateGroupsStr" title="Link to this definition"></a></dt>
<dd><p>Translate a “,”-separated string into separate <a href="#id14"><span class="problematic" id="id15">`</span></a>NuFlavIntGroup`s.</p>
<dl>
<dt>val</dt><dd><dl class="simple">
<dt>“,”-delimited list of valid NuFlavIntGroup strings, e.g.:</dt><dd><p>“nuall_nc,nue,numu_cc+numubar_cc”</p>
</dd>
</dl>
<p>Note that specifying NO interaction type results in both interaction
types being selected, e.g. “nue” implies “nue_cc+nue_nc”. For other
details of how the substrings are interpreted, see docs for
NuFlavIntGroup.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>grouped, ungrouped</p>
</dd>
</dl>
<dl class="simple">
<dt>grouped, ungrouped</dt><dd><p>lists of NuFlavIntGroups; the first will have more than one flavint
in each NuFlavIntGroup whereas the second will have just one
flavint in each NuFlavIntGroup. Either list can be of 0-length.</p>
</dd>
</dl>
<p>This function does not enforce mutual-exclusion on flavints in the
various flavint groupings, but does list any flavints not grouped
together in the <cite>ungrouped</cite> return arg. Mutual exclusion can be
enforced through set operations upon return.</p>
</dd></dl>

</section>
<section id="module-pisa.utils.flux_weights">
<span id="pisa-utils-flux-weights-module"></span><h2>pisa.utils.flux_weights module<a class="headerlink" href="#module-pisa.utils.flux_weights" title="Link to this heading"></a></h2>
<p>A set of functions for calculating flux weights given an array of energy and
cos(zenith) values based on the Honda atmospheric flux tables. A lot of this
functionality will be copied from honda.py but since I don’t want to initialise
this as a stage it makes sense to copy it in to here so somebody can’t
accidentally do the wrong thing with that script.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flux_weights.calculate_2d_flux_weights">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flux_weights.</span></span><span class="sig-name descname"><span class="pre">calculate_2d_flux_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_coszens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">en_splines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enpow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flux_weights.html#calculate_2d_flux_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flux_weights.calculate_2d_flux_weights" title="Link to this definition"></a></dt>
<dd><p>Calculate flux weights for given array of energy and cos(zenith).
Arrays of true energy and zenith are expected to be for MC events, so
they are tested to be of the same length.
<cite>en_splines</cite> should be the spline for the primary of interest. The entire
dictionary is calculated in the previous function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>true_energies</strong> (<em>list</em><em> or </em><em>numpy array</em>) – A list of the true energies of your MC events. Pass this in GeV!</p></li>
<li><p><strong>true_coszens</strong> (<em>list</em><em> or </em><em>numpy array</em>) – A list of the true coszens of your MC events</p></li>
<li><p><strong>en_splines</strong> (<em>list</em><em> of </em><em>splines</em>) – A list of the initialised energy splines from the previous function
for your desired primary.</p></li>
<li><p><strong>enpow</strong> (<em>integer</em>) – The power to which the energy was raised in the construction of the
splines. If you don’t know what this means, leave it as 1.</p></li>
<li><p><strong>out</strong> (<em>np.array</em>) – optional array to store results</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Use the previous function to calculate the spline dict for the South Pole.</p>
<blockquote>
<div><p>spline_dict = load_2d_table(‘flux/honda-2015-spl-solmax-aa.d’)</p>
</div></blockquote>
<p>Then you must have some equal length arrays of energy and zenith.</p>
<blockquote>
<div><p>ens = [3.0, 4.0, 5.0]
czs = [-0.4, 0.7, 0.3]</p>
</div></blockquote>
<p>These are used in this function, along with whatever primary you are
interested in calculating the flux weights for.</p>
<blockquote>
<div><p>flux_weights = calculate_2d_flux_weights(ens, czs, spline_dict[‘numu’])</p>
</div></blockquote>
<p>Done!</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flux_weights.calculate_3d_flux_weights">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flux_weights.</span></span><span class="sig-name descname"><span class="pre">calculate_3d_flux_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_coszens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_azimuths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">en_splines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enpow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az_linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flux_weights.html#calculate_3d_flux_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flux_weights.calculate_3d_flux_weights" title="Link to this definition"></a></dt>
<dd><p>Calculate flux weights for given array of energy, cos(zenith) and
azimuth.</p>
<p>Arrays of true energy, zenith and azimuth are expected to be for MC events,
so they are tested to be of the same length.
En_splines should be the spline for the primary of interest. The entire
dictionary is calculated in the previous function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>true_energies</strong> (<em>list</em><em> or </em><em>numpy array</em>) – A list of the true energies of your MC events. Pass this in GeV!</p></li>
<li><p><strong>true_coszens</strong> (<em>list</em><em> or </em><em>numpy array</em>) – A list of the true coszens of your MC events</p></li>
<li><p><strong>true_azimuths</strong> (<em>list</em><em> or </em><em>numpy array</em>) – A list of the true azimuths of your MC events. Pass this in radians!</p></li>
<li><p><strong>en_splines</strong> (<em>list</em><em> of </em><em>splines</em>) – A list of the initialised energy splines from the previous function
for your desired primary.</p></li>
<li><p><strong>enpow</strong> (<em>integer</em>) – The power to which the energy was raised in the construction of the
splines. If you don’t know what this means, leave it as 1.</p></li>
<li><p><strong>az_linear</strong> (<em>boolean</em>) – Whether or not to linearly interpolate in the azimuthal direction. If
you don’t know why this is an option, leave it as true.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Use the previous function to calculate the spline dict for the South Pole.</p>
<blockquote>
<div><p>spline_dict = load_3d_table(‘flux/honda-2015-spl-solmax.d’)</p>
</div></blockquote>
<p>Then you must have some equal length arrays of energy, zenith and azimuth.</p>
<blockquote>
<div><p>ens = [3.0, 4.0, 5.0]
czs = [-0.4, 0.7, 0.3]
azs = [0.3, 1.2, 2.1]</p>
</div></blockquote>
<p>These are used in this function, along with whatever primary you are
interested in calculating the flux weights for.</p>
<blockquote>
<div><dl class="simple">
<dt>flux_weights = calculate_3d_flux_weights(ens,</dt><dd><p>czs,
azs,
spline_dict[‘numu’])</p>
</dd>
</dl>
</div></blockquote>
<p>Done!</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flux_weights.load_2d_bartol_table">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flux_weights.</span></span><span class="sig-name descname"><span class="pre">load_2d_bartol_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enpow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flux_weights.html#load_2d_bartol_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flux_weights.load_2d_bartol_table" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flux_weights.load_2d_honda_table">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flux_weights.</span></span><span class="sig-name descname"><span class="pre">load_2d_honda_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enpow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hg_taumode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flux_weights.html#load_2d_honda_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flux_weights.load_2d_honda_table" title="Link to this definition"></a></dt>
<dd><p>Added “hg_taumode” to load in hillas gaisser h3a tables made with tau neutrino contributions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flux_weights.load_2d_table">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flux_weights.</span></span><span class="sig-name descname"><span class="pre">load_2d_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enpow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flux_weights.html#load_2d_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flux_weights.load_2d_table" title="Link to this definition"></a></dt>
<dd><p>Manipulate 2 dimensional flux tables.</p>
<p>2D is expected to mean energy and cosZenith, where azimuth is averaged
over (before being stored in the table) and the zenith range should
include both hemispheres.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux_file</strong> (<em>string</em>) – The location of the flux file you want to spline. Should be a honda
azimuth-averaged file.</p></li>
<li><p><strong>enpow</strong> (<em>integer</em>) – The power to which the energy will be raised in the construction of the
splines. If you don’t know what this means, leave it as 1.</p></li>
<li><p><strong>return_table</strong> (<em>boolean</em>) – Flag to true if you want the function to also return a dictionary
of the underlying values from the tables. Useful for comparisons.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flux_weights.load_3d_honda_table">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flux_weights.</span></span><span class="sig-name descname"><span class="pre">load_3d_honda_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enpow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flux_weights.html#load_3d_honda_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flux_weights.load_3d_honda_table" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.flux_weights.load_3d_table">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.flux_weights.</span></span><span class="sig-name descname"><span class="pre">load_3d_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enpow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/flux_weights.html#load_3d_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.flux_weights.load_3d_table" title="Link to this definition"></a></dt>
<dd><p>Manipulate 3 dimensional flux tables.</p>
<p>3D is expected to mean energy, cosZenith and azimuth. The angular range
should be fully sky.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux_file</strong> (<em>string</em>) – The location of the flux file you want to spline. Should be a honda
azimuth-averaged file.</p></li>
<li><p><strong>enpow</strong> (<em>integer</em>) – The power to which the energy will be raised in the construction of the
splines. If you don’t know what this means, leave it as 1.</p></li>
<li><p><strong>return_table</strong> (<em>boolean</em>) – Flag to true if you want the function to also return a dictionary
of the underlying values from the tables. Useful for comparisons.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pisa.utils.format">
<span id="pisa-utils-format-module"></span><h2>pisa.utils.format module<a class="headerlink" href="#module-pisa.utils.format" title="Link to this heading"></a></h2>
<p>Utilities for interpreting and returning formatted strings.</p>
<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.format.BIN_PREFIX_TO_POWER_OF_1024">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">BIN_PREFIX_TO_POWER_OF_1024</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'':</span> <span class="pre">0,</span> <span class="pre">'Ei':</span> <span class="pre">6,</span> <span class="pre">'Gi':</span> <span class="pre">3,</span> <span class="pre">'Ki':</span> <span class="pre">1,</span> <span class="pre">'Mi':</span> <span class="pre">2,</span> <span class="pre">'Pi':</span> <span class="pre">5,</span> <span class="pre">'Ti':</span> <span class="pre">4,</span> <span class="pre">'Yi':</span> <span class="pre">8,</span> <span class="pre">'Zi':</span> <span class="pre">7}</span></em><a class="headerlink" href="#pisa.utils.format.BIN_PREFIX_TO_POWER_OF_1024" title="Link to this definition"></a></dt>
<dd><p>Mapping from binary prefixes to powerorders-of-1024</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.format.NUMBER_RE">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">NUMBER_RE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">re.compile('((?:-|\\+){0,1}[0-9.]+(?:e(?:-|\\+)[0-9.]+){0,1})',</span> <span class="pre">re.IGNORECASE)</span></em><a class="headerlink" href="#pisa.utils.format.NUMBER_RE" title="Link to this definition"></a></dt>
<dd><p>Regex for matching signed, unsigned, and sci.-not. (“1e10”) numbers.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.format.NUMBER_RESTR">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">NUMBER_RESTR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'((?:-|\\+){0,1}[0-9.]+(?:e(?:-|\\+)[0-9.]+){0,1})'</span></em><a class="headerlink" href="#pisa.utils.format.NUMBER_RESTR" title="Link to this definition"></a></dt>
<dd><p>RE str for matching signed, unsigned, and sci.-not. (“1e10”) numbers.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.format.ORDER_OF_MAG_TO_SI_PREFIX">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">ORDER_OF_MAG_TO_SI_PREFIX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{-24:</span> <span class="pre">'y',</span> <span class="pre">-21:</span> <span class="pre">'z',</span> <span class="pre">-18:</span> <span class="pre">'a',</span> <span class="pre">-15:</span> <span class="pre">'f',</span> <span class="pre">-12:</span> <span class="pre">'p',</span> <span class="pre">-9:</span> <span class="pre">'n',</span> <span class="pre">-6:</span> <span class="pre">'μ',</span> <span class="pre">-3:</span> <span class="pre">'m',</span> <span class="pre">0:</span> <span class="pre">'',</span> <span class="pre">3:</span> <span class="pre">'k',</span> <span class="pre">6:</span> <span class="pre">'M',</span> <span class="pre">9:</span> <span class="pre">'G',</span> <span class="pre">12:</span> <span class="pre">'T',</span> <span class="pre">15:</span> <span class="pre">'P',</span> <span class="pre">18:</span> <span class="pre">'E',</span> <span class="pre">21:</span> <span class="pre">'Z',</span> <span class="pre">24:</span> <span class="pre">'Y'}</span></em><a class="headerlink" href="#pisa.utils.format.ORDER_OF_MAG_TO_SI_PREFIX" title="Link to this definition"></a></dt>
<dd><p>Mapping of powers-of-10 to SI prefixes (orders-of-magnitude)</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.format.POWER_OF_1024_TO_BIN_PREFIX">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">POWER_OF_1024_TO_BIN_PREFIX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{0:</span> <span class="pre">'',</span> <span class="pre">1:</span> <span class="pre">'Ki',</span> <span class="pre">2:</span> <span class="pre">'Mi',</span> <span class="pre">3:</span> <span class="pre">'Gi',</span> <span class="pre">4:</span> <span class="pre">'Ti',</span> <span class="pre">5:</span> <span class="pre">'Pi',</span> <span class="pre">6:</span> <span class="pre">'Ei',</span> <span class="pre">7:</span> <span class="pre">'Zi',</span> <span class="pre">8:</span> <span class="pre">'Yi'}</span></em><a class="headerlink" href="#pisa.utils.format.POWER_OF_1024_TO_BIN_PREFIX" title="Link to this definition"></a></dt>
<dd><p>Mapping from powers-of-1024 to binary prefixes</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.format.SI_PREFIX_TO_ORDER_OF_MAG">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">SI_PREFIX_TO_ORDER_OF_MAG</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'':</span> <span class="pre">0,</span> <span class="pre">'E':</span> <span class="pre">18,</span> <span class="pre">'G':</span> <span class="pre">9,</span> <span class="pre">'M':</span> <span class="pre">6,</span> <span class="pre">'P':</span> <span class="pre">15,</span> <span class="pre">'T':</span> <span class="pre">12,</span> <span class="pre">'Y':</span> <span class="pre">24,</span> <span class="pre">'Z':</span> <span class="pre">21,</span> <span class="pre">'a':</span> <span class="pre">-18,</span> <span class="pre">'f':</span> <span class="pre">-15,</span> <span class="pre">'k':</span> <span class="pre">3,</span> <span class="pre">'m':</span> <span class="pre">-3,</span> <span class="pre">'n':</span> <span class="pre">-9,</span> <span class="pre">'p':</span> <span class="pre">-12,</span> <span class="pre">'u':</span> <span class="pre">-6,</span> <span class="pre">'y':</span> <span class="pre">-24,</span> <span class="pre">'z':</span> <span class="pre">-21,</span> <span class="pre">'μ':</span> <span class="pre">-6}</span></em><a class="headerlink" href="#pisa.utils.format.SI_PREFIX_TO_ORDER_OF_MAG" title="Link to this definition"></a></dt>
<dd><p>Mapping of SI prefixes to powers-of-10</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.arg_str_seq_none">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">arg_str_seq_none</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#arg_str_seq_none"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.arg_str_seq_none" title="Link to this definition"></a></dt>
<dd><p>Simple input handler.
:param inputs: Input value(s) provided by caller
:type inputs: None, string, or iterable of strings
:param name: Name of input, used for producing a meaningful error message
:type name: string</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None, or list of strings</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TypeError if unrecognized type</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.arg_to_tuple">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">arg_to_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#arg_to_tuple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.arg_to_tuple" title="Link to this definition"></a></dt>
<dd><p>Convert <cite>arg</cite> to a tuple: None becomes an empty tuple, an isolated
string becomes a tuple containing that string, and any iterable or sequence
is simply converted into a tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>str</em><em>, </em><em>sequence</em><em> of </em><em>str</em><em>, </em><em>iterable</em><em> of </em><em>str</em><em>, or </em><em>None</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>arg_tup</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.default_map_tex">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">default_map_tex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#default_map_tex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.default_map_tex" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.engfmt">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">engfmt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigfigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign_always</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#engfmt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.engfmt" title="Link to this definition"></a></dt>
<dd><p>Format number as string in engineering format (10^(multiples-of-three)),
including the most common metric prefixes (from atto to Exa).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>scalar</em>) – Number to be formatted</p></li>
<li><p><strong>sigfigs</strong> (<em>int &gt;= 0</em>) – Number of significant figures to limit the result to; default=3.</p></li>
<li><p><strong>decimals</strong> (<em>int</em><em> or </em><em>None</em>) – Number of decimals to display (zeros filled out as necessary). If None,
<cite>decimals</cite> is automatically determined by the magnitude of the
significand and the specified <cite>sigfigs</cite>.</p></li>
<li><p><strong>sign_always</strong> (<em>bool</em>) – Prefix the number with “+” sign if number is positive; otherwise,
only negative numbers are prefixed with a sign (“-“)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.format_num">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">format_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigfigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sci_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">-4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trailing_zeros</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">always_show_sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thousands_sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thousandths_sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expprefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exppostfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nanstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#format_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.format_num" title="Link to this definition"></a></dt>
<dd><p>Fine-grained control over formatting a number as a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>numeric</em>) – The number to be formatted.</p></li>
<li><p><strong>sigfigs</strong> (<em>int &gt; 0</em><em>, </em><em>optional</em>) – Use up to this many significant figures for displaying a number. You
can use either <cite>sigfigs</cite> or <cite>precision</cite>, but not both. If neither are
specified, default is to set <cite>sigfigs</cite> to 8. See also <cite>trailing_zeros</cite>.</p></li>
<li><p><strong>precision</strong> (<em>float</em><em>, </em><em>optional</em>) – Round <cite>value</cite> to a precision the same as the order of magnitude of
<cite>precision</cite>. You can use either <cite>precision</cite> or <cite>sigfigs</cite>, but not both.
If neither is specified, default is to set <cite>sigfigs</cite> to 8. See also
<cite>trailing_zeros</cite>.</p></li>
<li><p><strong>fmt</strong> (<em>None</em><em> or </em><em>one</em><em> of </em><em>{'sci'</em><em>, </em><em>'eng'</em><em>, </em><em>'sipre'</em><em>, </em><em>'binpre'</em><em>, </em><em>'full'}</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Force a particular format to be used::</dt><dd><ul>
<li><p>None allows the <cite>value</cite> and what is passed for <cite>sci_thresh</cite> and
<cite>exponent</cite> to decide whether or not to use scientific notation</p></li>
<li><p>’sci’ forces scientific notation</p></li>
<li><p>’eng’ uses the engineering convention of powers divisible by 3
(10e6, 100e-9, etc.)</p></li>
<li><p>’sipre’ uses powers divisible by 3 but uses SI prefixes (e.g. k,
M, G, etc.) instead of displaying the exponent</p></li>
<li><p>’binpre’ uses powers of 1024 and uses IEC prefixes (e.g. Ki, Mi,
Gi, etc.) instead displaying the exponent</p></li>
<li><p>’full’ forces printing all digits left and/or right of the
decimal to display the number (no exponent notation or SI/binary
prefix will be used)</p></li>
</ul>
</dd>
</dl>
<p>Note that the display of NaN and +/-inf are unaffected by
<cite>fmt</cite>.</p>
</p></li>
<li><p><strong>exponent</strong> (<em>None</em><em>, </em><em>integer</em><em>, or </em><em>string</em><em>, </em><em>optional</em>) – Force the number to be scaled with respect to this exponent. If a
string prefix is passed and <cite>fmt</cite> is None, then the SI prefix
or binary prefix will be used for the number. E.g., <code class="docutils literal notranslate"><span class="pre">exponent=3</span></code>
would cause the number 1 to be expressed as <code class="docutils literal notranslate"><span class="pre">'0.001e3'`,</span> <span class="pre">while</span>
<span class="pre">``exponent='k'</span></code> would cause it to be displayed as <code class="docutils literal notranslate"><span class="pre">'1</span> <span class="pre">m'</span></code>. Both ‘μ’
and ‘u’ are accepted to mean “micro”. A non-<code class="docutils literal notranslate"><span class="pre">None</span></code> value for
<cite>exponent</cite> forces some form of scientific/engineering notation, so
<cite>fmt</cite> cannot be <code class="docutils literal notranslate"><span class="pre">'full'</span></code> in this case. Finally, if
<cite>fmt</cite> is <code class="docutils literal notranslate"><span class="pre">'binpre'</span></code> then <cite>exponent</cite> is applied to 1024.
I.e., 1 maps to kibi (Ki), 2 maps to mebi (Mi), etc.</p></li>
<li><p><strong>sci_thresh</strong> (<em>sequence</em><em> of </em><em>2 integers</em>) – When to switch to scientific notation. The first integer is the order
of magnitude of <cite>value</cite> at or above which scientific notation will be
used. The second integer indicates the order of magnitude at or below
which the most significant digit falls for scientific notation to be
used. E.g., <code class="docutils literal notranslate"><span class="pre">sci_thresh=(3,</span> <span class="pre">-3)</span></code> means that numbers in the
ones-of-thousands or greater OR numbers in the ones-of-thousandths or
less will be displayed using scientific notation. Note that
<cite>fmt</cite>, if not None, overrides this behavior. Default is
(10,-5).</p></li>
<li><p><strong>inf_thresh</strong> (<em>numeric</em><em>, </em><em>optional</em>) – Numbers whose magnitude is equal to or greater than this threhshold are
considered infinite and therefore displayed using <cite>infstr</cite> (possibly
including a sign, as appropriate). Default is np.inf.</p></li>
<li><p><strong>trailing_zeros</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display all significant figures specified by <cite>sigfigs</cite>, even
if this results in trailing zeros. Default is False.</p></li>
<li><p><strong>always_show_sign</strong> (<em>bool</em><em>, </em><em>optional</em>) – Always show a sign, whether number is positive or negative, and whether
exponent (if present) is positive or negative. Default is False.</p></li>
<li><p><strong>decstr</strong> (<em>string</em><em>, </em><em>optional</em>) – Separator to use for the decimal point. E.g. <code class="docutils literal notranslate"><span class="pre">decstr='.'</span></code> or
<code class="docutils literal notranslate"><span class="pre">decstr=','</span></code> for mthe most common cases, but this can also be used in
TeX tables for alignment on decimal points via <code class="docutils literal notranslate"><span class="pre">decstr='&amp;.&amp;'</span></code>.
Default is ‘.’.</p></li>
<li><p><strong>thousands_sep</strong> (<em>None</em><em> or </em><em>string</em><em>, </em><em>optional</em>) – Separator to use between thousands, e.g. <code class="docutils literal notranslate"><span class="pre">thousands_sep=','</span></code> to give
results like <code class="docutils literal notranslate"><span class="pre">'1,000,000'</span></code>, or <code class="docutils literal notranslate"><span class="pre">`thousands_sep=r'\,'</span></code> for TeX
formatting with small spaces between thousands. Default is None.</p></li>
<li><p><strong>thousandths_sep</strong> (<em>None</em><em> or </em><em>string</em><em>, </em><em>optional</em>) – Separator to use between thousandthss. Default is None.</p></li>
<li><p><strong>left_delimiter</strong> (<em>None</em><em> or </em><em>string</em><em>, </em><em>optional</em>) – Strings to delimit the left and right sides of the resulting string.
E.g. <code class="docutils literal notranslate"><span class="pre">left_delimiter='${'</span></code> and <code class="docutils literal notranslate"><span class="pre">right_delimiter='}$'</span></code> could be used
to delimit TeX-formatted strings, such that a number is displayed,
e.g., as <code class="docutils literal notranslate"><span class="pre">r'${1\times10^3}$'</span></code>. Defaults are None for both.</p></li>
<li><p><strong>right_delimiter</strong> (<em>None</em><em> or </em><em>string</em><em>, </em><em>optional</em>) – Strings to delimit the left and right sides of the resulting string.
E.g. <code class="docutils literal notranslate"><span class="pre">left_delimiter='${'</span></code> and <code class="docutils literal notranslate"><span class="pre">right_delimiter='}$'</span></code> could be used
to delimit TeX-formatted strings, such that a number is displayed,
e.g., as <code class="docutils literal notranslate"><span class="pre">r'${1\times10^3}$'</span></code>. Defaults are None for both.</p></li>
<li><p><strong>expprefix</strong> (<em>None</em><em> or </em><em>string</em><em>, </em><em>optional</em>) – E.g. use <cite>expprefix=’e’</cite> for simple “e” scientific notation (“1e3”),
or use <cite>expprefix=r’times10^{’</cite> and <cite>exppostfix=r’}’ for
TeX-formatted scientific notation. Use a space (or tex equivalent) for
binary and SI prefixes. If scientific notation is to be used,
`expprefix</cite> defaults to ‘e’. If either SI or binary prefixes are to be
used, <cite>expprefix</cite> defaults to ‘ ‘ (space). In any case, <cite>exppostfix</cite>
defaults to None.</p></li>
<li><p><strong>exppostfix</strong> (<em>None</em><em> or </em><em>string</em><em>, </em><em>optional</em>) – E.g. use <cite>expprefix=’e’</cite> for simple “e” scientific notation (“1e3”),
or use <cite>expprefix=r’times10^{’</cite> and <cite>exppostfix=r’}’ for
TeX-formatted scientific notation. Use a space (or tex equivalent) for
binary and SI prefixes. If scientific notation is to be used,
`expprefix</cite> defaults to ‘e’. If either SI or binary prefixes are to be
used, <cite>expprefix</cite> defaults to ‘ ‘ (space). In any case, <cite>exppostfix</cite>
defaults to None.</p></li>
<li><p><strong>nanstr</strong> (<em>string</em><em>, </em><em>optional</em>) – Not-a-number (NaN) values will be displayed using this string. Default
is ‘nan’ (following the Numpy convention)</p></li>
<li><p><strong>infstr</strong> (<em>string</em><em>, </em><em>optional</em>) – Infinite values will be displayed using this string (note that the sign
is prepended, as appropriate). Default is ‘inf’ (following the Numpy
convention).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>formatted</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.hash2hex">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">hash2hex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hash</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#hash2hex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.hash2hex" title="Link to this definition"></a></dt>
<dd><p>Convert a hash value to its string hexadecimal representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hash</strong> (<em>integer</em><em> or </em><em>string</em>)</p></li>
<li><p><strong>bits</strong> (<em>integer &gt; 0</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hash</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.hr_range_formatter">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">hr_range_formatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#hr_range_formatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.hr_range_formatter" title="Link to this definition"></a></dt>
<dd><p>Format a range (sequence) in a simple and human-readable format by
specifying the range’s starting number, ending number (inclusive), and step
size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>numeric</em>)</p></li>
<li><p><strong>end</strong> (<em>numeric</em>)</p></li>
<li><p><strong>step</strong> (<em>numeric</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If <cite>start</cite> and <cite>end</cite> are integers and <cite>step</cite> is 1, step size is omitted.</p>
<p>The format does NOT follow Python’s slicing syntax, in part because the
interpretation is meant to differ; e.g.,</p>
<blockquote>
<div><p>‘0-10:2’ includes both 0 and 10 with step size of 2</p>
</div></blockquote>
<dl class="simple">
<dt>whereas</dt><dd><p>0:10:2 (slicing syntax) excludes 10</p>
</dd>
</dl>
<p>Numbers are converted to integers if they are equivalent for more compact
display.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hr_range_formatter</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;0-10&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hr_range_formatter</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;0-10:2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hr_range_formatter</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">&#39;0-3:8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hr_range_formatter</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">3.1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="go">&#39;0.1-3.1:1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.hrbool2bool">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">hrbool2bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#hrbool2bool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.hrbool2bool" title="Link to this definition"></a></dt>
<dd><p>Convert a string that a user might input to indicate a boolean value of
either True or False and convert to the appropriate Python bool.</p>
<ul class="simple">
<li><p>Note first that the case used in the string is ignored</p></li>
<li><p>‘t’, ‘true’, ‘1’, ‘yes’, and ‘one’ all map to True</p></li>
<li><p>‘f’, ‘false’, ‘0’, ‘no’, and ‘zero’ all map to False</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<em>string</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>b</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.hrlist2list">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">hrlist2list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hrlst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#hrlist2list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.hrlist2list" title="Link to this definition"></a></dt>
<dd><p>Convert human-readable string specifying a list of numbers to a Python
list of numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hrlist</strong> (<em>string</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>lst</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of numbers</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.hrlol2lol">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">hrlol2lol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hrlol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#hrlol2lol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.hrlol2lol" title="Link to this definition"></a></dt>
<dd><p>Convert a human-readable string specifying a list-of-lists of numbers to
a Python list-of-lists of numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hrlol</strong> (<em>string</em>) – Human-readable list-of-lists-of-numbers string. Each list specification
is separated by a semicolon, and whitespace is ignored. Refer to
<cite>hrlist2list</cite> for list specification.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>lol</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list-of-lists of numbers</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>A single number evaluates to a list with a list with a single number.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span> <span class="n">hrlol2lol</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<span class="go">[[1]]</span>
</pre></div>
</div>
<p>A sequence of numbers or ranges can be specified separated by commas.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span> <span class="n">hrlol2lol</span><span class="p">(</span><span class="s2">&quot;1, 3.2, 19.8&quot;</span><span class="p">)</span>
<span class="go">[[1, 3.2, 19.8]]</span>
</pre></div>
</div>
<p>A range can be specified with a dash; default is a step size of 1 (or -1 if
the end of the range is less than the start of the range); note that the
endpoint is included, unlike slicing in Python.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span> <span class="n">hrlol2lol</span><span class="p">(</span><span class="s2">&quot;1-3&quot;</span><span class="p">)</span>
<span class="go">[[1, 2, 3]]</span>
</pre></div>
</div>
<p>The range can go from or to a negative number, and can go in a negative
direction.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span> <span class="n">hrlol2lol</span><span class="p">(</span><span class="s2">&quot;-1 - -5&quot;</span><span class="p">)</span>
<span class="go">[[-1, -3, -5]]</span>
</pre></div>
</div>
<p>Multiple lists are separated by semicolons, and parentheses and brackets
can be used to make it easier to understand the string.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span> <span class="n">hrlol2lol</span><span class="p">(</span><span class="s2">&quot;1 ; 8 ; [(-10 - -8:2), 1]&quot;</span><span class="p">)</span>
<span class="go">[[1], [8], [-10, -8, 1]]</span>
</pre></div>
</div>
<p>Finally, all of the above can be combined.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span> <span class="n">hrlol2lol</span><span class="p">(</span><span class="s2">&quot;1.-3.; 9.5-10.6:0.5,3--1:-1; 12.5-13:0.8&quot;</span><span class="p">)</span>
<span class="go">[[1, 2, 3], [9.5, 10.0, 10.5, 3, 2, 1, 0, -1], [12.5]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.int2hex">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">int2hex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#int2hex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.int2hex" title="Link to this definition"></a></dt>
<dd><p>Convert a signed or unsigned integer <cite>bits</cite> long to hexadecimal
representation. As many hex characters are returned to fully specify any
number <cite>bits</cite> in length regardless of the value of <cite>i</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – The integer to be converted. Signed integers have a range of
-2**(bits-1) to 2**(bits-1)-1), while unsigned integers have a range of
0 to 2**(bits-1).</p></li>
<li><p><strong>bits</strong> (<em>int</em>) – Number of bits long the representation is</p></li>
<li><p><strong>signed</strong> (<em>bool</em>) – Whether the number is a signed integer; this is dependent upon the
representation used for numbers, and _not_ whether the value <cite>i</cite> is
positive or negative.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>h</strong> (<em>string of length ceil(bits/4.0) since it takes this many hex characters</em>)</p></li>
<li><p>to represent a number <cite>bits</cite> long.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.is_tex">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">is_tex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#is_tex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.is_tex" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.list2hrlist">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">list2hrlist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#list2hrlist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.list2hrlist" title="Link to this definition"></a></dt>
<dd><p>Convert a list of numbers to a compact and human-readable string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lst</strong> (<em>sequence</em>)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Adapted to make scientific notation work correctly from [1].</p>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] <a class="reference external" href="http://stackoverflow.com/questions/9847601">http://stackoverflow.com/questions/9847601</a> user Scott B’s adaptation to</dt><dd><p>Python 2 of Rik Poggi’s answer to his question</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">list2hrlist</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">&#39;0,1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list2hrlist</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">&#39;0,3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list2hrlist</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">&#39;0-2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utils</span><span class="o">.</span><span class="n">list2hrlist</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">])</span>
<span class="go">&#39;0.1-3.1:1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list2hrlist</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="go">&#39;0-2,4-6,20&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.make_valid_python_name">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">make_valid_python_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#make_valid_python_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.make_valid_python_name" title="Link to this definition"></a></dt>
<dd><p>Make a name a valid Python identifier.</p>
<p>From user Triptych at <a class="reference external" href="http://stackoverflow.com/questions/3303312">http://stackoverflow.com/questions/3303312</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.sep_three_tens">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">sep_three_tens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#sep_three_tens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.sep_three_tens" title="Link to this definition"></a></dt>
<dd><p>Insert <cite>sep</cite> char into sequence of chars <cite>strval</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>strval</strong> (<em>sequence</em><em> of </em><em>chars</em><em> or </em><em>string</em>) – Sequence of chars into which to insert the separator</p></li>
<li><p><strong>direction</strong> (<em>string</em><em>, </em><em>one</em><em> of </em><em>{'left'</em><em>, </em><em>'right'}</em>) – Use ‘left’ for left of the decimal, and ‘right’ for right of the
decimal</p></li>
<li><p><strong>sep</strong> (<em>None</em><em> or </em><em>char</em>) – Separator to insert</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>formatted</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of chars</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.split">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_case</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parse_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.split" title="Link to this definition"></a></dt>
<dd><p>Parse a string containing a separated list.</p>
<ul class="simple">
<li><p>Before splitting the list, the string has extraneous whitespace removed
from either end.</p></li>
<li><p>The strings that result after the split can have their case forced or be
left alone.</p></li>
<li><p>Whitespace surrounding (but not falling between non-whitespace) in each
resulting string is removed.</p></li>
<li><p>After all of the above, the value can be parsed further by a
user-supplied <cite>parse_func</cite>.</p></li>
</ul>
<p>Note that repeating a separator without intervening values yields
empty-string values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<em>string</em>) – The string to be split</p></li>
<li><p><strong>sep</strong> (<em>string</em>) – Separator to look for</p></li>
<li><p><strong>force_case</strong> (<em>None</em><em>, </em><em>'lower'</em><em>, or </em><em>'upper'</em>) – Whether to force the case of the resulting items: None does not change
the case, while ‘lower’ or ‘upper’ change the case.</p></li>
<li><p><strong>parse_func</strong> (<em>None</em><em> or </em><em>callable</em>) – If a callable is supplied, each item in the list, after the basic
parsing, is processed by <cite>parse_func</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>lst</strong> – The types of the items in the list depend upon <cite>parse_func</cite> if it is
supplied; otherwise, all items are strings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of objects</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; One, TWO, three &#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">force_case</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">))</span>
<span class="go">[&#39;one&#39;, &#39;two&#39;, &#39;three&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;One:TWO:three&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">))</span>
<span class="go">[&#39;One&#39;, &#39;TWO&#39;, &#39;three&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;one  two  three&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="go">[&#39;one&#39;, &#39;&#39;, &#39;two&#39;, &#39;&#39; , &#39;three&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;1 2 3&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">parse_func</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;True; False; None; (1, 2, 3)&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">parse_func</span><span class="o">=</span><span class="n">literal_eval</span><span class="p">))</span>
<span class="go">[True, False, None, (1, 2, 3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.strip_outer_dollars">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">strip_outer_dollars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#strip_outer_dollars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.strip_outer_dollars" title="Link to this definition"></a></dt>
<dd><p>Strip surrounding dollars signs from TeX string, ignoring leading and
trailing whitespace</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.strip_outer_parens">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">strip_outer_parens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#strip_outer_parens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.strip_outer_parens" title="Link to this definition"></a></dt>
<dd><p>Strip parentheses surrounding a string, ignoring leading and trailing
whitespace</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.test_format_num">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">test_format_num</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#test_format_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.test_format_num" title="Link to this definition"></a></dt>
<dd><p>Unit tests for the <cite>format_num</cite> function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.test_hr_range_formatter">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">test_hr_range_formatter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#test_hr_range_formatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.test_hr_range_formatter" title="Link to this definition"></a></dt>
<dd><p>Unit tests for hr_range_formatter</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.test_list2hrlist">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">test_list2hrlist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#test_list2hrlist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.test_list2hrlist" title="Link to this definition"></a></dt>
<dd><p>Unit tests for list2hrlist</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.test_timediff">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">test_timediff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#test_timediff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.test_timediff" title="Link to this definition"></a></dt>
<dd><p>Unit tests for timediff function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.test_timestamp">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">test_timestamp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#test_timestamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.test_timestamp" title="Link to this definition"></a></dt>
<dd><p>Unit tests for timestamp function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.tex_dollars">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">tex_dollars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#tex_dollars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.tex_dollars" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.tex_join">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">tex_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#tex_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.tex_join" title="Link to this definition"></a></dt>
<dd><p>Join TeX-formatted strings together into one, each separated by <cite>sep</cite>.
Also, this strips surrounding ‘$’ from each string before joining.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.text2tex">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">text2tex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">txt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#text2tex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.text2tex" title="Link to this definition"></a></dt>
<dd><p>Convert common characters so they show up the same as TeX</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.timediff">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">timediff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt_sec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hms_always</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sec_decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#timediff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.timediff" title="Link to this definition"></a></dt>
<dd><p>Smart string formatting for a time difference (in seconds)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt_sec</strong> (<em>numeric</em>) – Time difference, in seconds</p></li>
<li><p><strong>hms_always</strong> (<em>bool</em>) – <ul>
<li><dl class="simple">
<dt>True</dt><dd><p>Always display hours, minuts, and seconds regardless of the order-
of-magnitude of dt_sec</p>
</dd>
</dl>
</li>
<li><dl>
<dt>False</dt><dd><p>Display a minimal-length string that is meaningful, by omitting
units that are more significant than those necessary to display
dt_sec; if…
* dt_sec &lt; 1 s</p>
<blockquote>
<div><p>Use engineering formatting for the number.</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>dt_sec is an integer in the range 0-59 (inclusive)</dt><dd><p><cite>sec_decimals</cite> is ignored and the number is formatted as an
integer</p>
</dd>
</dl>
</li>
</ul>
<p>See Notes below for handling of units.</p>
</dd>
</dl>
</li>
</ul>
<p>(Default: False)</p>
</p></li>
<li><p><strong>sec_decimals</strong> (<em>int</em>) – Round seconds to this number of digits</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If colon notation (e.g. HH:MM:SS.xxx, MM:SS.xxx, etc.) is not used, the
number is only seconds, and is appended by a space ‘ ‘ followed by units
of ‘s’ (possibly with a metric prefix).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.format.timestamp">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.format.</span></span><span class="sig-name descname"><span class="pre">timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">winsafe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/format.html#timestamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.format.timestamp" title="Link to this definition"></a></dt>
<dd><p>Simple utility to print out a time, date, or time+date stamp for the
time at which the function is called.</p>
<p>Calling via defaults (explcitly provided here for reference) ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">timestamp</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">winsafe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>should be equivalent to the shell command ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">+</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S%z&#39;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>bool</em>) – Include date (default: True)</p></li>
<li><p><strong>t</strong> (<em>bool</em>) – Include time (default: True)</p></li>
<li><p><strong>tz</strong> (<em>bool</em>) – Include timezone offset from UTC (default: True)</p></li>
<li><p><strong>utc</strong> (<em>bool</em>) – Include UTC time/date (as opposed to local time/date) (default: False)</p></li>
<li><p><strong>winsafe</strong> (<em>bool</em>) – Omit colons between hours/minutes (default: False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pisa.utils.gaussians">
<span id="pisa-utils-gaussians-module"></span><h2>pisa.utils.gaussians module<a class="headerlink" href="#module-pisa.utils.gaussians" title="Link to this heading"></a></h2>
<p>Multiple implementations of sum-of-gaussians for compatibility and speed</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.gaussians.gaussians">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.gaussians.</span></span><span class="sig-name descname"><span class="pre">gaussians</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implementation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/gaussians.html#gaussians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.gaussians.gaussians" title="Link to this definition"></a></dt>
<dd><p>Sum of multiple Gaussian curves, normalized to have area of 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – Points at which to evaluate the sum of Gaussians</p></li>
<li><p><strong>mu</strong> (<em>arrays</em>) – Means of the Gaussians to accumulate</p></li>
<li><p><strong>sigma</strong> (<em>array</em>) – Standard deviations of the Gaussians to accumulate</p></li>
<li><p><strong>weights</strong> (<em>array</em><em> or </em><em>None</em>) – Weights given to each Gaussian</p></li>
<li><p><strong>implementation</strong> (<em>None</em><em> or </em><em>string</em>) – One of ‘singlethreaded’, ‘multithreaded’, or ‘cuda’. Passing None, the
function will try to determine which of the implementations is best to
call.</p></li>
<li><p><strong>kwargs</strong> – Passed on to the underlying implementation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>outbuf</strong> – Resulting sum of Gaussians</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function dynamically calls an appropriate implementation depending
upon the problem size, the hardware available (multi-core CPU or a GPU),
and whether the user specifies <cite>implementation</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.gaussians.test_gaussians">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.gaussians.</span></span><span class="sig-name descname"><span class="pre">test_gaussians</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_perf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/gaussians.html#test_gaussians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.gaussians.test_gaussians" title="Link to this definition"></a></dt>
<dd><p>Test <cite>gaussians</cite> function</p>
</dd></dl>

</section>
<section id="module-pisa.utils.hash">
<span id="pisa-utils-hash-module"></span><h2>pisa.utils.hash module<a class="headerlink" href="#module-pisa.utils.hash" title="Link to this heading"></a></h2>
<p>Utilities for hashing objects.</p>
<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.hash.FAST_HASH_FILESIZE_BYTES">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hash.</span></span><span class="sig-name descname"><span class="pre">FAST_HASH_FILESIZE_BYTES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10000</span></em><a class="headerlink" href="#pisa.utils.hash.FAST_HASH_FILESIZE_BYTES" title="Link to this definition"></a></dt>
<dd><p>For a fast hash on a file object, this many bytes of the file are used</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.hash.FAST_HASH_NDARRAY_ELEMENTS">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hash.</span></span><span class="sig-name descname"><span class="pre">FAST_HASH_NDARRAY_ELEMENTS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000</span></em><a class="headerlink" href="#pisa.utils.hash.FAST_HASH_NDARRAY_ELEMENTS" title="Link to this definition"></a></dt>
<dd><p>For a fast hash on a numpy array or matrix, this many elements of the array
or matrix are used</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.hash.FAST_HASH_STR_CHARS">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hash.</span></span><span class="sig-name descname"><span class="pre">FAST_HASH_STR_CHARS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000</span></em><a class="headerlink" href="#pisa.utils.hash.FAST_HASH_STR_CHARS" title="Link to this definition"></a></dt>
<dd><p>For a fast hash on a string (or object’s pickle string representation), this
many characters are used</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.hash.hash_file">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hash.</span></span><span class="sig-name descname"><span class="pre">hash_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hash.html#hash_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hash.hash_file" title="Link to this definition"></a></dt>
<dd><p>Return a hash for a file, passing contents through hash_obj function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.hash.hash_obj">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hash.</span></span><span class="sig-name descname"><span class="pre">hash_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hash.html#hash_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hash.hash_obj" title="Link to this definition"></a></dt>
<dd><p>Return hash for an object. Object can be a numpy ndarray or matrix
(which is serialized to a string), an open file (which has its contents
read), or any pickle-able Python object.</p>
<p>Note that only the first most-significant 8 bytes (64 bits) from the MD5
sum are used in the hash.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<em>object</em>) – Object to hash. Note that the larger the object, the longer it takes to
hash.</p></li>
<li><p><strong>hash_to</strong> (<em>string</em>) – <dl class="simple">
<dt>‘i’, ‘int’, or ‘integer’: First 8 bytes of the MD5 sum are interpreted</dt><dd><p>as an integer.</p>
</dd>
</dl>
<p>’b’, ‘bin’, or ‘binary’: MD5 sum digest; returns an 8-character string
‘h’, ‘x’, ‘hex’: MD5 sum hexdigest, (string of 16 characters)
‘b64’, ‘base64’: first 8 bytes of MD5 sum are base64 encoded (with ‘+’</p>
<blockquote>
<div><p>and ‘-’ as final two characters of encoding). Returns string of 11
characters.</p>
</div></blockquote>
</p></li>
<li><p><strong>full_hash</strong> (<em>bool</em>) – If True, hash on the full object’s contents (which can be slow) or if
False, hash on a partial object. For example, only a file’s first kB is
read, and only 1000 elements (chosen at random) of a numpy ndarray are
hashed on. This mode of operation should suffice for e.g. a
minimization run, but should _not_ be used for storing to/loading from
disk.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hash_val</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or string</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pisa.utils.hash.hash_file" title="pisa.utils.hash.hash_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hash_file</span></code></a></dt><dd><p>hash a file on disk by filename/path</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.hash.test_hash_file">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hash.</span></span><span class="sig-name descname"><span class="pre">test_hash_file</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hash.html#test_hash_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hash.test_hash_file" title="Link to this definition"></a></dt>
<dd><p>Unit tests for <cite>hash_file</cite> function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.hash.test_hash_obj">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hash.</span></span><span class="sig-name descname"><span class="pre">test_hash_obj</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hash.html#test_hash_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hash.test_hash_obj" title="Link to this definition"></a></dt>
<dd><p>Unit tests for <cite>hash_obj</cite> function</p>
</dd></dl>

</section>
<section id="module-pisa.utils.hdf">
<span id="pisa-utils-hdf-module"></span><h2>pisa.utils.hdf module<a class="headerlink" href="#module-pisa.utils.hdf" title="Link to this heading"></a></h2>
<p>Set of utilities for handling HDF5 file I/O</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.hdf.from_hdf">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hdf.</span></span><span class="sig-name descname"><span class="pre">from_hdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdf.html#from_hdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdf.from_hdf" title="Link to this definition"></a></dt>
<dd><p>Return the contents of an HDF5 file or node as a nested dict; optionally
return a second dict containing any HDF5 attributes attached to the
entry-level HDF5 entity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<em>string</em><em> or </em><em>h5py.Group</em>) – <p>Specifies entry-level entity
* If val is a string, it is interpreted as a filename; file is opened</p>
<blockquote>
<div><p>as an h5py.File</p>
</div></blockquote>
<ul>
<li><p>Otherwise, val must be an h5py.Group in an instantiated object</p></li>
</ul>
</p></li>
<li><p><strong>return_node</strong> (<em>None</em><em> or </em><em>string</em>) – Not yet implemented</p></li>
<li><p><strong>choose</strong> (<em>None</em><em> or </em><em>list</em>) – Optionally can provide a list of variables names to parse (items not in
this list will be skipped, saving time &amp; memory)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Nested dictionary; keys are HDF5 node names and values contain the
contents of that node. If the entry-level entity of <cite>val</cite> has “attrs”,
these are extracted and attached as an OrderedDict at <cite>data.attrs</cite>;
otherwise, this entity is an empty OrderedDict.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict with additional attr of type OrderedDict named <cite>attrs</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.hdf.test_hdf">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hdf.</span></span><span class="sig-name descname"><span class="pre">test_hdf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdf.html#test_hdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdf.test_hdf" title="Link to this definition"></a></dt>
<dd><p>Unit tests for hdf module</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.hdf.to_hdf">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.hdf.</span></span><span class="sig-name descname"><span class="pre">to_hdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdf.html#to_hdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdf.to_hdf" title="Link to this definition"></a></dt>
<dd><p>Store a (possibly nested) dictionary to an HDF5 file or branch node
within an HDF5 file (an h5py Group).</p>
<p>This creates hardlinks for duplicate non-trivial leaf nodes (h5py Datasets)
to minimize storage space required for redundant datasets. Duplication is
detected via object hashing.</p>
<p>NOTE: Branch nodes are sorted before storing (by name) for consistency in
the generated file despite Python dictionaries having no defined ordering
among keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_dict</strong> (<em>Mapping</em>) – Dictionary, OrderedDict, or other Mapping to be stored</p></li>
<li><p><strong>tgt</strong> (<em>str</em><em> or </em><em>h5py.Group</em>) – Target for storing data. If <cite>tgt</cite> is a str, it is interpreted as a
filename; a file is created with that name (overwriting an existing
file, if present). After writing, the file is closed. If <cite>tgt</cite> is an
h5py.Group, the data is simply written to that Group and it is left
open at function return.</p></li>
<li><p><strong>attrs</strong> (<em>Mapping</em>) – Attributes to apply to the top-level entity being written. See
<a class="reference external" href="http://docs.h5py.org/en/latest/high/attr.html">http://docs.h5py.org/en/latest/high/attr.html</a></p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – Set to <cite>True</cite> (default) to allow overwriting existing file. Raise
exception and quit otherwise.</p></li>
<li><p><strong>warn</strong> (<em>bool</em>) – Issue a warning message if a file is being overwritten. Suppress
warning by setting to <cite>False</cite> (e.g. when overwriting is the desired
behaviour).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pisa.utils.hdfchain">
<span id="pisa-utils-hdfchain-module"></span><h2>pisa.utils.hdfchain module<a class="headerlink" href="#module-pisa.utils.hdfchain" title="Link to this heading"></a></h2>
<p>class to access hdf5 files chained together.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.hdfchain.HDFChain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.hdfchain.</span></span><span class="sig-name descname"><span class="pre">HDFChain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdepth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdfchain.html#HDFChain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdfchain.HDFChain" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.hdfchain.HDFChain.getNode">
<span class="sig-name descname"><span class="pre">getNode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdfchain.html#HDFChain.getNode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdfchain.HDFChain.getNode" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.hdfchain.HDFTableProxy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.hdfchain.</span></span><span class="sig-name descname"><span class="pre">HDFTableProxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdfchain.html#HDFTableProxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdfchain.HDFTableProxy" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.hdfchain.HDFTableProxy.col">
<span class="sig-name descname"><span class="pre">col</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdfchain.html#HDFTableProxy.col"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdfchain.HDFTableProxy.col" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.hdfchain.HDFTableProxy.col_iter">
<span class="sig-name descname"><span class="pre">col_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdfchain.html#HDFTableProxy.col_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdfchain.HDFTableProxy.col_iter" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.hdfchain.HDFTableProxy.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdfchain.html#HDFTableProxy.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdfchain.HDFTableProxy.read" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.hdfchain.HDFTableProxy.read_iter">
<span class="sig-name descname"><span class="pre">read_iter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdfchain.html#HDFTableProxy.read_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdfchain.HDFTableProxy.read_iter" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.hdfchain.TableAccessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.hdfchain.</span></span><span class="sig-name descname"><span class="pre">TableAccessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabledict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/hdfchain.html#TableAccessor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.hdfchain.TableAccessor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

</section>
<section id="module-pisa.utils.jsons">
<span id="pisa-utils-jsons-module"></span><h2>pisa.utils.jsons module<a class="headerlink" href="#module-pisa.utils.jsons" title="Link to this heading"></a></h2>
<p>A set of utilities for reading (and instantiating) objects from and writing
objects to JSON files.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.jsons.NumpyDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.jsons.</span></span><span class="sig-name descname"><span class="pre">NumpyDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_hook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parse_float</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parse_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parse_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">object_pairs_hook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#NumpyDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.NumpyDecoder" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">JSONDecoder</span></code></p>
<p>Decode JSON array(s) as numpy.ndarray; also returns python strings
instead of unicode.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.jsons.NumpyDecoder.json_array_numpy">
<span class="sig-name descname"><span class="pre">json_array_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_and_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_once</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#NumpyDecoder.json_array_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.NumpyDecoder.json_array_numpy" title="Link to this definition"></a></dt>
<dd><p>Interpret arrays (lists by default) as numpy arrays where this does
not yield a string or object array; also handle conversion of
particularly-formatted input to pint Quantities.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.jsons.NumpyEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.jsons.</span></span><span class="sig-name descname"><span class="pre">NumpyEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skipkeys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_circular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'utf-8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_decimal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namedtuple_as_object</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tuple_as_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bigint_as_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_sort_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">for_json</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_as_string_bitcount</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterable_as_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#NumpyEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.NumpyEncoder" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">JSONEncoder</span></code></p>
<p>Subclass of ::class::<cite>json.JSONEncoder</cite> that overrides <cite>default</cite> method to
allow writing numpy arrays and other special objects PISA uses to JSON
files.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.jsons.NumpyEncoder.default">
<span class="sig-name descname"><span class="pre">default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#NumpyEncoder.default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.NumpyEncoder.default" title="Link to this definition"></a></dt>
<dd><p>Encode special objects to be representable as JSON.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.jsons.dumps">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.jsons.</span></span><span class="sig-name descname"><span class="pre">dumps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#dumps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.dumps" title="Link to this definition"></a></dt>
<dd><p>Dump object to JSON-encoded string</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.jsons.from_json">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.jsons.</span></span><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.from_json" title="Link to this definition"></a></dt>
<dd><p>Open a file in JSON format (optionally compressed with bz2 or
xor-scrambled) and parse the content into Python objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>)</p></li>
<li><p><strong>cls</strong> (<em>class</em><em> (</em><em>type</em><em>) </em><em>object</em><em>, </em><em>optional</em>) – If provided, the class is attempted to be instantiated as described in
Notes section.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>contents_or_obj</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>simple Python objects or <cite>cls</cite> instantiated therewith</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If <cite>cls</cite> is provided as a class (type) object, this function attempts to
instantiate the class with the data loaded from the JSON file, as follows:</p>
<blockquote>
<div><ul>
<li><p>if <cite>cls</cite> has a <cite>from_json</cite> method, that is called directly: ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">cls</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>if the data loaded from the JSON file is a non-string sequence: ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>if the data loaded is a Mapping (dict, OrderedDict, etc.): ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>for all other types loaded from the JSON: ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p>Note that this currently only recognizes files by their extensions. I.e.,
the file must be named ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myfile</span><span class="o">.</span><span class="n">json</span>
<span class="n">myfile</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">bz2</span>
<span class="n">myfile</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">xor</span>
</pre></div>
</div>
<p>represent a bsic JSON file, a bzip-compressed JSON, and an xor-scrambled
JSON, respectively.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.jsons.json_string">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.jsons.</span></span><span class="sig-name descname"><span class="pre">json_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#json_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.json_string" title="Link to this definition"></a></dt>
<dd><p>Decode a json string</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.jsons.loads">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.jsons.</span></span><span class="sig-name descname"><span class="pre">loads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#loads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.loads" title="Link to this definition"></a></dt>
<dd><p>Load (create) object from JSON-encoded string</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.jsons.test_to_json_from_json">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.jsons.</span></span><span class="sig-name descname"><span class="pre">test_to_json_from_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#test_to_json_from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.test_to_json_from_json" title="Link to this definition"></a></dt>
<dd><p>Unit tests for writing various types of objects to and reading from JSON
files (including bz2-compressed and xor-scrambled files)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.jsons.to_json">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.jsons.</span></span><span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/jsons.html#to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.jsons.to_json" title="Link to this definition"></a></dt>
<dd><p>Write <cite>content</cite> to a JSON file at <cite>filename</cite>.</p>
<p>Uses a custom parser that automatically converts numpy arrays to lists.</p>
<p>If <cite>filename</cite> has a “.bz2” extension, the contents will be compressed
(using bz2 and highest-level of compression, i.e., -9).</p>
<p>If <cite>filename</cite> has a “.xor” extension, the contents will be xor-scrambled to
make them human-unreadable (this is useful for, e.g., blind fits).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>content</strong> (<em>obj</em>) – Object to be written to file. Tries making use of the object’s own
<cite>to_json</cite> method if it exists.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the file to be written to. Extension has to be ‘json’ or ‘bz2’.</p></li>
<li><p><strong>indent</strong> (<em>int</em>) – Pretty-printing. Cf. documentation of json.dump() or json.dumps()</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – Set to <cite>True</cite> (default) to allow overwriting existing file. Raise
exception and quit otherwise.</p></li>
<li><p><strong>warn</strong> (<em>bool</em>) – Issue a warning message if a file is being overwritten (<cite>True</cite>,
default). Suppress warning by setting to <cite>False</cite> (e.g. when overwriting
is the desired behaviour).</p></li>
<li><p><strong>sort_keys</strong> (<em>bool</em>) – Output of dictionaries will be sorted by key if set to <cite>True</cite>.
Default is <cite>False</cite>. Cf. json.dump() or json.dumps().</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pisa.utils.kde_hist">
<span id="pisa-utils-kde-hist-module"></span><h2>pisa.utils.kde_hist module<a class="headerlink" href="#module-pisa.utils.kde_hist" title="Link to this heading"></a></h2>
<p>Functions to get KDE smoothed historgams</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.kde_hist.get_hist">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.kde_hist.</span></span><span class="sig-name descname"><span class="pre">get_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scott'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coszen_reflection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coszen_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coszen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oversample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/kde_hist.html#get_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.kde_hist.get_hist" title="Link to this definition"></a></dt>
<dd><p>Helper function for histograms from KDE</p>
<p>For description of args see kde_histogramdd()</p>
<p>Handling the reflctions at the coszen edges</p>
<section id="todo">
<h3>ToDo:<a class="headerlink" href="#todo" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Handle zenith like coszen? Or better: Define set of variables to perform
reflection on and reflection parameters (e.g. <cite>reflect_fract</cite> or somesuch
to stand in for for <cite>coszen_reflection</cite> and <cite>reflect_dims</cite> as standin for
<cite>coszen_name</cite>; also need some way to specify whether to reflect about lower
and/or upper edge); each such parameter can either be a single value, or a
sequence with one value per variable.</p></li>
<li><p>Any good reason for 0.25 and ‘scott’ defaults? If not, don’t define a
default and force the user to explicitly set this when function is called.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.kde_hist.kde_histogramdd">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.kde_hist.</span></span><span class="sig-name descname"><span class="pre">kde_histogramdd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scott'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cuda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coszen_reflection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coszen_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coszen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oversample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_pid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/kde_hist.html#kde_histogramdd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.kde_hist.kde_histogramdd" title="Link to this definition"></a></dt>
<dd><p>Run kernel density estimation (KDE) for an array of data points, and
then evaluate them on a histogram-like grid to effectively produce a
histogram-like output.
Handles reflection at coszen edges, and will expect coszen to be in the binning</p>
<p>Based on Sebastian Schoenen’s KDE implementation:
<a class="reference external" href="http://code.icecube.wisc.edu/svn/sandbox/schoenen/kde">http://code.icecube.wisc.edu/svn/sandbox/schoenen/kde</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>array</em>) – Shape (N_evts, vars), with vars in the right order corresponding to the
binning order.</p></li>
<li><p><strong>binning</strong> (<a class="reference internal" href="pisa.core.html#pisa.core.binning.MultiDimBinning" title="pisa.core.binning.MultiDimBinning"><em>MultiDimBinning</em></a>) – A coszen dimension is expected</p></li>
<li><p><strong>weights</strong> (<em>None</em><em> or </em><em>array</em>) – Same shape as <cite>sample</cite></p></li>
<li><p><strong>bw_method</strong> (<em>string</em>) – ‘scott’ or ‘silverman’ (see kde module)</p></li>
<li><p><strong>adaptive</strong> (<em>bool</em>) – (see kde module)</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – A parameter for the KDEs (see kde module)</p></li>
<li><p><strong>use_cuda</strong> (<em>bool</em>) – Run on GPU (only works with &lt;= 2d)</p></li>
<li><p><strong>coszen_reflection</strong> (<em>float</em>) – Part (number between 0 and 1) of binning that is reflected at the
coszen -1 and 1 edges</p></li>
<li><p><strong>coszen_name</strong> (<em>string</em>) – Binning name to identify the coszen bin that needs to undergo special
treatment for reflection</p></li>
<li><p><strong>oversample</strong> (<em>int</em>) – Evaluate KDE at more points per bin, takes longer, but is more accurate</p></li>
<li><p><strong>stack_pid</strong> (<em>bool</em>) – Treat each pid bin separately, not as another dimension of the KDEs
Only supported for two additional dimensions, pid binning must be named <cite>pid</cite></p></li>
<li><p><strong>bootstrap</strong> (<em>bool</em>) – Use the <code class="docutils literal notranslate"><span class="pre">bootstrap_kde</span></code> class to produce error estimates on the KDE histograms.
Slow, not recommended during fits.</p></li>
<li><p><strong>bootstrap_niter</strong> (<em>int</em>) – Number of bootstrap iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>histogram</strong> (<em>numpy.ndarray</em>)</p></li>
<li><p><em>ToDo</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>* Maybe return Map with binnings attached insted of nd-array?</em></p></li>
<li><p><em>* Generalize to handle any dimensions with any reflection criterias</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.kde_hist.test_kde_histogramdd">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.kde_hist.</span></span><span class="sig-name descname"><span class="pre">test_kde_histogramdd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/kde_hist.html#test_kde_histogramdd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.kde_hist.test_kde_histogramdd" title="Link to this definition"></a></dt>
<dd><p>Unit tests for kde_histogramdd</p>
</dd></dl>

</section>
<section id="module-pisa.utils.likelihood_functions">
<span id="pisa-utils-likelihood-functions-module"></span><h2>pisa.utils.likelihood_functions module<a class="headerlink" href="#module-pisa.utils.likelihood_functions" title="Link to this heading"></a></h2>
<p>This script contains functions to compute Barlow-Beeston Likelihood, as well as
an implementation of the Poisson-Gamma mixture.</p>
<p>These likelihood implementations (except for poissonLLH) take into account uncertainties due to
finite Monte Carlo statistics.</p>
<p>The functions are called in stats.py to apply them to histograms.</p>
<p>Note that these likelihoods are NOT centered around 0 (i.e. if data == expectation, LLH != 0)</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.likelihood_functions.barlowLLH">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.likelihood_functions.</span></span><span class="sig-name descname"><span class="pre">barlowLLH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unweighted_mc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/likelihood_functions.html#barlowLLH"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.likelihood_functions.barlowLLH" title="Link to this definition"></a></dt>
<dd><p>Barlow-Beeston log-likelihood (constant terms not omitted)
Link to paper: <a class="reference external" href="https://doi.org/10.1016/0010-4655(93)90005-W">https://doi.org/10.1016/0010-4655(93)90005-W</a>
– Input variables –
data = data histogram
mc = weighted MC histogram
unweighted_mc = unweighted MC histogream
weights = weight of each bin</p>
<p>– Output –
llh = LLH values in each bin</p>
<p>– Notes –
Shape of data, mc, unweighted_mc, weights and llh must be identical</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.likelihood_functions.poissonLLH">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.likelihood_functions.</span></span><span class="sig-name descname"><span class="pre">poissonLLH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/likelihood_functions.html#poissonLLH"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.likelihood_functions.poissonLLH" title="Link to this definition"></a></dt>
<dd><p>Standard poisson likelihood
– Input variables –
data = data histogram
mc = MC histogram</p>
<p>– Output –
LLH values in each bin</p>
<p>– Notes –
Shape of data, mc are identical</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.likelihood_functions.poisson_gamma">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.likelihood_functions.</span></span><span class="sig-name descname"><span class="pre">poisson_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_w2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/likelihood_functions.html#poisson_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.likelihood_functions.poisson_gamma" title="Link to this definition"></a></dt>
<dd><p>Log-likelihood based on the poisson-gamma mixture. This is a Poisson likelihood using a Gamma prior.
This implementation is based on the implementation of Austin Schneider (<a class="reference external" href="mailto:aschneider&#37;&#52;&#48;icecube&#46;wisc&#46;edu">aschneider<span>&#64;</span>icecube<span>&#46;</span>wisc<span>&#46;</span>edu</a>)
– Input variables –
data = data histogram
sum_w = MC histogram
sum_w2 = Uncertainty map (sum of weights squared in each bin)
a, b = hyperparameters of gamma prior for MC counts; default values of a = 1 and b = 0 corresponds to LEff (eq 3.16) <a class="reference external" href="https://doi.org/10.1007/JHEP06(2019)030">https://doi.org/10.1007/JHEP06(2019)030</a></p>
<blockquote>
<div><p>a = 0 and b = 0 corresponds to LMean (Table 2) <a class="reference external" href="https://doi.org/10.1007/JHEP06(2019)030">https://doi.org/10.1007/JHEP06(2019)030</a></p>
</div></blockquote>
<p>– Output –
llh = LLH values in each bin</p>
<p>– Notes –
Shape of data, sum_w, sum_w2 and llh are identical</p>
</dd></dl>

</section>
<section id="pisa-utils-llh-client-module">
<h2>pisa.utils.llh_client module<a class="headerlink" href="#pisa-utils-llh-client-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pisa.utils.llh_server">
<span id="pisa-utils-llh-server-module"></span><h2>pisa.utils.llh_server module<a class="headerlink" href="#module-pisa.utils.llh_server" title="Link to this heading"></a></h2>
<p>Server(s) for handling llh requests from a client: client passes free param
values, server sets these on its DistributionMaker, generates outputs, and
compares the resulting distributions against a reference template, returning
the llh value.</p>
<dl class="simple">
<dt>Code adapted from Dan Krause</dt><dd><p><a class="reference external" href="https://gist.github.com/dankrause/9607475">https://gist.github.com/dankrause/9607475</a></p>
</dd>
</dl>
<p>see <cite>__license__</cite>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.llh_server.fork_servers">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.llh_server.</span></span><span class="sig-name descname"><span class="pre">fork_servers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'9000'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/llh_server.html#fork_servers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.llh_server.fork_servers" title="Link to this definition"></a></dt>
<dd><p>Fork multiple servers for handling LLH requests. Objects are identically
configured, and ports used are sequential starting from <cite>port</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>str</em><em> or </em><em>iterable thereof</em>)</p></li>
<li><p><strong>ref</strong> (<em>str</em>)</p></li>
<li><p><strong>port</strong> (<em>str</em><em> or </em><em>int</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>num</strong> (<em>int</em><em>, </em><em>optional</em>) – Defaults to number of CPUs returned by <cite>multiple.cpu_count()</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.llh_server.main">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.llh_server.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\nServer(s)</span> <span class="pre">for</span> <span class="pre">handling</span> <span class="pre">llh</span> <span class="pre">requests</span> <span class="pre">from</span> <span class="pre">a</span> <span class="pre">client:</span> <span class="pre">client</span> <span class="pre">passes</span> <span class="pre">free</span> <span class="pre">param\nvalues,</span> <span class="pre">server</span> <span class="pre">sets</span> <span class="pre">these</span> <span class="pre">on</span> <span class="pre">its</span> <span class="pre">DistributionMaker,</span> <span class="pre">generates</span> <span class="pre">outputs,</span> <span class="pre">and\ncompares</span> <span class="pre">the</span> <span class="pre">resulting</span> <span class="pre">distributions</span> <span class="pre">against</span> <span class="pre">a</span> <span class="pre">reference</span> <span class="pre">template,</span> <span class="pre">returning\nthe</span> <span class="pre">llh</span> <span class="pre">value.\n\nCode</span> <span class="pre">adapted</span> <span class="pre">from</span> <span class="pre">Dan</span> <span class="pre">Krause\n</span>&#160; <span class="pre">https://gist.github.com/dankrause/9607475\nsee</span> <span class="pre">`__license__`.\n'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/llh_server.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.llh_server.main" title="Link to this definition"></a></dt>
<dd><p>Parse command line arguments</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.llh_server.receive_obj">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.llh_server.</span></span><span class="sig-name descname"><span class="pre">receive_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sock</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/llh_server.html#receive_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.llh_server.receive_obj" title="Link to this definition"></a></dt>
<dd><p>Receive an object from a socket. Payload is a pickle-encoded object, and
header (prefixing payload) is 4-byte int indicating length of the payload.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sock</strong> (<em>socket</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Unpickled Python object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.llh_server.send_obj">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.llh_server.</span></span><span class="sig-name descname"><span class="pre">send_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sock</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/llh_server.html#send_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.llh_server.send_obj" title="Link to this definition"></a></dt>
<dd><p>Send a Python object over a socket. Object is pickle-encoded as the
payload and sent preceded by a 4-byte header which indicates the number of
bytes of the payload.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sock</strong> (<em>socket</em>)</p></li>
<li><p><strong>obj</strong> (<em>pickle-able Python object</em>) – Object to send</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.llh_server.serve">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.llh_server.</span></span><span class="sig-name descname"><span class="pre">serve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'9000'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/llh_server.html#serve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.llh_server.serve" title="Link to this definition"></a></dt>
<dd><p>Instantiate PISA objects and run server for processing requests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>str</em><em> or </em><em>iterable thereof</em>) – Resource path(s) to pipeline config(s)</p></li>
<li><p><strong>ref</strong> (<em>str</em>) – Resource path to reference map</p></li>
<li><p><strong>port</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pisa.utils.log">
<span id="pisa-utils-log-module"></span><h2>pisa.utils.log module<a class="headerlink" href="#module-pisa.utils.log" title="Link to this heading"></a></h2>
<p>This module sets up the logging system by looking for a “logging.json”
configuration file. It will search (in this order) the local directory, $PISA
and finally the package resources. The loggers found in there will be lifted
to the module namespace.</p>
<p>Currently, we have three loggers
* logging: generic for what is going on  (typically: <cite>opening file x</cite> or</p>
<blockquote>
<div><p><cite>doing this now</cite> messages)</p>
</div></blockquote>
<ul class="simple">
<li><p>physics: for any physics output that might be interesting
(<cite>have x many events</cite>, <cite>the flux is …</cite>)</p></li>
<li><p>tprofile: for how much time it takes to run some step (in the format of
<cite>time : start bla</cite>, <cite>time : stop bla</cite>)</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.log.Levels">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.log.</span></span><span class="sig-name descname"><span class="pre">Levels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/log.html#Levels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.log.Levels" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">IntEnum</span></code></p>
<p>Logging levels / int values we use in PISA in <cite>set_verbosity</cite> (and
typically from the command line, where -v/-vv/-vvv/etc. are used)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.log.Levels.DEBUG">
<span class="sig-name descname"><span class="pre">DEBUG</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#pisa.utils.log.Levels.DEBUG" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.log.Levels.ERROR">
<span class="sig-name descname"><span class="pre">ERROR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1</span></em><a class="headerlink" href="#pisa.utils.log.Levels.ERROR" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.log.Levels.FATAL">
<span class="sig-name descname"><span class="pre">FATAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-2</span></em><a class="headerlink" href="#pisa.utils.log.Levels.FATAL" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.log.Levels.INFO">
<span class="sig-name descname"><span class="pre">INFO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#pisa.utils.log.Levels.INFO" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.log.Levels.TRACE">
<span class="sig-name descname"><span class="pre">TRACE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#pisa.utils.log.Levels.TRACE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.log.Levels.WARN">
<span class="sig-name descname"><span class="pre">WARN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pisa.utils.log.Levels.WARN" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.log.set_verbosity">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.log.</span></span><span class="sig-name descname"><span class="pre">set_verbosity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbosity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/log.html#set_verbosity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.log.set_verbosity" title="Link to this definition"></a></dt>
<dd><p>Set the verbosity level for the root logger Verbosity should be an
integer with the levels defined by <cite>pisa.utils.log.Levels</cite> enum.</p>
</dd></dl>

</section>
<section id="module-pisa.utils.matrix">
<span id="pisa-utils-matrix-module"></span><h2>pisa.utils.matrix module<a class="headerlink" href="#module-pisa.utils.matrix" title="Link to this heading"></a></h2>
<p>Utilities for performing some not-so-common matrix tasks.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.matrix.fronebius_nearest_psd">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">fronebius_nearest_psd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/matrix.html#fronebius_nearest_psd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.matrix.fronebius_nearest_psd" title="Link to this definition"></a></dt>
<dd><p>Find the positive semi-definite matrix closest to <cite>A</cite>.</p>
<p>The closeness to <cite>A</cite> is measured by the Fronebius norm. The matrix closest to <cite>A</cite>
by that measure is uniquely defined in <a class="footnote-reference brackets" href="#id23" id="id16" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>numpy.ndarray</em>) – Symmetric matrix</p></li>
<li><p><strong>return_distance</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return distance of the input matrix to the approximation as given in
theorem 2.1 in <a class="footnote-reference brackets" href="#id23" id="id17" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.
This can be compared to the actual Frobenius norm between the
input and output to verify the calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X</strong> – Positive semi-definite matrix approximating <cite>A</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is a modification of <a href="#id32"><span class="problematic" id="id18">[1]_</span></a>, which is a Python adaption of <a class="footnote-reference brackets" href="#id22" id="id19" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>, which
credits <a class="footnote-reference brackets" href="#id23" id="id20" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id21" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://gist.github.com/fasiha/fdb5cec2054e6f1c6ae35476045a0bbd">https://gist.github.com/fasiha/fdb5cec2054e6f1c6ae35476045a0bbd</a></p>
</aside>
<aside class="footnote brackets" id="id22" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id19">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.mathworks.com/matlabcentral/fileexchange/42885-nearestspd">https://www.mathworks.com/matlabcentral/fileexchange/42885-nearestspd</a></p>
</aside>
<aside class="footnote brackets" id="id23" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id16">1</a>,<a role="doc-backlink" href="#id17">2</a>,<a role="doc-backlink" href="#id20">3</a>)</span>
<p>N.J. Higham, “Computing a nearest symmetric positive semidefinite
matrix” (1988): <a class="reference external" href="https://doi.org/10.1016/0024-3795(88)90223-6">https://doi.org/10.1016/0024-3795(88)90223-6</a></p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.matrix.is_psd">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">is_psd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/matrix.html#is_psd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.matrix.is_psd" title="Link to this definition"></a></dt>
<dd><p>Test whether a matrix is positive semi-definite.</p>
<p>Test is done via attempted Cholesky decomposition as suggested in <a href="#id33"><span class="problematic" id="id24">[1]_</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>A</strong> (<em>numpy.ndarray</em>) – Symmetric matrix</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if <cite>A</cite> is positive semi-definite, else False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id25" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>N.J. Higham, “Computing a nearest symmetric positive semidefinite
matrix” (1988): <a class="reference external" href="https://doi.org/10.1016/0024-3795(88)90223-6">https://doi.org/10.1016/0024-3795(88)90223-6</a></p>
</aside>
</aside>
</dd></dl>

</section>
<section id="module-pisa.utils.mcSimRunSettings">
<span id="pisa-utils-mcsimrunsettings-module"></span><h2>pisa.utils.mcSimRunSettings module<a class="headerlink" href="#module-pisa.utils.mcSimRunSettings" title="Link to this heading"></a></h2>
<p>Handle Monte Carlo simulation run settings</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.mcSimRunSettings.</span></span><span class="sig-name descname"><span class="pre">DetMCSimRunsSettings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Handle Monte Carlo run settings for a detector (i.e., without specifying
which run as is required for the MCSimRunSettings object)</p>
<p>Since run is not specified at instantiation, method calls require the user
to specify a run ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_settings</strong> (<em>string</em><em> or </em><em>dict</em>)</p></li>
<li><p><strong>detector</strong> (<em>string</em><em> or </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings" title="pisa.utils.mcSimRunSettings.MCSimRunSettings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MCSimRunSettings</span></code></a></dt><dd><p>Same, but specifies a specific run at instantiation; see class docstring for specification of run_settings dict / JSON file</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.barnobarfract">
<span class="sig-name descname"><span class="pre">barnobarfract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">barnobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_particle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flav_or_flavint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings.barnobarfract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.barnobarfract" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.consistency_checks">
<span class="sig-name descname"><span class="pre">consistency_checks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flav</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings.consistency_checks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.consistency_checks" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_energy_range">
<span class="sig-name descname"><span class="pre">get_energy_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings.get_energy_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_energy_range" title="Link to this definition"></a></dt>
<dd><p>(min, max) energy in GeV</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_flavints">
<span class="sig-name descname"><span class="pre">get_flavints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings.get_flavints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_flavints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_flavs">
<span class="sig-name descname"><span class="pre">get_flavs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings.get_flavs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_flavs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_num_gen">
<span class="sig-name descname"><span class="pre">get_num_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">barnobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_particle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flav_or_flavint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_physical_fract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings.get_num_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_num_gen" title="Link to this definition"></a></dt>
<dd><p>Return the total number of events generated</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_spectral_index">
<span class="sig-name descname"><span class="pre">get_spectral_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings.get_spectral_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_spectral_index" title="Link to this definition"></a></dt>
<dd><p>Spectral index (positive number for negative powers of energy)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_xsec">
<span class="sig-name descname"><span class="pre">get_xsec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings.get_xsec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_xsec" title="Link to this definition"></a></dt>
<dd><p>Instantiated CrossSections object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_xsec_version">
<span class="sig-name descname"><span class="pre">get_xsec_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#DetMCSimRunsSettings.get_xsec_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.DetMCSimRunsSettings.get_xsec_version" title="Link to this definition"></a></dt>
<dd><p>Cross sectons version name used in generating the MC</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.mcSimRunSettings.</span></span><span class="sig-name descname"><span class="pre">MCSimRunSettings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Handle Monte Carlo run settings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_settings</strong> (<em>string</em><em> or </em><em>dict</em>)</p></li>
<li><p><strong>run</strong></p></li>
<li><p><strong>detector</strong> (<em>string</em><em> or </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>run_settings dictionary format (and same for corresponding JSON file, e.g.
resources/events/mc_sim_run_settings.json); example is for PINGU but should
generalize to DeepCore, etc. Note that a JSON file will use null and not
None.</p>
<p>(Also note that expressions for numerical values utilizing the Python/numpy
namespace are valid, e.g. “2*pi” will be evaluated within the code to its
decimal value.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>

  <span class="c1"># Specify the detector name, lower case</span>
  <span class="s2">&quot;pingu&quot;</span><span class="p">:</span> <span class="p">{</span>

    <span class="c1"># Monte Carlo run number for this detector</span>
    <span class="s2">&quot;388&quot;</span><span class="p">:</span> <span class="p">{</span>

      <span class="c1"># Version of geometry, lower-case. E.g., ic86 for IceCube/DeepCore</span>
      <span class="s2">&quot;geom&quot;</span><span class="p">:</span> <span class="s2">&quot;v36&quot;</span><span class="p">,</span>

      <span class="c1"># A straightforward way of computing aeff/veff/meff is to keep all</span>
      <span class="c1"># simulated events and compare the #analysis/#simulated. If all</span>
      <span class="c1"># simulated events are kept, then the filename containing these is</span>
      <span class="c1"># recorded here.</span>
      <span class="s2">&quot;all_gen_events_file&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>

      <span class="c1"># Max and min azimuth angle simulated (rad)</span>
      <span class="s2">&quot;azimuth_max&quot;</span><span class="p">:</span> <span class="s2">&quot;2*pi&quot;</span><span class="p">,</span>
      <span class="s2">&quot;azimuth_min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

      <span class="c1"># Max and min energy simulated (GeV)</span>
      <span class="s2">&quot;energy_max&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
      <span class="s2">&quot;energy_min&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

      <span class="c1"># GENIE simulates some un-physica events (interactions that will not</span>
      <span class="c1"># occur in nature). The number below was arrived at by Ken Clark, so</span>
      <span class="c1"># ask him for more info.</span>
      <span class="s2">&quot;physical_events_fract&quot;</span><span class="p">:</span> <span class="mf">0.8095</span><span class="p">,</span>

      <span class="c1"># GENIE has a prescale factor (TODO: generalize or eliminate for</span>
      <span class="c1"># other xsec?)</span>
      <span class="s2">&quot;genie_prescale_factor&quot;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>

      <span class="c1"># Neutrino flavors simulated</span>
      <span class="s2">&quot;flavints&quot;</span><span class="p">:</span> <span class="s2">&quot;nutau,nutaubar&quot;</span><span class="p">,</span>

      <span class="c1"># #nu / (#nu + #nubar) simulated</span>
      <span class="s2">&quot;nu_to_total_fract&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>

      <span class="c1"># Number of events simulated per I3 file</span>
      <span class="s2">&quot;num_events_per_file&quot;</span><span class="p">:</span> <span class="mi">250000</span><span class="p">,</span>

      <span class="c1"># Number of I3 files used</span>
      <span class="s2">&quot;num_i3_files&quot;</span><span class="p">:</span> <span class="mi">195</span><span class="p">,</span>

      <span class="c1"># Simulated spectral inde gamma; value of 1 =&gt; E*{-1}</span>
      <span class="s2">&quot;sim_spectral_index&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

      <span class="c1"># Version of neutrino/ice cross sections used for the simulation</span>
      <span class="s2">&quot;xsec_version&quot;</span><span class="p">:</span> <span class="s2">&quot;genie_2.6.4&quot;</span><span class="p">,</span>

      <span class="c1"># Max and min zenith angle simulated (rad)</span>
      <span class="s2">&quot;zenith_max&quot;</span><span class="p">:</span> <span class="s2">&quot;pi&quot;</span><span class="p">,</span>
      <span class="s2">&quot;zenith_min&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.barnobarfract">
<span class="sig-name descname"><span class="pre">barnobarfract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">barnobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_particle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flav_or_flavint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.barnobarfract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.barnobarfract" title="Link to this definition"></a></dt>
<dd><p>Fraction of events generated (either particles or antiparticles).</p>
<p>Specifying whether you want the fraction for particle or
antiparticle is done by specifying one (and only one) of the three
:param <cite>barnobar</cite>:
:param <cite>is_particle</cite> or <cite>flav_or_flavint</cite>:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>barnobar</strong> (<em>None</em><em> or </em><em>int</em>) – -1 for antiparticle, +1 for particle</p></li>
<li><p><strong>is_particle</strong> (<em>None</em><em> or </em><em>bool</em>) – True for particle, false for antiparticle</p></li>
<li><p><strong>flav_or_flavint</strong> (<em>None</em><em> or </em><em>convertible to NuFlav</em><em> or </em><a class="reference internal" href="#pisa.utils.flavInt.NuFlavInt" title="pisa.utils.flavInt.NuFlavInt"><em>NuFlavInt</em></a>) – Particle or antiparticles is determined from the flavor or flavint
passed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.consistency_checks">
<span class="sig-name descname"><span class="pre">consistency_checks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flav</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.consistency_checks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.consistency_checks" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.get_energy_range">
<span class="sig-name descname"><span class="pre">get_energy_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.get_energy_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.get_energy_range" title="Link to this definition"></a></dt>
<dd><p>(min, max) energy in GeV</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.get_flavints">
<span class="sig-name descname"><span class="pre">get_flavints</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.get_flavints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.get_flavints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.get_flavs">
<span class="sig-name descname"><span class="pre">get_flavs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.get_flavs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.get_flavs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.get_num_gen">
<span class="sig-name descname"><span class="pre">get_num_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">barnobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_particle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flav_or_flavint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_physical_fract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.get_num_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.get_num_gen" title="Link to this definition"></a></dt>
<dd><p>Return the number of events generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>barnobar</strong> (<em>None</em><em> or </em><em>int</em>) – -1 for antiparticle or +1 for particle</p></li>
<li><p><strong>is_particle</strong> (<em>None</em><em> or </em><em>bool</em>)</p></li>
<li><p><strong>flav_or_flavint</strong> (<em>None</em><em> or </em><em>convertible to NuFlav</em><em> or </em><a class="reference internal" href="#pisa.utils.flavInt.NuFlavInt" title="pisa.utils.flavInt.NuFlavInt"><em>NuFlavInt</em></a>) – If one of <cite>barnobar</cite>, <cite>is_particle</cite>, or <cite>flav_or_flavint</cite> is
specified, returns only the number of particles or antiparticles
generated. Otherwise (if none of those is specified), return the
total number of generated events.</p></li>
<li><p><strong>include_physical_fract</strong> (<em>bool</em>) – Whether to include the “GENIE physical fraction”, which accounts
for events that are generated but are un-physical and therefore
will never be detectable. These are removed to not penalize
detection efficiency.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.get_spectral_index">
<span class="sig-name descname"><span class="pre">get_spectral_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.get_spectral_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.get_spectral_index" title="Link to this definition"></a></dt>
<dd><p>Spectral index (positive number for negative powers of energy)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.get_xsec">
<span class="sig-name descname"><span class="pre">get_xsec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.get_xsec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.get_xsec" title="Link to this definition"></a></dt>
<dd><p>Instantiated CrossSections object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.get_xsec_version">
<span class="sig-name descname"><span class="pre">get_xsec_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.get_xsec_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.get_xsec_version" title="Link to this definition"></a></dt>
<dd><p>Cross sectons version name used in generating the MC</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.mcSimRunSettings.MCSimRunSettings.translate_source_dict">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">translate_source_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/mcSimRunSettings.html#MCSimRunSettings.translate_source_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.mcSimRunSettings.MCSimRunSettings.translate_source_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pisa.utils.numba_tools">
<span id="pisa-utils-numba-tools-module"></span><h2>pisa.utils.numba_tools module<a class="headerlink" href="#module-pisa.utils.numba_tools" title="Link to this heading"></a></h2>
<p>Numba tools</p>
<p>This is a colection of functions used for numba functions
that work for targets cpu as well as cuda</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.clear_matrix">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">clear_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#clear_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.clear_matrix" title="Link to this definition"></a></dt>
<dd><p>Zero out 2D matrix ..</p>
<p>A[i, j] = 0</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.conjugate">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">conjugate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#conjugate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.conjugate" title="Link to this definition"></a></dt>
<dd><p>B is the element-by-element conjugate of A ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">*</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>2d array</em>)</p></li>
<li><p><strong>B</strong> (<em>2d array</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.conjugate_transpose">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">conjugate_transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#conjugate_transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.conjugate_transpose" title="Link to this definition"></a></dt>
<dd><p>B is the conjugate (Hermitian) transpose of A ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">*</span>
</pre></div>
</div>
<p>A : 2d array of shape (M, N)
B : 2d array of shape (N, M)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.copy_matrix">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">copy_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#copy_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.copy_matrix" title="Link to this definition"></a></dt>
<dd><p>Copy elemnts of 2d array A to array B ..</p>
<p>B[i, j] = A[i, j]</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.ctype">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">ctype</span></span><a class="headerlink" href="#pisa.utils.numba_tools.ctype" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="pisa.html#pisa.complex128" title="numpy.complex128"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex128</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.cuda">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pisa.utils.numba_tools.cuda" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.cuda_copy">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">cuda_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#cuda_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.cuda_copy" title="Link to this definition"></a></dt>
<dd><p>Handle copying back device array</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.ftype">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">ftype</span></span><a class="headerlink" href="#pisa.utils.numba_tools.ftype" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="pisa.html#pisa.float64" title="numpy.float64"><code class="xref py py-class docutils literal notranslate"><span class="pre">float64</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.matrix_dot_matrix">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">matrix_dot_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#matrix_dot_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.matrix_dot_matrix" title="Link to this definition"></a></dt>
<dd><p>Dot-product of two 2d arrays ..</p>
<p>C = A * B</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.matrix_dot_vector">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">matrix_dot_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#matrix_dot_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.matrix_dot_vector" title="Link to this definition"></a></dt>
<dd><p>Dot-product of a 2d array and a vector ..</p>
<p>w = A * v</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.myjit">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">myjit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#myjit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.myjit" title="Link to this definition"></a></dt>
<dd><p>Decorator to assign the right jit for different targets
In case of non-cuda targets, all instances of <cite>cuda.local.array</cite>
are replaced by <cite>np.empty</cite>. This is a dirty fix, hopefully in the
near future numba will support numpy array allocation and this will
not be necessary anymore</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_nb_func</strong> – Refactored version of <cite>func</cite> but with <cite>cuda.local.array</cite> replaced by
<cite>np.empty</cite> if <cite>TARGET == “cpu”</cite>. For either TARGET, the returned
function will be callable within numba code for that target.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numba callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.test_clear_matrix">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">test_clear_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#test_clear_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.test_clear_matrix" title="Link to this definition"></a></dt>
<dd><p>Unit tests of <cite>clear_matrix</cite> and <cite>clear_matrix_guf</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.test_conjugate">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">test_conjugate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#test_conjugate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.test_conjugate" title="Link to this definition"></a></dt>
<dd><p>Unit tests of <cite>conjugate</cite> and <cite>conjugate_guf</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.test_conjugate_transpose">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">test_conjugate_transpose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#test_conjugate_transpose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.test_conjugate_transpose" title="Link to this definition"></a></dt>
<dd><p>Unit tests of <cite>conjugate_transpose</cite> and <cite>conjugate_transpose_guf</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.test_copy_matrix">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">test_copy_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#test_copy_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.test_copy_matrix" title="Link to this definition"></a></dt>
<dd><p>Unit tests of <cite>copy_matrix</cite> and <cite>copy_matrix_guf</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.test_matrix_dot_matrix">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">test_matrix_dot_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#test_matrix_dot_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.test_matrix_dot_matrix" title="Link to this definition"></a></dt>
<dd><p>Unit tests of <cite>matrix_dot_matrix</cite> and <cite>matrix_dot_matrix_guf</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.numba_tools.test_matrix_dot_vector">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.numba_tools.</span></span><span class="sig-name descname"><span class="pre">test_matrix_dot_vector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/numba_tools.html#test_matrix_dot_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.numba_tools.test_matrix_dot_vector" title="Link to this definition"></a></dt>
<dd><p>Unit tests of <cite>matrix_dot_vector</cite> and <cite>matrix_dot_vector_guf</cite></p>
</dd></dl>

</section>
<section id="module-pisa.utils.plotter">
<span id="pisa-utils-plotter-module"></span><h2>pisa.utils.plotter module<a class="headerlink" href="#module-pisa.utils.plotter" title="Link to this heading"></a></h2>
<p>Plotter class for doing plots easily</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.plotter.</span></span><span class="sig-name descname"><span class="pre">Plotter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#</span> <span class="pre">events'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'outside'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Plotting library for PISA <a href="#id26"><span class="problematic" id="id27">`</span></a>Map`s and <a href="#id28"><span class="problematic" id="id29">`</span></a>MapSet`s</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outdir</strong> (<em>str</em>) – output directory path</p></li>
<li><p><strong>stamp</strong> (<em>str</em>) – stamp to be put on every subplot, e.g. ‘Preliminary’,
‘DeepCore nutau’, etc.</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em> or </em><em>iterable</em><em> of </em><em>str</em>) – formats to be plotted, e.g. [‘pdf’, ‘png’]</p></li>
<li><p><strong>size</strong> (<em>(</em><em>int</em><em>, </em><em>int</em><em>)</em>) – canvas size (inches)</p></li>
<li><p><strong>log</strong> (<em>bool</em>) – logarithmic z-axis</p></li>
<li><p><strong>label</strong> (<em>str</em>) – z-axis label</p></li>
<li><p><strong>grid</strong> (<em>bool</em>) – plot grid</p></li>
<li><p><strong>ratio</strong> (<em>bool</em>) – add ratio plots in 1-d histos</p></li>
<li><p><strong>annotate</strong> (<em>bool</em>) – annotate counts per bin in 2-d histos</p></li>
<li><p><strong>symmetric</strong> (<em>bool</em>) – force symmetric extent of z-axis</p></li>
<li><p><strong>loc</strong> (<em>str</em>) – either ‘inside’ or ‘outside’, defining where to put axis titles</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.add_leg">
<span class="sig-name descname"><span class="pre">add_leg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.add_leg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.add_leg" title="Link to this definition"></a></dt>
<dd><p>initialize legend</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.add_stamp">
<span class="sig-name descname"><span class="pre">add_stamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.add_stamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.add_stamp" title="Link to this definition"></a></dt>
<dd><p>Add common stamp with text.</p>
<p>NOTE add_stamp cannot be used on a subplot that has been de-selected
and then re-selected. It will write over existing text.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.dump" title="Link to this definition"></a></dt>
<dd><p>dump figure to file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.init_fig">
<span class="sig-name descname"><span class="pre">init_fig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.init_fig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.init_fig" title="Link to this definition"></a></dt>
<dd><p>clear/initialize figure</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.next_color">
<span class="sig-name descname"><span class="pre">next_color</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.next_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.next_color" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_1d_all">
<span class="sig-name descname"><span class="pre">plot_1d_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_1d_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_1d_all" title="Link to this definition"></a></dt>
<dd><p>all one one canvas</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_1d_array">
<span class="sig-name descname"><span class="pre">plot_1d_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_1d_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_1d_array" title="Link to this definition"></a></dt>
<dd><p>plot 1d projections as an array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_1d_cmp">
<span class="sig-name descname"><span class="pre">plot_1d_cmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_sets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_1d_cmp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_1d_cmp" title="Link to this definition"></a></dt>
<dd><p>1d comparisons for two map_sets as projections</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_1d_projection">
<span class="sig-name descname"><span class="pre">plot_1d_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_1d_projection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_1d_projection" title="Link to this definition"></a></dt>
<dd><p>plot map projected on plot_axis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_1d_ratio">
<span class="sig-name descname"><span class="pre">plot_1d_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_1d_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_1d_ratio" title="Link to this definition"></a></dt>
<dd><p>make a ratio plot for a 1d projection</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_1d_single">
<span class="sig-name descname"><span class="pre">plot_1d_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_1d_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_1d_single" title="Link to this definition"></a></dt>
<dd><p>plot all maps in individual plots</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_1d_slices_array">
<span class="sig-name descname"><span class="pre">plot_1d_slices_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_sets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_1d_slices_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_1d_slices_array" title="Link to this definition"></a></dt>
<dd><p>plot 1d projections as an array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_1d_stack">
<span class="sig-name descname"><span class="pre">plot_1d_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_1d_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_1d_stack" title="Link to this definition"></a></dt>
<dd><p>all maps stacked on top of each other</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_2d_array">
<span class="sig-name descname"><span class="pre">plot_2d_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_2d_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_2d_array" title="Link to this definition"></a></dt>
<dd><p>plot all maps in a single plot</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_2d_map">
<span class="sig-name descname"><span class="pre">plot_2d_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_2d_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_2d_map" title="Link to this definition"></a></dt>
<dd><p>plot map on current axis in 2d</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_2d_single">
<span class="sig-name descname"><span class="pre">plot_2d_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_set</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_2d_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_2d_single" title="Link to this definition"></a></dt>
<dd><p>plot all maps in individual plots</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_array">
<span class="sig-name descname"><span class="pre">plot_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_array" title="Link to this definition"></a></dt>
<dd><p>wrapper funtion to exccute plotting function fun for every map in a
set distributed over a grid</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.plot_xsec">
<span class="sig-name descname"><span class="pre">plot_xsec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.plot_xsec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.plot_xsec" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.project_1d">
<span class="sig-name descname"><span class="pre">project_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.project_1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.project_1d" title="Link to this definition"></a></dt>
<dd><p>sum up a map along all axes except plot_axis</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.reset_colors">
<span class="sig-name descname"><span class="pre">reset_colors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.reset_colors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.reset_colors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.plotter.Plotter.slices_array">
<span class="sig-name descname"><span class="pre">slices_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_sets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/plotter.html#Plotter.slices_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.plotter.Plotter.slices_array" title="Link to this definition"></a></dt>
<dd><p>plot map_set in array using a function fun</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pisa.utils.profiler">
<span id="pisa-utils-profiler-module"></span><h2>pisa.utils.profiler module<a class="headerlink" href="#module-pisa.utils.profiler" title="Link to this heading"></a></h2>
<p>Tools for profiling code</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.profiler.line_profile">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.profiler.</span></span><span class="sig-name descname"><span class="pre">line_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/profiler.html#line_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.profiler.line_profile" title="Link to this definition"></a></dt>
<dd><p>Use as <cite>&#64;line_profile</cite> decorator for a function or class method to log
how long each line in the function/method takes to run.</p>
<p>Note that timings can be skewed by overhead from the line_profiler module,
which is used as the core timing mechanism for this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – Function or method to be profiled</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_func</strong> – New version of <cite>func</cite> that is callable just like <cite>func</cite> but that logs
the time spent in each line of code in <cite>func</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.profiler.profile">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.profiler.</span></span><span class="sig-name descname"><span class="pre">profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/profiler.html#profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.profiler.profile" title="Link to this definition"></a></dt>
<dd><p>Use as <cite>&#64;profile</cite> decorator for a function or class method to log the
time that it takes to complete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – Function or method to profile</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_func</strong> – New version of <cite>func</cite> that is callable just like <cite>func</cite> but that logs
the total time spent in <cite>func</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.profiler.test_line_profile">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.profiler.</span></span><span class="sig-name descname"><span class="pre">test_line_profile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/profiler.html#test_line_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.profiler.test_line_profile" title="Link to this definition"></a></dt>
<dd><p>Unit tests for <cite>line_profile</cite> functional (decorator)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.profiler.test_profile">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.profiler.</span></span><span class="sig-name descname"><span class="pre">test_profile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/profiler.html#test_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.profiler.test_profile" title="Link to this definition"></a></dt>
<dd><p>Unit tests for <cite>profile</cite> functional (decorator)</p>
</dd></dl>

</section>
<section id="module-pisa.utils.pull_method">
<span id="pisa-utils-pull-method-module"></span><h2>pisa.utils.pull_method module<a class="headerlink" href="#module-pisa.utils.pull_method" title="Link to this heading"></a></h2>
<p>Pull method tools.</p>
</section>
<section id="module-pisa.utils.random_numbers">
<span id="pisa-utils-random-numbers-module"></span><h2>pisa.utils.random_numbers module<a class="headerlink" href="#module-pisa.utils.random_numbers" title="Link to this heading"></a></h2>
<p>Utilities to handle random numbers needed by PISA in a consistent and
reproducible manner.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.random_numbers.get_random_state">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.random_numbers.</span></span><span class="sig-name descname"><span class="pre">get_random_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">random_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jumpahead</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/random_numbers.html#get_random_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.random_numbers.get_random_state" title="Link to this definition"></a></dt>
<dd><p>Derive a <cite>numpy.random.RandomState</cite> object (usable to generate random
numbers and distributions) from a flexible specification..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>random_state</strong> (<em>None</em><em>, </em><em>RandomState</em><em>, </em><em>string</em><em>, </em><em>int</em><em>, </em><em>state vector</em><em>, or </em><em>seq</em><em> of </em><em>int</em>) – <ul class="simple">
<li><p>If instantiated RandomState object is passed, it is used directly</p></li>
<li><p>If string : must be either ‘rand’ or ‘random’; random state is
instantiated at random from either /dev/urandom or (if that is not
present) the clock. This creates an irreproducibly-random number.</p></li>
<li><p>If int or sequence of lenth one: This is used as the <cite>seed</cite> value;
must be in [0, 2**32).</p></li>
<li><p>If sequence of two integers: first must be in [0, 32768): 15
most-significant bits. Second must be in [0, 131072): 17
least-significant bits.</p></li>
<li><p>If sequence of three integers: first must be in [0, 4): 2
most-significant bits. Second must be in [0, 8192): next 13
(less-significant) bits. Third must be in [0, 131072): 17
least-significant bits.</p></li>
<li><p>If a “state vector” (sequence of length five usable by
<cite>numpy.random.RandomState.set_state</cite>), set the random state using
this method.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>random_state</strong> – Object callable like <cite>numpy.random</cite> (e.g. <cite>random_state.rand((10,10))</cite>),
but with __exclusively <a href="#id30"><span class="problematic" id="id31">local__</span></a> state (whereas <cite>numpy.random</cite> has global
state).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.random.RandomState</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.random_numbers.test_get_random_state">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.random_numbers.</span></span><span class="sig-name descname"><span class="pre">test_get_random_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/random_numbers.html#test_get_random_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.random_numbers.test_get_random_state" title="Link to this definition"></a></dt>
<dd><p>Unit tests for get_random_state function</p>
</dd></dl>

</section>
<section id="module-pisa.utils.resources">
<span id="pisa-utils-resources-module"></span><h2>pisa.utils.resources module<a class="headerlink" href="#module-pisa.utils.resources" title="Link to this heading"></a></h2>
<p>Tools to obtain resource files needed for PISA, whether the resource is located
in the filesystem or with the installed PISA package.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.resources.find_path">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.resources.</span></span><span class="sig-name descname"><span class="pre">find_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/resources.html#find_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.resources.find_path" title="Link to this definition"></a></dt>
<dd><p>Find a file or directory in the filesystem (i.e., something that the
operating system can locate, as opposed to Python package resources, which
can be located within a package and therefore hidden from the filesystem).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pathspec</strong> (<em>string</em>)</p></li>
<li><p><strong>fail</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None (if not found) or string (absolute path to file or dir if found)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.resources.find_resource">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.resources.</span></span><span class="sig-name descname"><span class="pre">find_resource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/resources.html#find_resource"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.resources.find_resource" title="Link to this definition"></a></dt>
<dd><p>Try to find a resource (file or directory).</p>
<p>First check if <cite>resource</cite> is an absolute path, then check relative to
the paths specified by the PISA_RESOURCES environment variable (if it is
defined). Otherwise, look in the resources directory of the PISA
installation.</p>
<p>Note that the PISA_RESOURCES environment variable can contain multiple
paths, each separated by a colon. Due to using colons as separators,
however, the paths themselves can <em>not</em> contain colons.</p>
<p>Note also if PISA is packaged as archive distribution (e.g. zipped egg),
this method extracts the resource (if directory, the entire contents are
extracted) to a temporary cache directory. Therefore, it is preferable to
use the <cite>open_resource</cite> method directly, and avoid this method if possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource</strong> (<em>str</em>) – Resource path; can be path relative to CWD, path relative to
PISA_RESOURCES environment variable (if defined), or a package resource
location relative to the <cite>pisa_examples/resources</cite> sub-directory. Within
each path specified in PISA_RESOURCES and within the
<cite>pisa_examples/resources</cite> dir, the sub-directories ‘data’, ‘scripts’,
and ‘settings’ are checked for <cite>resource</cite> _before_ the base directories
are checked. Note that the <strong>first</strong> result found is returned.</p></li>
<li><p><strong>fail</strong> (<em>bool</em>) – If True, raise IOError if resource not found
If False, return None if resource not found</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>String if <cite>resource</cite> is found (relative path to the file or directory); if</p></li>
<li><p>not found and <cite>fail</cite> is False, returns None.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>IOError if resource is not found and fail is True.</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.resources.open_resource">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.resources.</span></span><span class="sig-name descname"><span class="pre">open_resource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/resources.html#open_resource"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.resources.open_resource" title="Link to this definition"></a></dt>
<dd><p>Find the resource file (see find_resource), open it, and return a file
handle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource</strong> (<em>str</em>) – Resource path; can be path relative to CWD, path relative to
PISA_RESOURCES environment variable (if defined), or a package resource
location relative to PISA’s <cite>pisa_examples/resources</cite> sub-directory.
Within each path specified in PISA_RESOURCES and within the
<cite>pisa_examples/resources</cite> dir, the sub-directories ‘data’, ‘scripts’,
and ‘settings’ are checked for <cite>resource</cite> _before_ the base directories
are checked. Note that the <strong>first</strong> result found is returned.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – ‘r’, ‘w’, or ‘rw’; only ‘r’ is valid for package resources (as these
cannot be written)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>binary stream object (which behaves identically to a file object)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pisa.utils.resources.find_resource" title="pisa.utils.resources.find_resource"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_resource</span></code></a></dt><dd><p>Locate a file or directory (in fileystem) or a package resource</p>
</dd>
<dt><a class="reference internal" href="#pisa.utils.resources.find_path" title="pisa.utils.resources.find_path"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_path</span></code></a></dt><dd><p>Locate a file or directory in the filesystem Open a (file) package resource and return stream object.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>See help for pkg_resources module / resource_stream method for more details
on handling of package resources.</p>
</dd></dl>

</section>
<section id="module-pisa.utils.spline">
<span id="pisa-utils-spline-module"></span><h2>pisa.utils.spline module<a class="headerlink" href="#module-pisa.utils.spline" title="Link to this heading"></a></h2>
<p>Classes to store and handle the evaluation of splines.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.spline.</span></span><span class="sig-name descname"><span class="pre">CombinedSpline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inSpline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pisa.utils.flavInt.FlavIntData" title="pisa.utils.flavInt.FlavIntData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlavIntData</span></code></a></p>
<p>Contained class for operating on Spline objects for various neutrino
flavours.</p>
<p>Inherits from FlavIntData object. Provides methods to allow
evaluation of the splines for all neutrino flavours.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inSpline</strong> (<a class="reference internal" href="#pisa.utils.spline.Spline" title="pisa.utils.spline.Spline"><em>Spline</em></a><em> or </em><em>tuple</em><em> of </em><a class="reference internal" href="#pisa.utils.spline.Spline" title="pisa.utils.spline.Spline"><em>Spline</em></a>) – Spline objects with <cite>name</cite> entry corresponding to a neutrino flavour
<cite>nue</cite>, <cite>numu</cite>, <cite>nuebar</cite>, <cite>numubar</cite> and also corresponding to an
interaction type <cite>cc</cite> and <cite>nc</cite> if the flag <cite>interactions</cite> is True.</p></li>
<li><p><strong>interactions</strong> (<em>Bool</em>) – Default = True
Flag to specifiy whether to store flavours or flavour+interaction
signatures.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.compute_integrated_maps">
<span class="sig-name descname"><span class="pre">compute_integrated_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.compute_integrated_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.compute_integrated_maps" title="Link to this definition"></a></dt>
<dd><p>Compute the map of spline values for a given signature integrated
over the input binning, then store it internally.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.compute_maps">
<span class="sig-name descname"><span class="pre">compute_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.compute_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.compute_maps" title="Link to this definition"></a></dt>
<dd><p>Compute the map of spline values for a given signature and binning,
then store it internally.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.get_integrated_map">
<span class="sig-name descname"><span class="pre">get_integrated_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.get_integrated_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.get_integrated_map" title="Link to this definition"></a></dt>
<dd><p>Return a map of spline values for a given signature integrated
over the input binning.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.get_map">
<span class="sig-name descname"><span class="pre">get_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.get_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.get_map" title="Link to this definition"></a></dt>
<dd><p>Return a map of spline values for a given signature and
binning.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.get_spline">
<span class="sig-name descname"><span class="pre">get_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.get_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.get_spline" title="Link to this definition"></a></dt>
<dd><p>Return the spline of a given signature and bins.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.reset" title="Link to this definition"></a></dt>
<dd><p>Reset the flux maps to the original input maps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.return_mapset">
<span class="sig-name descname"><span class="pre">return_mapset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.return_mapset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.return_mapset" title="Link to this definition"></a></dt>
<dd><p>Return a MapSet of stored spline maps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.scale_map">
<span class="sig-name descname"><span class="pre">scale_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.scale_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.scale_map" title="Link to this definition"></a></dt>
<dd><p>Scale a specific spline map by an input value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.scale_maps">
<span class="sig-name descname"><span class="pre">scale_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.scale_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.scale_maps" title="Link to this definition"></a></dt>
<dd><p>Scale the stored spline maps by an input value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.CombinedSpline.validate_spline">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#CombinedSpline.validate_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.CombinedSpline.validate_spline" title="Link to this definition"></a></dt>
<dd><p>Validate spline data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pisa.utils.spline.Spline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pisa.utils.spline.</span></span><span class="sig-name descname"><span class="pre">Spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_spl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_spl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#Spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.Spline" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Encapsulation of spline evaluation and other operations.</p>
<p>Provides methods to evaluate the spline object over a given binning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – Name for the spline object. Used to identify the object.</p></li>
<li><p><strong>tex</strong> (<em>None</em><em> or </em><em>string</em>) – TeX string that can be used for e.g. plotting.</p></li>
<li><p><strong>spline</strong> – Splines used for evaluation.</p></li>
<li><p><strong>eval_spl</strong> (<em>function</em>) – Function prescribing how to obtain values for the input spline object
from a given binning.</p></li>
<li><p><strong>validate_spl</strong> (<em>function</em>) – Function performing validation test on a given binning used to evaluate
the spline.</p></li>
<li><p><strong>hash</strong> (<em>None</em><em>, or </em><em>immutable object</em><em> (</em><em>typically an integer</em><em>)</em>) – Hash value to attach to the spline.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.Spline.get_integrated_map">
<span class="sig-name descname"><span class="pre">get_integrated_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#Spline.get_integrated_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.Spline.get_integrated_map" title="Link to this definition"></a></dt>
<dd><p>Get the spline map integrated over the input binning values
in output units specified by <cite>bw_units</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pisa.utils.spline.Spline.get_map">
<span class="sig-name descname"><span class="pre">get_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline.html#Spline.get_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline.Spline.get_map" title="Link to this definition"></a></dt>
<dd><p>Return a map of the spline evaluated at the centers of the
given binning.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.spline.Spline.hash">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hash</span></span><a class="headerlink" href="#pisa.utils.spline.Spline.hash" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.spline.Spline.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#pisa.utils.spline.Spline.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.spline.Spline.spline">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spline</span></span><a class="headerlink" href="#pisa.utils.spline.Spline.spline" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pisa.utils.spline.Spline.tex">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tex</span></span><a class="headerlink" href="#pisa.utils.spline.Spline.tex" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pisa.utils.spline_smooth">
<span id="pisa-utils-spline-smooth-module"></span><h2>pisa.utils.spline_smooth module<a class="headerlink" href="#module-pisa.utils.spline_smooth" title="Link to this heading"></a></h2>
<p>Smooth an array by splining it and resampling from the spline</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.spline_smooth.spline_smooth">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.spline_smooth.</span></span><span class="sig-name descname"><span class="pre">spline_smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spline_binning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_binning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/spline_smooth.html#spline_smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.spline_smooth.spline_smooth" title="Link to this definition"></a></dt>
<dd><p>Fuction for spline-smoothing arrays</p>
<p>It is smoothing in slices along one axis, assuming 2d arrays
The smoothing is done by splines</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>2d-array</em>) – array to be smoothed</p></li>
<li><p><strong>spline_binning</strong> (<a class="reference internal" href="pisa.core.html#pisa.core.binning.OneDimBinning" title="pisa.core.binning.OneDimBinning"><em>OneDimBinning</em></a>) – Binning of axis on which to construct the spline
Must corrspond to the array dimension</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – Index of the axis along which to smooth</p></li>
<li><p><strong>eval_binning</strong> (<a class="reference internal" href="pisa.core.html#pisa.core.binning.OneDimBinning" title="pisa.core.binning.OneDimBinning"><em>OneDimBinning</em></a>) – Binning on which to evaluate the constructed spline</p></li>
<li><p><strong>smooth_factor</strong> (<em>float</em>) – smoothing factor for spline</p></li>
<li><p><strong>k</strong> (<em>int</em>) – spline degree</p></li>
<li><p><strong>errors</strong> (<em>2d-array</em><em> or </em><em>None</em>) – uncertainties on the array</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>could be expanded to nd arrays to generalize it</p>
</dd></dl>

</section>
<section id="module-pisa.utils.stats">
<span id="pisa-utils-stats-module"></span><h2>pisa.utils.stats module<a class="headerlink" href="#module-pisa.utils.stats" title="Link to this heading"></a></h2>
<p>Statistical functions</p>
<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.stats.ALL_METRICS">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">ALL_METRICS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['llh',</span> <span class="pre">'conv_llh',</span> <span class="pre">'barlow_llh',</span> <span class="pre">'mcllh_mean',</span> <span class="pre">'mcllh_eff',</span> <span class="pre">'generalized_poisson_llh',</span> <span class="pre">'chi2',</span> <span class="pre">'mod_chi2',</span> <span class="pre">'correct_chi2',</span> <span class="pre">'weighted_chi2']</span></em><a class="headerlink" href="#pisa.utils.stats.ALL_METRICS" title="Link to this definition"></a></dt>
<dd><p>All metrics defined</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.stats.CHI2_METRICS">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">CHI2_METRICS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['chi2',</span> <span class="pre">'mod_chi2',</span> <span class="pre">'correct_chi2',</span> <span class="pre">'weighted_chi2']</span></em><a class="headerlink" href="#pisa.utils.stats.CHI2_METRICS" title="Link to this definition"></a></dt>
<dd><p>Metrics defined that result in measures of chi squared</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.stats.LLH_METRICS">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">LLH_METRICS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['llh',</span> <span class="pre">'conv_llh',</span> <span class="pre">'barlow_llh',</span> <span class="pre">'mcllh_mean',</span> <span class="pre">'mcllh_eff',</span> <span class="pre">'generalized_poisson_llh']</span></em><a class="headerlink" href="#pisa.utils.stats.LLH_METRICS" title="Link to this definition"></a></dt>
<dd><p>Metrics defined that result in measures of log likelihood</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pisa.utils.stats.SMALL_POS">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">SMALL_POS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-10</span></em><a class="headerlink" href="#pisa.utils.stats.SMALL_POS" title="Link to this definition"></a></dt>
<dd><p>A small positive number with which to replace numbers smaller than it</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.barlow_llh">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">barlow_llh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#barlow_llh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.barlow_llh" title="Link to this definition"></a></dt>
<dd><p>Compute the Barlow LLH taking into account finite statistics.
The likelihood is described in this paper: <a class="reference external" href="https://doi.org/10.1016/0010-4655(93)90005-W">https://doi.org/10.1016/0010-4655(93)90005-W</a>
:param actual_values:
:type actual_values: numpy.ndarrays of same shape
:param expected_values:
:type expected_values: numpy.ndarrays of same shape</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>barlow_llh</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.chi2">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#chi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.chi2" title="Link to this definition"></a></dt>
<dd><p>Compute the chi-square between each value in <cite>actual_values</cite> and
<cite>expected_values</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actual_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
<li><p><strong>expected_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>chi2</strong> – chi-squared values corresponding to each pair of elements in the inputs</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray of same shape as inputs</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uncertainties are not propagated through this calculation.</p></li>
<li><p>Values in expectation are clipped to the range [SMALL_POS, inf] prior to
the calculation to avoid infinities due to the divide function.</p></li>
<li><p>actual_values are allowed to be = 0, since they don’t com up in the denominator</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.conv_llh">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">conv_llh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#conv_llh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.conv_llh" title="Link to this definition"></a></dt>
<dd><p>Compute the convolution llh using the uncertainty on the expected values
to smear out the poisson PDFs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actual_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
<li><p><strong>expected_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>conv_llh</strong> (<em>numpy.ndarray of same shape as the inputs</em>)</p></li>
<li><p>conv_llh corresponding to each pair of elements in <cite>actual_values</cite> and</p></li>
<li><p><cite>expected_values</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.conv_poisson">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">conv_poisson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#conv_poisson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.conv_poisson" title="Link to this definition"></a></dt>
<dd><p>Poisson pdf</p>
<div class="math notranslate nohighlight">
\[p(k,l) = l^k \cdot e^{-l}/k!\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>float</em>)</p></li>
<li><p><strong>l</strong> (<em>float</em>)</p></li>
<li><p><strong>s</strong> (<em>float</em>) – sigma for smearing term (= the uncertainty to be accounted for)</p></li>
<li><p><strong>nsigma</strong> (<em>int</em>) – The ange in sigmas over which to do the convolution, 3 sigmas is &gt; 99%,
so should be enough</p></li>
<li><p><strong>steps</strong> (<em>int</em>) – Number of steps to do the intergration in (actual steps are 2*steps + 1,
so this is the steps to each side of the gaussian smearing term)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>convoluted poissson likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.correct_chi2">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">correct_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#correct_chi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.correct_chi2" title="Link to this definition"></a></dt>
<dd><p>Compute the chi-square value taking into account uncertainty terms
(incl. e.g. finite stats) and their changes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actual_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
<li><p><strong>expected_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>m_chi2</strong> – Modified chi-squared values corresponding to each pair of elements in
the inputs</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray of same shape as inputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.generalized_poisson_llh">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">generalized_poisson_llh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#generalized_poisson_llh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.generalized_poisson_llh" title="Link to this definition"></a></dt>
<dd><p>Compute the generalized Poisson likelihood as formulated in <a class="reference external" href="https://arxiv.org/abs/1902.08831">https://arxiv.org/abs/1902.08831</a></p>
<p>Note that unlike the other likelihood functions, expected_values
is expected to be a ditribution maker</p>
<section id="inputs">
<h3>inputs:<a class="headerlink" href="#inputs" title="Link to this heading"></a></h3>
<p>actual_values: flattened hist of a Map object</p>
<p>expected_values: OrderedDict of MapSets</p>
<p>empty_bins: None, list or np.ndarray (list the bin indices that are empty)</p>
</section>
<section id="returns">
<h3>returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<p>llh_per_bin : bin-wise llh values, in a numpy array</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.llh">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">llh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#llh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.llh" title="Link to this definition"></a></dt>
<dd><p>Compute the log-likelihoods (llh) that each count in <cite>actual_values</cite>
came from the the corresponding expected value in <cite>expected_values</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actual_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
<li><p><strong>expected_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>llh</strong> – llh corresponding to each pair of elements in <cite>actual_values</cite> and
<cite>expected_values</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray of same shape as the inputs</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uncertainties are not propagated through this calculation.</p></li>
<li><p>Values in <cite>expected_values</cite> are clipped to the range [SMALL_POS, inf]
prior to the calculation to avoid infinities due to the log function.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.log_poisson">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">log_poisson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#log_poisson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.log_poisson" title="Link to this definition"></a></dt>
<dd><p>Calculate the log of a poisson pdf</p>
<div class="math notranslate nohighlight">
\[p(k,l) = \log\left( l^k \cdot e^{-l}/k! \right)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>float</em>)</p></li>
<li><p><strong>l</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>log of poisson</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.log_smear">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">log_smear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#log_smear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.log_smear" title="Link to this definition"></a></dt>
<dd><p>Calculate the log of a normal pdf</p>
<div class="math notranslate nohighlight">
\[p(x, \sigma) = \log\left( (\sigma \sqrt{2\pi})^{-1} \exp( -x^2 / 2\sigma^2 ) \right)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>)</p></li>
<li><p><strong>sigma</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>log of gaussian</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.maperror_logmsg">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">maperror_logmsg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#maperror_logmsg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.maperror_logmsg" title="Link to this definition"></a></dt>
<dd><p>Create message with thorough info about a map for logging purposes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.mcllh_eff">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">mcllh_eff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#mcllh_eff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.mcllh_eff" title="Link to this definition"></a></dt>
<dd><p>Compute the log-likelihood (llh) based on eq. 3.16 - <a class="reference external" href="https://doi.org/10.1007/JHEP06(2019)030">https://doi.org/10.1007/JHEP06(2019)030</a>
accounting for finite MC statistics.
This is the most recommended likelihood in the paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actual_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
<li><p><strong>expected_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>llh</strong> – llh corresponding to each pair of elements in <cite>actual_values</cite> and
<cite>expected_values</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray of same shape as the inputs</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.mcllh_mean">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">mcllh_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#mcllh_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.mcllh_mean" title="Link to this definition"></a></dt>
<dd><p>Compute the log-likelihood (llh) based on LMean in table 2 - <a class="reference external" href="https://doi.org/10.1007/JHEP06(2019)030">https://doi.org/10.1007/JHEP06(2019)030</a>
accounting for finite MC statistics.
This is the second most recommended likelihood in the paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actual_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
<li><p><strong>expected_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>llh</strong> – llh corresponding to each pair of elements in <cite>actual_values</cite> and
<cite>expected_values</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray of same shape as the inputs</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.mod_chi2">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">mod_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#mod_chi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.mod_chi2" title="Link to this definition"></a></dt>
<dd><p>Compute the chi-square value taking into account uncertainty terms
(incl. e.g. finite stats)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actual_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
<li><p><strong>expected_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>m_chi2</strong> – Modified chi-squared values corresponding to each pair of elements in
the inputs</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray of same shape as inputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.norm_conv_poisson">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">norm_conv_poisson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#norm_conv_poisson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.norm_conv_poisson" title="Link to this definition"></a></dt>
<dd><p>Convoluted poisson likelihood normalized so that the value at k=l
(asimov) does not change</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>float</em>)</p></li>
<li><p><strong>l</strong> (<em>float</em>)</p></li>
<li><p><strong>s</strong> (<em>float</em>) – sigma for smearing term (= the uncertainty to be accounted for)</p></li>
<li><p><strong>nsigma</strong> (<em>int</em>) – The range in sigmas over which to do the convolution, 3 sigmas is &gt;
99%, so should be enough</p></li>
<li><p><strong>steps</strong> (<em>int</em>) – Number of steps to do the intergration in (actual steps are 2*steps + 1,
so this is the steps to each side of the gaussian smearing term)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convoluted poisson likelihood normalized so that the value at k=l
(asimov) does not change</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>likelihood</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.stats.signed_sqrt_mod_chi2">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.stats.</span></span><span class="sig-name descname"><span class="pre">signed_sqrt_mod_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/stats.html#signed_sqrt_mod_chi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.stats.signed_sqrt_mod_chi2" title="Link to this definition"></a></dt>
<dd><p>Compute a (signed) pull value taking into account uncertainty terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actual_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
<li><p><strong>expected_values</strong> (<em>numpy.ndarrays</em><em> of </em><em>same shape</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>m_pull</strong> – Pull values corresponding to each pair of elements in
the inputs</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray of same shape as inputs</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pisa.utils.tests">
<span id="pisa-utils-tests-module"></span><h2>pisa.utils.tests module<a class="headerlink" href="#module-pisa.utils.tests" title="Link to this heading"></a></h2>
<p>Functions to help compare and plot differences between PISA 2 and PISA 3 maps</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.baseplot">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">baseplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clabel=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evtrate=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap=&lt;matplotlib.colors.LinearSegmentedColormap</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#baseplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.baseplot" title="Link to this definition"></a></dt>
<dd><p>Simple plotting of a 2D histogram (map)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.baseplot2">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">baseplot2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evtrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#baseplot2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.baseplot2" title="Link to this definition"></a></dt>
<dd><p>Simple plotting of a 2D map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> (<a class="reference internal" href="pisa.core.html#pisa.core.map.Map" title="pisa.core.map.Map"><em>Map</em></a>)</p></li>
<li><p><strong>title</strong> (<em>str</em>)</p></li>
<li><p><strong>ax</strong> (<em>axis</em>)</p></li>
<li><p><strong>symm</strong> (<em>bool</em>)</p></li>
<li><p><strong>evtrate</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ax, pcmesh, cbar</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.check_agreement">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">check_agreement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">testname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#check_agreement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.check_agreement" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.make_delta_map">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">make_delta_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#make_delta_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.make_delta_map" title="Link to this definition"></a></dt>
<dd><p>Get the difference between two PISA 2 style maps (amap-bmap) and return
as another PISA 2 style map.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.make_ratio_map">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">make_ratio_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#make_ratio_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.make_ratio_map" title="Link to this definition"></a></dt>
<dd><p>Get the ratio of two PISA 2 style maps (amap/bmap) and return as another
PISA 2 style map.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.order">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.order" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.order_str">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">order_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#order_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.order_str" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.pisa2_map_to_pisa3_map">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">pisa2_map_to_pisa3_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pisa2_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebins_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ebins'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">czbins_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'czbins'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_lin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#pisa2_map_to_pisa3_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.pisa2_map_to_pisa3_map" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.plot_cmp">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">plot_cmp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#plot_cmp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.plot_cmp" title="Link to this definition"></a></dt>
<dd><p>Plot comparisons between two (identically-binned) maps or map sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new</strong> (<a class="reference internal" href="pisa.core.html#pisa.core.map.Map" title="pisa.core.map.Map"><em>Map</em></a><em> or </em><a class="reference internal" href="pisa.core.html#pisa.core.map.MapSet" title="pisa.core.map.MapSet"><em>MapSet</em></a>)</p></li>
<li><p><strong>ref</strong> (<a class="reference internal" href="pisa.core.html#pisa.core.map.Map" title="pisa.core.map.Map"><em>Map</em></a><em> or </em><a class="reference internal" href="pisa.core.html#pisa.core.map.MapSet" title="pisa.core.map.MapSet"><em>MapSet</em></a>)</p></li>
<li><p><strong>new_label</strong> (<em>str</em>)</p></li>
<li><p><strong>ref_label</strong> (<em>str</em>)</p></li>
<li><p><strong>plot_label</strong> (<em>str</em>)</p></li>
<li><p><strong>file_label</strong> (<em>str</em>)</p></li>
<li><p><strong>outdir</strong> (<em>str</em>)</p></li>
<li><p><strong>ftype</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.plot_comparisons">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">plot_comparisons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_abv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_abv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">texname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stagename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">servicename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shorttitles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#plot_comparisons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.plot_comparisons" title="Link to this definition"></a></dt>
<dd><p>Plot comparisons between two identically-binned PISA 2 style maps</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.plot_map_comparisons">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">plot_map_comparisons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_abv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_abv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">texname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stagename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">servicename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shorttitles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#plot_map_comparisons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.plot_map_comparisons" title="Link to this definition"></a></dt>
<dd><p>Plot comparisons between two identically-binned PISA 3 style maps</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.print_agreement">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">print_agreement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">testname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#print_agreement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.print_agreement" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.print_event_rates">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">print_event_rates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">testname1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">testname2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map1_events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map2_events</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#print_event_rates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.print_event_rates" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.validate_map_objs">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">validate_map_objs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#validate_map_objs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.validate_map_objs" title="Link to this definition"></a></dt>
<dd><p>Validate that two PISA 3 style maps are compatible binning.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.tests.validate_maps">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.tests.</span></span><span class="sig-name descname"><span class="pre">validate_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/tests.html#validate_maps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.tests.validate_maps" title="Link to this definition"></a></dt>
<dd><p>Validate that two PISA 2 style maps are compatible binning.</p>
</dd></dl>

</section>
<section id="module-pisa.utils.vbwkde">
<span id="pisa-utils-vbwkde-module"></span><h2>pisa.utils.vbwkde module<a class="headerlink" href="#module-pisa.utils.vbwkde" title="Link to this heading"></a></h2>
<p>Implementation of the Improved Sheather Jones (ISJ) KDE bandwidth selection
method outlined in:</p>
<blockquote>
<div><ol class="upperalpha simple" start="26">
<li><ol class="upperroman simple">
<li><p>Botev, J. F. Grotowski, and D. P. Kroese. Kernel density</p></li>
</ol>
</li>
</ol>
<blockquote>
<div><p>estimation via diffusion. The Annals of Statistics, 38(5):2916-2957, 2010.</p>
</div></blockquote>
</div></blockquote>
<p>and extension to use this in varaible bandwidth KDE via</p>
<blockquote>
<div><dl class="simple">
<dt>I.S. Abramson, On bandwidth variation in kernel estimates - A</dt><dd><p>square root law, Annals of Stat. Vol. 10, No. 4, 1217-1223 1982</p>
</dd>
</dl>
</div></blockquote>
<p>See also</p>
<blockquote>
<div><ol class="upperalpha simple" start="16">
<li><p>Hall, T. C. Hu, J. S. Marron, Improved Variable Window Kernel</p></li>
</ol>
<blockquote>
<div><p>Estimates of Probability Densities, Annals of Statistics
Vol. 23, No. 1, 1-10, 1995</p>
</div></blockquote>
</div></blockquote>
<p>Some code in this module is Copyright (c) 2007 Zdravko Botev. See __license__
for details.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vbwkde.fbwkde">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vbwkde.</span></span><span class="sig-name descname"><span class="pre">fbwkde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/vbwkde.html#fbwkde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.vbwkde.fbwkde" title="Link to this definition"></a></dt>
<dd><p>Fixed-bandwidth (standard) Gaussian KDE using the Improved
Sheather-Jones bandwidth.</p>
<p>Code adapted for Python from the implementation in Matlab by Zdravko Botev.</p>
<p>Ref: Z. I. Botev, J. F. Grotowski, and D. P. Kroese. Kernel density
estimation via diffusion. The Annals of Statistics, 38(5):2916-2957, 2010.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array</em>)</p></li>
<li><p><strong>weights</strong> (<em>array</em><em> or </em><em>None</em>)</p></li>
<li><p><strong>n_dct</strong> (<em>None</em><em> or </em><em>int</em>) – Number of points with which to form a regular grid, from <cite>min</cite> to
<cite>max</cite>; histogram values at these points are sent through a discrete
Cosine Transform (DCT), so <cite>n_dct</cite> should be an integer power of 2 for
speed purposes. If None, uses next-highest-power-of-2 above
len(data)*10.</p></li>
<li><p><strong>min</strong> (<em>float</em><em> or </em><em>None</em>)</p></li>
<li><p><strong>max</strong> (<em>float</em><em> or </em><em>None</em>)</p></li>
<li><p><strong>evaluate_dens</strong> (<em>bool</em>)</p></li>
<li><p><strong>evaluate_at</strong> (<em>None</em><em> or </em><em>array</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bandwidth</strong> (<em>float</em>)</p></li>
<li><p><strong>evaluate_at</strong> (<em>array of float</em>)</p></li>
<li><p><strong>density</strong> (<em>None or array of float</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vbwkde.isj_bandwidth">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vbwkde.</span></span><span class="sig-name descname"><span class="pre">isj_bandwidth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_datapoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bandwidth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/vbwkde.html#isj_bandwidth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.vbwkde.isj_bandwidth" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>array</em><em> of </em><em>float</em>)</p></li>
<li><p><strong>n_datapoints</strong> (<em>int</em>)</p></li>
<li><p><strong>x_range</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bandwidth</strong> (<em>float</em>)</p></li>
<li><p><strong>t_star</strong> (<em>float</em>)</p></li>
<li><p><strong>dct_data</strong> (<em>array of float</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vbwkde.test_fbwkde">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vbwkde.</span></span><span class="sig-name descname"><span class="pre">test_fbwkde</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/vbwkde.html#test_fbwkde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.vbwkde.test_fbwkde" title="Link to this definition"></a></dt>
<dd><p>Test speed of fbwkde implementation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vbwkde.test_vbwkde">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vbwkde.</span></span><span class="sig-name descname"><span class="pre">test_vbwkde</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/vbwkde.html#test_vbwkde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.vbwkde.test_vbwkde" title="Link to this definition"></a></dt>
<dd><p>Test speed of unweighted vbwkde implementation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vbwkde.vbwkde">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vbwkde.</span></span><span class="sig-name descname"><span class="pre">vbwkde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_addl_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_dens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pisa/utils/vbwkde.html#vbwkde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pisa.utils.vbwkde.vbwkde" title="Link to this definition"></a></dt>
<dd><p>Variable-bandwidth (standard) Gaussian KDE that uses the function
<cite>fbwkde</cite> for a pilot density estimate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array</em>) – The data points for which the density estimate is sought</p></li>
<li><p><strong>weights</strong> (<em>array</em><em> or </em><em>None</em>) – Weight for each point in <cite>data</cite></p></li>
<li><p><strong>n_dct</strong> (<em>None</em><em> or </em><em>int</em>) – Number of points with which to form a regular grid, from <cite>min</cite> to
<cite>max</cite>; histogram values at these points are sent through a discrete
Cosine Transform (DCT), so <cite>n_dct</cite> should be an integer power of 2 for
speed purposes. If None, uses next-highest-power-of-2 above
len(data)*10.</p></li>
<li><p><strong>min</strong> (<em>None</em><em> or </em><em>float</em>) – Minimum of range over which to compute density.
If None, defaults to min(data) - range(data)/2</p></li>
<li><p><strong>max</strong> (<em>None</em><em> or </em><em>float</em>) – Maximum of range over which to compute density.
If None: max(data) + range(data)/2</p></li>
<li><p><strong>n_addl_iter</strong> (<em>int &gt;= 0</em>) – Number of additional iterations on the Abramson VBW density <em>after</em>
the initial VBW estimate. This can help smooth the tails of the
distribution, at the expense of additional computational cost.</p></li>
<li><p><strong>evaluate_dens</strong> (<em>bool</em>) – Whether to evaluate and return the density estimate on the points
defined by <cite>evaluate_at</cite></p></li>
<li><p><strong>evaluate_at</strong> (<em>None</em><em>, </em><em>float</em><em>, or </em><em>array</em><em> of </em><em>float</em>) – <dl class="simple">
<dt>Point(s) at which to evaluate the density estimate. If None,</dt><dd><p>evaluate_at = np.linspace(min + dx/2, max - dx/2, n_dct)</p>
</dd>
<dt>where</dt><dd><p>dx = (max - min) / n_dct</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>kernel_bandwidths</strong> (<em>array</em>)</p></li>
<li><p><strong>evaluate_at</strong> (<em>array</em>) – Locations at which the density estimates would be evaluated</p></li>
<li><p><strong>density</strong> (<em>array</em>) – Density estimates</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Specifying the range:</p>
<blockquote>
<div><p>The specification of min and max are critical for obtaining a
reasonable density estimate. If the true underlying density slowly
decays to zero on one side or the other, like a gaussian, specifying
too-small a range will distort the edge the VBW-KDE finds. On the
other hand, an abrupt cut-off in the distribution should be
accompanied by a similar cutoff in the computational range (min and/or
max). The algorithm here will approximate such a sharp cut-off with
roughly the same performance to the reflection method for standard
KDE’s (as the fixed-BW portion uses a DCT of the data), but note that
this will not perform as well as polynomial-edges or other
modifications that have been proposed in the literature.</p>
</div></blockquote>
</dd></dl>

</section>
<section id="module-pisa.utils.vectorizer">
<span id="pisa-utils-vectorizer-module"></span><h2>pisa.utils.vectorizer module<a class="headerlink" href="#module-pisa.utils.vectorizer" title="Link to this heading"></a></h2>
<p>Collection of useful vectorized functions</p>
<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vectorizer.assign">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vectorizer.</span></span><span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pisa.utils.vectorizer.assign" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vectorizer.imul">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vectorizer.</span></span><span class="sig-name descname"><span class="pre">imul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pisa.utils.vectorizer.imul" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vectorizer.imul_and_scale">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vectorizer.</span></span><span class="sig-name descname"><span class="pre">imul_and_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pisa.utils.vectorizer.imul_and_scale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vectorizer.itruediv">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vectorizer.</span></span><span class="sig-name descname"><span class="pre">itruediv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pisa.utils.vectorizer.itruediv" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vectorizer.mul">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vectorizer.</span></span><span class="sig-name descname"><span class="pre">mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pisa.utils.vectorizer.mul" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vectorizer.pow">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vectorizer.</span></span><span class="sig-name descname"><span class="pre">pow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pisa.utils.vectorizer.pow" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vectorizer.replace_where_counts_gt">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vectorizer.</span></span><span class="sig-name descname"><span class="pre">replace_where_counts_gt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pisa.utils.vectorizer.replace_where_counts_gt" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pisa.utils.vectorizer.sqrt">
<span class="sig-prename descclassname"><span class="pre">pisa.utils.vectorizer.</span></span><span class="sig-name descname"><span class="pre">sqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pisa.utils.vectorizer.sqrt" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pisa.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pisa.utils" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pisa.stages.xsec.html" class="btn btn-neutral float-left" title="pisa.stages.xsec package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pisa.utils.hypersurface.html" class="btn btn-neutral float-right" title="pisa.utils.hypersurface package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, The IceCube/PINGU Collaboration.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>